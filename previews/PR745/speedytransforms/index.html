<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spectral transforms · SpeedyWeather.jl</title><meta name="title" content="Spectral transforms · SpeedyWeather.jl"/><meta property="og:title" content="Spectral transforms · SpeedyWeather.jl"/><meta property="twitter:title" content="Spectral transforms · SpeedyWeather.jl"/><meta name="description" content="Documentation for SpeedyWeather.jl."/><meta property="og:description" content="Documentation for SpeedyWeather.jl."/><meta property="twitter:description" content="Documentation for SpeedyWeather.jl."/><meta property="og:url" content="https://speedyweather.github.io/SpeedyWeatherDocumentation/stable/speedytransforms/"/><meta property="twitter:url" content="https://speedyweather.github.io/SpeedyWeatherDocumentation/stable/speedytransforms/"/><link rel="canonical" href="https://speedyweather.github.io/SpeedyWeatherDocumentation/stable/speedytransforms/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpeedyWeather.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Running SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../how_to_run_speedy/">How to run SpeedyWeather</a></li><li><a class="tocitem" href="../examples_2D/">Examples 2D</a></li><li><a class="tocitem" href="../examples_3D/">Examples 3D</a></li><li><a class="tocitem" href="../initial_conditions/">Initial conditions</a></li><li><a class="tocitem" href="../tracers/">Tracer advection</a></li><li><a class="tocitem" href="../particles/">Particle advection</a></li><li><a class="tocitem" href="../stochastic_physics/">Stochastic physics</a></li><li><a class="tocitem" href="../land/">Land surface model</a></li><li><a class="tocitem" href="../analysis/">Analysis</a></li><li><a class="tocitem" href="../structure/">Tree structure</a></li><li><a class="tocitem" href="../differentiability/">Differentiability and Adjoint Model</a></li><li><a class="tocitem" href="../output/">NetCDF output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Extending SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../extensions/">Extensions</a></li><li><a class="tocitem" href="../forcing_drag/">Forcing and drag</a></li><li><a class="tocitem" href="../parameterizations/">Parameterizations</a></li><li><a class="tocitem" href="../orography/">Orography</a></li><li><a class="tocitem" href="../land_sea_mask/">Land-Sea Mask</a></li><li><a class="tocitem" href="../ocean/">Ocean</a></li><li><a class="tocitem" href="../custom_netcdf_output/">NetCDF output variables</a></li><li><a class="tocitem" href="../callbacks/">Callbacks</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Dynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../barotropic/">Barotropic model</a></li><li><a class="tocitem" href="../shallowwater/">Shallow water model</a></li><li><a class="tocitem" href="../primitiveequation/">Primitive equation model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../large_scale_condensation/">Large-scale condensation</a></li><li><a class="tocitem" href="../convection/">Convection</a></li><li><a class="tocitem" href="../radiation/">Radiation</a></li><li><a class="tocitem" href="../vertical_diffusion/">Vertical diffusion</a></li><li><a class="tocitem" href="../surface_fluxes/">Surface fluxes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../spectral_transform/">Spherical Harmonic Transform</a></li><li><a class="tocitem" href="../grids/">Grids</a></li></ul></li><li><a class="tocitem" href="../ringgrids/">RingGrids</a></li><li><a class="tocitem" href="../lowertriangularmatrices/">LowerTriangularArrays</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox" checked/><label class="tocitem" for="menuitem-10"><span class="docs-label">SpeedyTransforms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Spectral transforms</a><ul class="internal"><li><a class="tocitem" href="#Notation:-Spectral-resolution"><span>Notation: Spectral resolution</span></a></li><li><a class="tocitem" href="#Example-transform"><span>Example transform</span></a></li><li><a class="tocitem" href="#Transform-onto-another-grid"><span>Transform onto another grid</span></a></li><li><a class="tocitem" href="#SpectralTransform"><span>The <code>SpectralTransform</code> struct</span></a></li><li><a class="tocitem" href="#SpectralTransform-generators"><span><code>SpectralTransform</code> generators</span></a></li><li><a class="tocitem" href="#Power-spectrum"><span>Power spectrum</span></a></li><li><a class="tocitem" href="#Example:-Creating-kn-distributed-noise"><span>Example: Creating k^n-distributed noise</span></a></li><li><a class="tocitem" href="#Precomputed-polynomials-and-allocated-memory"><span>Precomputed polynomials and allocated memory</span></a></li><li><a class="tocitem" href="#Batched-Transforms"><span>Batched Transforms</span></a></li><li><a class="tocitem" href="#Batched-power-spectra"><span>Batched power spectra</span></a></li><li><a class="tocitem" href="#Functions-and-type-index"><span>Functions and type index</span></a></li></ul></li><li><a class="tocitem" href="../gradients/">Gradient operators</a></li></ul></li><li><a class="tocitem" href="../functions/">Function and type index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">SpeedyTransforms</a></li><li class="is-active"><a href>Spectral transforms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spectral transforms</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/main/docs/src/speedytransforms.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="SpeedyTransforms"><a class="docs-heading-anchor" href="#SpeedyTransforms">SpeedyTransforms</a><a id="SpeedyTransforms-1"></a><a class="docs-heading-anchor-permalink" href="#SpeedyTransforms" title="Permalink"></a></h1><p>SpeedyTransforms is a submodule that has been developed for SpeedyWeather.jl which is technically independent (SpeedyWeather.jl however imports it) and can also be used without running simulations. It is just not put into its own respective repository for now.</p><p>The SpeedyTransforms are based on <a href="../ringgrids/#RingGrids">RingGrids</a> and <a href="../lowertriangularmatrices/#lowertriangularmatrices">LowerTriangularArrays</a> to hold data in either grid-point space or in spectral space. So you want to read these sections first for clarifications how to work with these. We will also not discuss mathematical details of the <a href="../spectral_transform/#Spherical-Harmonic-Transform">Spherical Harmonic Transform</a> here, but will focus on the usage of the SpeedyTransforms module.</p><p>The SpeedyTransforms module also implements the gradient operators <span>$\nabla, \nabla \cdot, \nabla \times, \nabla^2, \nabla^{-2}$</span> in spectral space. Combined with the spectral transform, you could for example start with a velocity field in grid-point space, transform to spectral, compute its divergence and transform back to obtain the divergence in grid-point space. Examples are outlined in <a href="../gradients/#Gradient-operators">Gradient operators</a>.</p><h2 id="Notation:-Spectral-resolution"><a class="docs-heading-anchor" href="#Notation:-Spectral-resolution">Notation: Spectral resolution</a><a id="Notation:-Spectral-resolution-1"></a><a class="docs-heading-anchor-permalink" href="#Notation:-Spectral-resolution" title="Permalink"></a></h2><p>There are different ways to describe the spectral resolution, the truncation wavenumber (e.g. T31), the maximum degree <span>$l$</span> and order <span>$m$</span> of the spherical harmonics (e.g. <span>$l_{max}=31$</span>, <span>$m_{max} = 31$</span>), or the size of the lower triangular matrix, e.g. 32x32. In this example, they are all equivalent. We often use the truncation, i.e. T31, for brevity but sometimes it is important to describe degree and order independently (see for example <a href="../gradients/#One-more-degree-for-spectral-fields">One more degree for spectral fields</a>). Note also how truncation, degree and order are 0-based, but matrix sizes are 1-based. </p><h2 id="Example-transform"><a class="docs-heading-anchor" href="#Example-transform">Example transform</a><a id="Example-transform-1"></a><a class="docs-heading-anchor-permalink" href="#Example-transform" title="Permalink"></a></h2><p>Lets start with a simple transform. We could be <code>using SpeedyWeather</code> but to be more verbose these are the modules required to load</p><pre><code class="language-julia hljs">using SpeedyWeather.RingGrids
using SpeedyWeather.LowerTriangularArrays
using SpeedyWeather.SpeedyTransforms</code></pre><p>As an example, we want to transform the <span>$l=m=1$</span> spherical harmonic from spectral space in <code>alms</code> to grid-point space. Note, the <span>$+1$</span> on both degree (first index) and order (second index) for 0-based harmonics versus 1-based matrix indexing, see <a href="../lowertriangularmatrices/#Size-of-LowerTriangularArray">Size of <code>LowerTriangularArray</code></a>. Create a <code>LowerTriangularMatrix</code> for T5 resolution, i.e. 6x6 matrix size</p><pre><code class="language-julia hljs">alms = zeros(LowerTriangularMatrix{ComplexF64}, 6, 6)     # spectral coefficients T5
alms[2, 2] = 1                                            # only l=1, m=1 harmonic
alms</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">21-element, 6x6 LowerTriangularMatrix{ComplexF64}
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  1.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im</code></pre><p>Now <code>transform</code> is the function that takes spectral coefficients <code>alms</code> and converts them a grid-point space <code>map</code> (or vice versa)</p><pre><code class="language-julia hljs">map = transform(alms)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">128-element, 8-ring FullGaussianField{Float64, 1}:
 -0.19278869685896943
 -0.17811353112752484
 -0.13632219488509495
 -0.07377704023518322
  0.0
  0.07377704023518322
  0.13632219488509495
  0.17811353112752484
  0.19278869685896943
  0.17811353112752484
  ⋮
  0.17811353112752484
  0.19278869685896943
  0.17811353112752484
  0.13632219488509495
  0.07377704023518322
  0.0
 -0.07377704023518322
 -0.13632219488509495
 -0.17811353112752484</code></pre><p>By default, the <code>transforms</code> transforms onto a <a href="../grids/#FullGaussianGrid"><code>FullGaussianGrid</code></a> unravelled here into a vector west to east, starting at the prime meridian, then north to south, see <a href="../ringgrids/#RingGrids">RingGrids</a>. We can visualize <code>map</code> quickly with a UnicodePlot via <code>heatmap</code> (see <a href="../ringgrids/#Visualising-Fields">Visualising Fields</a>), or alternatively in higher quality after <code>using CairoMakie</code> or <code>using GLMakie</code>, see <a href="../examples_2D/#Visualisation-via-Makie">Visualisation via Makie</a> too</p><pre><code class="language-julia hljs">using UnicodePlots
heatmap(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">   <span class="sgr97"><span class="sgr1">8-ring FullGaussianField{Float64, 1}</span></span>    
   <span class="sgr90">┌────────────────┐</span> <span class="sgr90">0.7</span>
 <span class="sgr90">90│</span><span class="sgr48_5" style="background:#005f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#008787">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span><span class="sgr38_5" style="color:#5faf5f">▄</span><span class="sgr38_5" style="color:#5fd75f">▄</span><span class="sgr38_5" style="color:#87d75f">▄</span><span class="sgr38_5" style="color:#5fd75f">▄</span><span class="sgr38_5" style="color:#5faf5f">▄</span><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span><span class="sgr38_5" style="color:#5f5f87">▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#005f87">▄</span></span><span class="sgr90">│┌──┐</span>
 ˚N<span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr38_5" style="color:#5f005f"><span class="sgr48_5" style="background:#5f0087">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#ffd700">▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#5f0087"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr90">││</span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#5faf87">▄▄</span></span><span class="sgr90">│</span>
   <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄</span><span class="sgr38_5" style="color:#5f0087">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#afd700">▄</span></span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#afd700">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f0087">▄</span></span><span class="sgr90">││</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄▄</span></span><span class="sgr90">│</span>
<span class="sgr90">-90│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#005f87">▄▄</span><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#008787">▄▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#5faf5f">▄</span><span class="sgr48_5" style="background:#5fd75f">▄</span><span class="sgr48_5" style="background:#87d75f">▄</span><span class="sgr48_5" style="background:#5fd75f">▄</span><span class="sgr48_5" style="background:#5faf5f">▄</span><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#5f5f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#005f87">▄</span></span><span class="sgr90">│└──┘</span>
   <span class="sgr90">└────────────────┘-0.7</span>
    <span class="sgr90">0</span>     ˚E     <span class="sgr90">360</span>     </code></pre><p>Yay! This is the what the <span>$l=m=1$</span> spherical harmonic is supposed to look like! Now let&#39;s go back to spectral space with <code>transform</code></p><pre><code class="language-julia hljs">alms2 = transform(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">21-element, 6x6 LowerTriangularMatrix{ComplexF64}
 0.0+0.0im          0.0+0.0im  0.0+0.0im  …  0.0+0.0im           0.0+0.0im
 0.0+0.0im          1.0+0.0im  0.0+0.0im     0.0+0.0im           0.0+0.0im
 0.0+0.0im          0.0+0.0im  0.0+0.0im     0.0+0.0im           0.0+0.0im
 0.0+0.0im  4.86756e-16+0.0im  0.0+0.0im     0.0+0.0im           0.0+0.0im
 0.0+0.0im          0.0+0.0im  0.0+0.0im     0.0+0.0im           0.0+0.0im
 0.0+0.0im  9.47165e-17+0.0im  0.0+0.0im  …  0.0+0.0im  -2.47957e-17+0.0im</code></pre><p>Comparing with <code>alms</code> from above you can see that the transform is exact up to a typical rounding error from <code>Float64</code>. </p><pre><code class="language-julia hljs">alms ≈ alms2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>YAY! The transform is typically idempotent, meaning that either space may hold information that is not exactly representable in the other but the first two-way transform will remove that so that subsequent transforms do not change this any further. However, also note here that the default <a href="../grids/#FullGaussianGrid"><code>FullGaussianGrid</code></a> is an exact grid, inexact grids usually have a transform error that is larger than the rounding error from floating-point arithmetic.</p><h2 id="Transform-onto-another-grid"><a class="docs-heading-anchor" href="#Transform-onto-another-grid">Transform onto another grid</a><a id="Transform-onto-another-grid-1"></a><a class="docs-heading-anchor-permalink" href="#Transform-onto-another-grid" title="Permalink"></a></h2><p>While the default grid for <a href="#SpeedyTransforms">SpeedyTransforms</a> is the <a href="../grids/#FullGaussianGrid"><code>FullGaussianGrid</code></a> we can transform onto other grids by specifying <code>Grid</code> too</p><pre><code class="language-julia hljs">map = transform(alms, Grid=HEALPixGrid)
heatmap(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">   <span class="sgr97"><span class="sgr1">7-ring HEALPixField{Float64, 1}</span></span>    
   <span class="sgr90">┌──────────────┐</span> <span class="sgr90">0.7</span>
 <span class="sgr90">90│</span><span class="sgr38_5" style="color:#005f87">▄▄</span><span class="sgr38_5" style="color:#008787">▄▄</span><span class="sgr38_5" style="color:#00af87">▄▄▄▄▄▄▄</span><span class="sgr38_5" style="color:#008787">▄▄</span><span class="sgr38_5" style="color:#005f87">▄</span><span class="sgr90">│┌──┐</span>
 ˚N<span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄</span><span class="sgr38_5" style="color:#5f5f87">▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#005f87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#d7d700">▄</span><span class="sgr38_5" style="color:#ffd700">▄</span><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#005f87"><span class="sgr38_5" style="color:#5f5f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr90">││</span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#5faf87">▄▄</span></span><span class="sgr90">│</span>
   <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#d7d700">▄</span><span class="sgr38_5" style="color:#ffd700">▄</span><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄</span></span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr90">││</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄▄</span></span><span class="sgr90">│</span>
<span class="sgr90">-90│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#005f87">▄▄</span></span><span class="sgr48_5" style="background:#005f87"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#008787">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#5fd75f">▄</span><span class="sgr48_5" style="background:#afd75f">▄▄▄</span><span class="sgr48_5" style="background:#5fd75f">▄</span><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#005f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#005f87">▄</span></span><span class="sgr90">│└──┘</span>
   <span class="sgr90">└──────────────┘-0.7</span>
    <span class="sgr90">0</span>    ˚E    <span class="sgr90">360</span>     </code></pre><p>which, if transformed back, however, can yield a larger transform error as discussed above</p><pre><code class="language-julia hljs">transform(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">21-element, 6x6 LowerTriangularMatrix{ComplexF64}
 0.0+0.0im           0.0+0.0im          0.0+0.0im  …  0.0+0.0im  0.0+0.0im
 0.0+0.0im       1.01215-1.47078e-17im  0.0+0.0im     0.0+0.0im  0.0+0.0im
 0.0+0.0im   3.42299e-17-1.51822e-34im  0.0+0.0im     0.0+0.0im  0.0+0.0im
 0.0+0.0im     0.0185292-1.7008e-17im   0.0+0.0im     0.0+0.0im  0.0+0.0im
 0.0+0.0im  -6.28844e-17+2.78914e-34im  0.0+0.0im     0.0+0.0im  0.0+0.0im
 0.0+0.0im    -0.0164851+6.08679e-18im  0.0+0.0im  …  0.0+0.0im  0.0+0.0im</code></pre><p>On such a coarse grid the transform error (absolute and relative) is about <span>$10^{-2}$</span>, this decreases for higher resolution. The <code>transform</code> function will choose a corresponding grid-spectral resolution (see <a href="../grids/#Matching-spectral-and-grid-resolution">Matching spectral and grid resolution</a>) following quadratic truncation, but you can always truncate/interpolate in spectral space with <code>spectral_truncation</code>, <code>spectral_interpolation</code> which takes <code>trunc</code> = <span>$l_{max} = m_{max}$</span> as second argument</p><pre><code class="language-julia hljs">spectral_truncation(alms, 2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element, 3x3 LowerTriangularMatrix{ComplexF64}
 0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  1.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im</code></pre><p>Yay, we just chopped off <span>$l &gt; 2$</span> from <code>alms</code> which contained the harmonics up to degree and order 5 before. If the second argument in <code>spectral_truncation</code> is larger than <code>alms</code> then it will automatically call <code>spectral_interpolation</code> and vice versa. Also see <a href="../ringgrids/#Interpolation-between-grids">Interpolation between grids</a> to interpolate directly between grids. If you want to control directly the resolution of the grid you want to <code>transform</code> onto, use the keyword <code>dealiasing</code> (default: 2 for quadratic, see <a href="../grids/#Matching-spectral-and-grid-resolution">Matching spectral and grid resolution</a>). But you can also provide a <code>SpectralTransform</code> instance to reuse a precomputed spectral transform. More on that now.</p><h2 id="SpectralTransform"><a class="docs-heading-anchor" href="#SpectralTransform">The <code>SpectralTransform</code> struct</a><a id="SpectralTransform-1"></a><a class="docs-heading-anchor-permalink" href="#SpectralTransform" title="Permalink"></a></h2><p>The function <code>transform</code> only with arguments as shown above, will create an instance of <code>SpectralTransform</code> under the hood. This object contains all precomputed information that is required for the transform, either way:  The Legendre polynomials, pre-planned Fourier transforms, precomputed gradient, divergence and curl operators, the spherical harmonic eigenvalues among others. Maybe the most intuitive way to create a <code>SpectralTransform</code> is to start with a <code>SpectralGrid</code>, which already defines which spectral resolution is supposed to be combined with a given grid.</p><pre><code class="language-julia hljs">using SpeedyWeather
spectral_grid = SpectralGrid(NF=Float32, trunc=5, Grid=OctahedralGaussianGrid, dealiasing=3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralGrid{Spectrum{...}, OctahedralGaussianGrid{...}}
├ Spectral:   T5 LowerTriangularMatrix{Complex{Float32}}, radius = 6.371e6 m
├ Grid:       Field{Float32} on 12-ring OctahedralGaussianGrid, 360 grid points
├ Resolution: 1190km (average)
├ Vertical:   8-layer atmosphere, 2-layer land
└ Device:     CPU using Array</code></pre><p>(We <code>using SpeedyWeather</code> here as <code>SpectralGrid</code> is exported therein). We also specify the number format <code>Float32</code> here to be used for the transform although this is the default anyway. From <code>spectral_grid</code> we now construct a <code>SpectralTransform</code> as follows</p><pre><code class="language-julia hljs">S = SpectralTransform(spectral_grid)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float32, Array}:
├ Spectral:   T5, 7x6 LowerTriangularMatrix{Complex{Float32}}
├ Grid:       Field{Float32}, 12-ring OctahedralGaussianGrid
├ Truncation: dealiasing = 3 (cubic)
├ Legendre:   Polynomials 1.54 KB, shortcut: linear
└ Memory:     for 8 layers (18.94 KB)</code></pre><p>Note that because we chose <code>dealiasing=3</code> (cubic truncation) we now match a T5 spectral field with a 12-ring octahedral Gaussian grid, instead of the 8 rings as above. So going from <code>dealiasing=2</code> (default) to <code>dealiasing=3</code> increased our resolution on the grid while the spectral resolution remains the same.</p><p>Passing on <code>S</code> the <code>SpectralTransform</code> now allows us to transform directly on the grid defined therein. Note that we recreate <code>alms</code> to be of size 7x6 instead of 6x6 for T5 spectral resolution because SpeedyWeather uses internally <a href="../gradients/#One-more-degree-for-spectral-fields">One more degree for spectral fields</a> meaning also that&#39;s the default when creating a <code>SpectralTransform</code> from a <code>SpectralGrid</code>. But results don&#39;t change if the last degree (row) contains only zeros.</p><pre><code class="language-julia hljs">alms = zeros(LowerTriangularMatrix{ComplexF64}, 7, 6)     # spectral coefficients
alms[2, 2] = 1                                            # only l=1, m=1 harmonic

map = transform(alms, S)
heatmap(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">   <span class="sgr97"><span class="sgr1">12-ring OctahedralGaussianField{Float32, 1}</span></span>    
   <span class="sgr90">┌────────────────────────┐</span> <span class="sgr90">0.7</span>
 <span class="sgr90">90│</span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#5f5f87">▄▄▄</span><span class="sgr38_5" style="color:#005f87">▄</span><span class="sgr38_5" style="color:#008787">▄▄▄</span><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#5faf87">▄▄</span><span class="sgr38_5" style="color:#5faf5f">▄▄▄</span><span class="sgr38_5" style="color:#5faf87">▄▄</span><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#008787">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄▄</span><span class="sgr38_5" style="color:#005f87">▄</span><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr90">│┌──┐</span>
   <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f0087">▄▄</span><span class="sgr38_5" style="color:#5f5f87">▄▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf5f">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#87d75f">▄</span><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd700">▄▄▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#afd75f">▄</span><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf5f">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄▄</span><span class="sgr38_5" style="color:#5f0087">▄</span></span><span class="sgr90">││</span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#afd75f">▄▄</span></span><span class="sgr90">│</span>
 ˚N<span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄▄</span></span><span class="sgr38_5" style="color:#5f005f"><span class="sgr48_5" style="background:#5f0087">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#005f87">▄</span><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#ffd700">▄▄▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span><span class="sgr38_5" style="color:#005f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#5f0087"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr38_5" style="color:#5f005f"><span class="sgr48_5" style="background:#5f005f">▄</span></span><span class="sgr90">││</span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#00af87">▄▄</span></span><span class="sgr90">│</span>
   <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄▄</span><span class="sgr38_5" style="color:#5f0087">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#005f87"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#008787">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#afd700">▄</span></span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#d7d700">▄▄▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#afd700">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#005f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f0087">▄</span><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr90">││</span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr90">│</span>
   <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f0087"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#5f5f87">▄▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr38_5" style="color:#5fd75f"><span class="sgr48_5" style="background:#afd75f">▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#87d75f">▄▄▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr38_5" style="color:#5fd75f"><span class="sgr48_5" style="background:#87d75f">▄</span></span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#5f0087">▄</span></span><span class="sgr90">││</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄▄</span></span><span class="sgr90">│</span>
<span class="sgr90">-90│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#008787">▄▄▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#005f87">▄</span><span class="sgr48_5" style="background:#008787">▄▄▄</span><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#5faf87">▄▄</span><span class="sgr48_5" style="background:#5faf5f">▄▄▄</span><span class="sgr48_5" style="background:#5faf87">▄▄</span><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#008787">▄▄▄</span><span class="sgr48_5" style="background:#005f87">▄</span><span class="sgr48_5" style="background:#5f5f87">▄▄</span></span><span class="sgr90">│└──┘</span>
   <span class="sgr90">└────────────────────────┘-0.7</span>
    <span class="sgr90">0</span>         ˚E         <span class="sgr90">360</span>     </code></pre><p>Yay, this is again the <span>$l=m=1$</span> harmonic, but this time on a slightly higher resolution <code>OctahedralGaussianGrid</code> as specified in the <code>SpectralTransform</code> <code>S</code>. Note that also the number format was converted on the fly to Float32 because that is the number format we specified in <code>S</code>! And from grid to spectral</p><pre><code class="language-julia hljs">alms2 = transform(map, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">27-element, 7x6 LowerTriangularMatrix{ComplexF32}
   2.05564f-9+0.0im          0.0+0.0im          …         0.0+0.0im
          0.0+0.0im          1.0-2.14344f-8im             0.0+0.0im
   -1.3654f-9+0.0im          0.0+0.0im                    0.0+0.0im
          0.0+0.0im  -2.66275f-8-6.93167f-11im            0.0+0.0im
 -3.22443f-10+0.0im          0.0+0.0im                    0.0+0.0im
          0.0+0.0im  -4.58858f-8-8.19443f-9im   …  6.58519f-9+4.79414f-9im
   1.85859f-9+0.0im          0.0+0.0im                    0.0+0.0im</code></pre><p>As you can see the rounding error is now more like <span>$10^{-8}$</span> as we are using Float32 (the <a href="../grids/#OctahedralGaussianGrid">OctahedralGaussianGrid</a> is another <em>exact</em> grid). While for this interface to SpeedyTransforms this means that on a grid-to-spectral transform you will get one more degree than orders of the spherical harmonics by default. You can, however, always truncate this additional degree, say to T5 (hence matrix size is 6x6)</p><pre><code class="language-julia hljs">spectral_truncation(alms2, 5, 5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">21-element, 6x6 LowerTriangularMatrix{ComplexF32}
   2.05564f-9+0.0im          0.0+0.0im          …         0.0+0.0im
          0.0+0.0im          1.0-2.14344f-8im             0.0+0.0im
   -1.3654f-9+0.0im          0.0+0.0im                    0.0+0.0im
          0.0+0.0im  -2.66275f-8-6.93167f-11im            0.0+0.0im
 -3.22443f-10+0.0im          0.0+0.0im                    0.0+0.0im
          0.0+0.0im  -4.58858f-8-8.19443f-9im   …  6.58519f-9+4.79414f-9im</code></pre><p><code>spectral_truncation(alms2, 5)</code> would have returned the same, a single argument is then assumed equal for both degrees and orders. Alternatively, you can also pass on the <code>one_more_degree=false</code> argument to the <code>SpectralTransform</code> constructor</p><pre><code class="language-julia hljs">S = SpectralTransform(spectral_grid, one_more_degree=false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float32, Array}:
├ Spectral:   T5, 6x6 LowerTriangularMatrix{Complex{Float32}}
├ Grid:       Field{Float32}, 12-ring OctahedralGaussianGrid
├ Truncation: dealiasing = 3 (cubic)
├ Legendre:   Polynomials 1.30 KB, shortcut: linear
└ Memory:     for 8 layers (18.94 KB)</code></pre><p>As you can see the <code>7x6 LowerTriangularMatrix</code> in the description above dropped down to <code>6x6 LowerTriangularMatrix</code>, this is the size of the input that is expected (otherwise you will get a <code>BoundsError</code>).</p><h2 id="SpectralTransform-generators"><a class="docs-heading-anchor" href="#SpectralTransform-generators"><code>SpectralTransform</code> generators</a><a id="SpectralTransform-generators-1"></a><a class="docs-heading-anchor-permalink" href="#SpectralTransform-generators" title="Permalink"></a></h2><p>While you can always create a <code>SpectralTransform</code> from a <code>SpectralGrid</code> (which defines both spectral and grid space) there are other constructors/generators available:</p><pre><code class="language-julia hljs">SpectralTransform(alms)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float64, Array}:
├ Spectral:   T5, 7x6 LowerTriangularMatrix{Complex{Float64}}
├ Grid:       Field{Float64}, 8-ring FullGaussianGrid
├ Truncation: dealiasing = 1.67 (linear)
├ Legendre:   Polynomials 1.75 KB, shortcut: linear
└ Memory:     for 1 layers (1.62 KB)</code></pre><p>Now we have defined the resolution of the spectral space through <code>alms</code> but create a <code>SpectralTransform</code> by making assumption about the grid space. E.g. <code>Grid=FullGaussianGrid</code> by default, <code>dealiasing=2</code> and <code>nlat_half</code> correspondingly. But you can also pass them on as keyword arguments, for example</p><pre><code class="language-julia hljs">SpectralTransform(alms, Grid=OctahedralClenshawGrid, nlat_half=24)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float64, Array}:
├ Spectral:   T5, 7x6 LowerTriangularMatrix{Complex{Float64}}
├ Grid:       Field{Float64}, 47-ring OctahedralClenshawGrid
├ Truncation: dealiasing = 15 (&gt;cubic)
├ Legendre:   Polynomials 6.07 KB, shortcut: linear
└ Memory:     for 1 layers (45.78 KB)</code></pre><p>Only note that you don&#39;t want to specify both <code>nlat_half</code> and <code>dealiasing</code> as you would otherwise overspecify the grid resolution (<code>dealiasing</code> will be ignored in that case). This also works starting from the grid space</p><pre><code class="language-julia hljs">grid = rand(FullClenshawGrid, 12)
SpectralTransform(grid)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float64, Array}:
├ Spectral:   T15, 16x16 LowerTriangularMatrix{Complex{Float64}}
├ Grid:       Field{Float64}, 23-ring FullClenshawGrid
├ Truncation: dealiasing = 2 (quadratic)
├ Legendre:   Polynomials 16.01 KB, shortcut: linear
└ Memory:     for 1 layers (10.58 KB)</code></pre><p>where you can also provide spectral resolution <code>trunc</code> or <code>dealiasing</code>. You can also provide both a grid and a lower triangular matrix to describe both spaces</p><pre><code class="language-julia hljs">SpectralTransform(grid, alms)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float64, Array}:
├ Spectral:   T5, 7x6 LowerTriangularMatrix{Complex{Float64}}
├ Grid:       Field{Float64}, 23-ring FullClenshawGrid
├ Truncation: dealiasing = 7 (&gt;cubic)
├ Legendre:   Polynomials 3.48 KB, shortcut: linear
└ Memory:     for 1 layers (10.58 KB)</code></pre><p>and you will precompute the transform between them. For more generators see the docstrings at <code>?SpectralTransform</code>.</p><h2 id="Power-spectrum"><a class="docs-heading-anchor" href="#Power-spectrum">Power spectrum</a><a id="Power-spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Power-spectrum" title="Permalink"></a></h2><p>How to take some data and compute a power spectrum with SpeedyTransforms you may ask. Say you have some global data in a matrix <code>m</code> that looks, for example, like</p><pre><code class="language-julia hljs">m</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">96×47 Matrix{Float32}:
 -1.56437  -2.2391    -3.6227     …  -6.22428  -4.05734  -1.76297
 -1.52048  -2.05723   -3.23071       -5.99407  -3.84655  -1.63864
 -1.47374  -1.85779   -2.79504       -5.70997  -3.60441  -1.50311
 -1.42511  -1.64536   -2.32758       -5.37269  -3.33198  -1.35701
 -1.37566  -1.42485   -1.84101       -4.98373  -3.03074  -1.20107
 -1.32645  -1.20135   -1.3483     …  -4.54552  -2.70257  -1.03615
 -1.27861  -0.980011  -0.862209      -4.0614   -2.34973  -0.863247
 -1.23325  -0.765847  -0.394815      -3.53554  -1.97487  -0.683419
 -1.19143  -0.563631   0.0428802     -2.97297  -1.58096  -0.497844
 -1.15418  -0.377767   0.441283      -2.37938  -1.17127  -0.307776
  ⋮                               ⋱             ⋮        
 -1.72771  -2.64417   -4.12732       -6.07735  -4.55982  -2.33694
 -1.73341  -2.71745   -4.34851       -6.26144  -4.61636  -2.32103
 -1.73323  -2.7632    -4.50957       -6.41116  -4.64848  -2.29378
 -1.7269   -2.7794    -4.60336    …  -6.52274  -4.65421  -2.25476
 -1.7143   -2.76471   -4.62462       -6.59273  -4.63181  -2.20366
 -1.69549  -2.71863   -4.57032       -6.61805  -4.57981  -2.14026
 -1.67066  -2.64145   -4.43984       -6.59597  -4.49704  -2.06443
 -1.64017  -2.53435   -4.23508       -6.52416  -4.38264  -1.97617
 -1.60453  -2.3993    -3.96045    …  -6.40072  -4.23612  -1.8756</code></pre><p>You hopefully know which grid this data comes on, let us assume it is a regular latitude-longitude grid, which we call the <code>FullClenshawGrid</code> (in analogy to the Gaussian grid based on the Gaussian quadrature). Note that for the spectral transform this should not include the poles, so the 96x47 matrix size here corresponds to 23 latitudes north and south of the Equator respectively plus the equator (=47).</p><p>We now wrap this matrix into a <code>FullClenshawGrid</code> (<code>input_as=Matrix</code> is required because all grids organise their data as vectors, see <a href="../ringgrids/#Creating-a-Field-from-data">Creating a Field from data</a>) therefore to associate it with the necessary grid information like its coordinates</p><pre><code class="language-julia hljs">map = FullClenshawGrid(m, input_as=Matrix)

using CairoMakie
heatmap(map)</code></pre><p><img src="../random_pattern.png" alt="Random pattern"/></p><p>Now we transform into spectral space and call <code>power_spectrum(::LowerTriangularMatrix)</code></p><pre><code class="language-julia hljs">alms = transform(map)
power = power_spectrum(alms)</code></pre><p>Which returns a vector of power at every wavenumber. By default this is normalized as average power per degree, you can change that with the keyword argument <code>normalize=false</code>. Plotting this yields</p><pre><code class="language-julia hljs">using UnicodePlots
k = 0:length(power)-1
lineplot(k, power, yscale=:log10, ylim=(1e-15, 10), xlim=extrema(k),
    ylabel=&quot;power&quot;, xlabel=&quot;wavenumber&quot;, height=10, width=60)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">               <span class="sgr90">┌────────────────────────────────────────────────────────────┐</span> 
           <span class="sgr90">10¹</span> <span class="sgr90">│</span>⠀<span class="sgr32">⢀⣀⠤⠤⠤⠤⠤⠤⠤⠤⠤⠤⣀⣀⠤⠤⠤⠤⡄</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span><span class="sgr32">⠊⠁</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢱</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢸</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⠸⡀</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
   power       <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⡇</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⡇</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢱</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢸</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⠸⡀</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
         <span class="sgr90">10⁻¹⁵</span> <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⣇⣀⣀⣀⣀⣀⣀⡀⡀⣀⣀⢀</span>⠀<span class="sgr32">⣀⣀⣀⣀⡀</span>⠀⠀⠀⠀⠀<span class="sgr32">⢀</span>⠀<span class="sgr32">⣀</span>⠀⠀⠀<span class="sgr32">⡀⢀⣀⣀⡀</span>⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">└────────────────────────────────────────────────────────────┘</span> 
               ⠀<span class="sgr90">0</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">31</span>⠀ 
               ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀wavenumber⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀ </code></pre><p>The power spectrum of our data is about 1 up to wavenumber 10 and then close to zero for higher wavenumbers (which is in fact how we constructed this fake data). Let us turn this around and use SpeedyTransforms to create random noise in spectral space to be used in grid-point space!</p><h2 id="Example:-Creating-kn-distributed-noise"><a class="docs-heading-anchor" href="#Example:-Creating-kn-distributed-noise">Example: Creating k^n-distributed noise</a><a id="Example:-Creating-kn-distributed-noise-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Creating-kn-distributed-noise" title="Permalink"></a></h2><p>How would we construct random noise in spectral space that follows a certain power law and transform it back into grid-point space? Define the wavenumber <span>$k$</span> for T31, the spectral resolution we are interested in. (We start from 1 instead of 0 to avoid zero to the power of something negative). Now create some normally distributed spectral coefficients but scale them down for higher wavenumbers with <span>$k^{-2}$</span></p><pre><code class="language-julia hljs">k = 1:32
A = randn(Complex{Float32}, 32, 32)
A .*= k.^-2
alms = LowerTriangularArray(A)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">528-element, 32x32 LowerTriangularMatrix{ComplexF32}
     0.280715+0.982496im     …         0.0+0.0im
    -0.285581-0.044726im               0.0+0.0im
     0.104701+0.131754im               0.0+0.0im
    0.0110239-0.0402849im              0.0+0.0im
  0.000705189+0.0395599im              0.0+0.0im
    0.0128362-0.0346075im    …         0.0+0.0im
   -0.0165186-0.00437422im             0.0+0.0im
    0.0014635-0.00390468im             0.0+0.0im
   0.00924634+0.00201036im             0.0+0.0im
  -0.00103787+0.00434947im             0.0+0.0im
             ⋮               ⋱  
  -0.00143361-2.61056f-5im             0.0+0.0im
 -0.000762412+0.000316593im            0.0+0.0im
   0.00131141+0.00177726im   …         0.0+0.0im
  0.000195706-0.000752235im            0.0+0.0im
  0.000117693+0.000179147im            0.0+0.0im
  0.000712348-0.000450318im            0.0+0.0im
    0.0012859-0.000382938im            0.0+0.0im
 -0.000688194-0.000565742im  …         0.0+0.0im
  0.000295727-0.000719548im     -2.8627f-5+0.000878271im</code></pre><p>We first create a Julia <code>Matrix</code> so that the matrix-vector broadcasting <code>.*= k</code> is correctly applied across dimensions of <code>A</code> and then convert to a <code>LowerTriangularMatrix</code>.</p><p>Awesome. For higher degrees and orders the amplitude clearly decreases! Now to grid-point space and let us visualize the result</p><pre><code class="language-julia hljs">map = transform(alms)

using CairoMakie
heatmap(map, title=&quot;k⁻²-distributed noise&quot;)</code></pre><p><img src="../random_noise.png" alt="Random noise"/></p><p>You can always access the underlying data in <code>map</code> via <code>map.data</code> in case you need to get rid of the wrapping into a grid again!</p><h2 id="Precomputed-polynomials-and-allocated-memory"><a class="docs-heading-anchor" href="#Precomputed-polynomials-and-allocated-memory">Precomputed polynomials and allocated memory</a><a id="Precomputed-polynomials-and-allocated-memory-1"></a><a class="docs-heading-anchor-permalink" href="#Precomputed-polynomials-and-allocated-memory" title="Permalink"></a></h2><div class="admonition is-info" id="Reuse-SpectralTransforms-wherever-possible-3dfc0b0b43b2f961"><header class="admonition-header">Reuse `SpectralTransform`s wherever possible<a class="admonition-anchor" href="#Reuse-SpectralTransforms-wherever-possible-3dfc0b0b43b2f961" title="Permalink"></a></header><div class="admonition-body"><p>Depending on horizontal and vertical resolution of spectral and grid space, a <code>SpectralTransform</code> can be become very large in memory. Also the recomputation of the polynomials and the planning of the FFTs are expensive compared to the actual transform itself. Therefore reuse a <code>SpectralTransform</code> wherever possible.</p></div></div><p>The spectral transform uses a Legendre transform in meridional direction. For this the Legendre polynomials are required, at each latitude ring this is a <span>$l_{max} \times m_{max}$</span> lower triangular matrix. Storing precomputed Legendre polynomials therefore quickly increase in size with resolution. It is therefore advised to reuse a precomputed <code>SpectralTransform</code> object wherever possible. This prevents transforms to allocate large memory which would otherwise be garbage collected again after the transform.</p><p>You get information about the size of that memory (both polynomials and required scratch memory) in the terminal &quot;show&quot; of a <code>SpectralTransform</code> object, e.g. at T127 resolution with 8 layers these are</p><pre><code class="language-julia hljs">using SpeedyWeather
spectral_grid = SpectralGrid(trunc=127, nlayers=8)
SpectralTransform(spectral_grid)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float32, Array}:
├ Spectral:   T127, 129x128 LowerTriangularMatrix{Complex{Float32}}
├ Grid:       Field{Float32}, 192-ring OctahedralGaussianGrid
├ Truncation: dealiasing = 2 (quadratic)
├ Legendre:   Polynomials 3.36 MB, shortcut: linear
└ Memory:     for 8 layers (2.50 MB)</code></pre><h2 id="Batched-Transforms"><a class="docs-heading-anchor" href="#Batched-Transforms">Batched Transforms</a><a id="Batched-Transforms-1"></a><a class="docs-heading-anchor-permalink" href="#Batched-Transforms" title="Permalink"></a></h2><p>SpeedyTransforms also supports batched transforms. With batched input data the <code>transform</code> is performed along the leading dimension, and all further dimensions are interpreted as batch dimensions. Take for example </p><pre><code class="language-julia hljs">alms = randn(LowerTriangularArray{Complex{Float32}}, 32, 32, 5)
grids = transform(alms)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4608×5, 48-ring FullGaussianField{Float32, 2}:
  3.11961   4.80487     -14.0606   -2.47732  12.5263
  2.78953   4.45131     -13.9859   -2.44164  12.0897
  2.44948   4.02463     -13.8145   -2.38373  11.6294
  2.10583   3.5365      -13.5465   -2.31077  11.1477
  1.76472   2.99923     -13.184    -2.23021  10.6468
  1.43182   2.42543     -12.7308   -2.14965  10.1293
  1.11224   1.82763     -12.1923   -2.07661   9.5976
  0.810386  1.21803     -11.5753   -2.01837   9.0546
  0.529808  0.608214    -10.8877   -1.98177   8.50341
  0.273151  0.00898796  -10.1383   -1.97305   7.94748
  ⋮                                          
 -7.58366   9.32031       4.77228  -4.94413   2.5324
 -7.40319   9.33167       5.23481  -5.02701   2.7923
 -7.16308   9.32589       5.58456  -5.08423   3.04567
 -6.86674   9.29979       5.82251  -5.11703   3.28987
 -6.51769   9.25049       5.95163  -5.12729   3.52229
 -6.11949   9.17553       5.97664  -5.11734   3.7405
 -5.67568   9.07296       5.9039   -5.08973   3.94238
 -5.18971   8.9415        5.74105  -5.04705   4.12623
 -4.66491   8.78053       5.49684  -4.99179   4.29086</code></pre><p>In this case we first randomly generated five (32x32) <code>LowerTriangularArray</code> that hold the coefficients and then transformed all five matrices batched to the grid space with the  transform command, yielding 5 <code>RingGrids</code> with each 48-rings. </p><h2 id="Batched-power-spectra"><a class="docs-heading-anchor" href="#Batched-power-spectra">Batched power spectra</a><a id="Batched-power-spectra-1"></a><a class="docs-heading-anchor-permalink" href="#Batched-power-spectra" title="Permalink"></a></h2><p>SpeedyTransforms also supports power spectra calculated over any additional dimensions to the leading spherical harmonic dimension (it is unravelled as a vector so the first only, not the first two...). But the power spectrum is always calculated along that first spherical-harmonic dimension. For example</p><pre><code class="language-julia hljs">alms = randn(LowerTriangularArray{Complex{Float32}}, 5, 5, 2)
power_spectrum(alms)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5×2 Matrix{Float32}:
 1.05568   2.65357
 0.590579  1.16816
 0.634078  0.768259
 0.946322  0.800911
 2.29668   1.63309</code></pre><p>returns the power spectrum for <code>[..., 1]</code> in the first column and <code>[..., 2]</code> in the second. This avoids to loop over these additional dimensions, but the result would be the same:</p><pre><code class="language-julia hljs">power_spectrum(alms[:, 1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{Float32}:
 1.0556806
 0.5905788
 0.6340778
 0.94632155
 2.2966797</code></pre><h2 id="Functions-and-type-index"><a class="docs-heading-anchor" href="#Functions-and-type-index">Functions and type index</a><a id="Functions-and-type-index-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-and-type-index" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.AbstractLegendreShortcut" href="#SpeedyWeather.SpeedyTransforms.AbstractLegendreShortcut"><code>SpeedyWeather.SpeedyTransforms.AbstractLegendreShortcut</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Legendre shortcut is the truncation of the loop over the order m of the spherical harmonics in the Legendre transform. For reduced grids with as few as 4 longitudes around the poles (HEALPix grids) or 20 (octahedral grids) the higher wavenumbers in large orders m do not project (significantly) onto such few longitudes. For performance reasons the loop over m can therefore but truncated early. A Legendre shortcut <code>&lt;: AbstractLegendreShortcut</code> is implemented as a functor that returns the 0-based maximum order m to retain per latitude ring, i.e. to be used for m in 0:mmax_truncation.</p><p>New shortcuts can be added by defining <code>struct LegendreShortcutNew &lt;: AbstractLegendreShortcut end</code> and the functor method <code>LegendreShortcutNew(nlon::Integer, lat::Real) = ...</code>, with <code>nlon</code> the number of longitude points on that ring, and <code>latd</code> its latitude in degrees (-90˚ to 90˚N). Many implementations may not use the latitude <code>latd</code> but it is included for compatibility. If unused set to default value to 0. Also define <code>short_name(::Type{&lt;:LegendreShortcutNew}) = &quot;new&quot;</code>.</p><p>Implementions are <code>LegendreShortcutLinear</code>, <code>LegendreShortcutQuadratic</code>, <code>LegendreShortcutCubic</code>, <code>LegendreShortcutLinQuadCosLat²</code> and <code>LegendreShortcutLinCubCoslat</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/legendre_shortcuts.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.LegendreShortcutCubic" href="#SpeedyWeather.SpeedyTransforms.LegendreShortcutCubic"><code>SpeedyWeather.SpeedyTransforms.LegendreShortcutCubic</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LegendreShortcutCubic(nlon::Integer) -&gt; Any
LegendreShortcutCubic(nlon::Integer, latd::Real) -&gt; Any
</code></pre><p>Cubic Legendre shortcut, truncates the Legendre loop over order m to nlon/4.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/legendre_shortcuts.jl#L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.LegendreShortcutLinCubCoslat-Tuple{Integer, Real}" href="#SpeedyWeather.SpeedyTransforms.LegendreShortcutLinCubCoslat-Tuple{Integer, Real}"><code>SpeedyWeather.SpeedyTransforms.LegendreShortcutLinCubCoslat</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LegendreShortcutLinCubCoslat(
    nlon::Integer,
    latd::Real
) -&gt; Any
</code></pre><p>Linear-Cubic Legendre shortcut, truncates the Legendre loop over order m to nlon/(2 + 2cosd(latd)).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/legendre_shortcuts.jl#L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.LegendreShortcutLinQuadCoslat²-Tuple{Integer, Real}" href="#SpeedyWeather.SpeedyTransforms.LegendreShortcutLinQuadCoslat²-Tuple{Integer, Real}"><code>SpeedyWeather.SpeedyTransforms.LegendreShortcutLinQuadCoslat²</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LegendreShortcutLinQuadCoslat²(
    nlon::Integer,
    latd::Real
) -&gt; Any
</code></pre><p>Linear-Quadratic Legendre shortcut, truncates the Legendre loop over order m to nlon/(2 + cosd(latd)^2).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/legendre_shortcuts.jl#L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.LegendreShortcutLinear" href="#SpeedyWeather.SpeedyTransforms.LegendreShortcutLinear"><code>SpeedyWeather.SpeedyTransforms.LegendreShortcutLinear</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LegendreShortcutLinear(nlon::Integer) -&gt; Any
LegendreShortcutLinear(nlon::Integer, latd::Real) -&gt; Any
</code></pre><p>Linear Legendre shortcut, truncates the Legendre loop over order m to nlon/2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/legendre_shortcuts.jl#L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.LegendreShortcutQuadratic" href="#SpeedyWeather.SpeedyTransforms.LegendreShortcutQuadratic"><code>SpeedyWeather.SpeedyTransforms.LegendreShortcutQuadratic</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LegendreShortcutQuadratic(nlon::Integer) -&gt; Any
LegendreShortcutQuadratic(nlon::Integer, latd::Real) -&gt; Any
</code></pre><p>Quadratic Legendre shortcut, truncates the Legendre loop over order m to nlon/3.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/legendre_shortcuts.jl#L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>SpectralTransform struct that contains all parameters and precomputed arrays to perform a spectral transform. Fields are</p><ul><li><p><code>spectrum::Any</code></p></li><li><p><code>nfreq_max::Int64</code></p></li><li><p><code>LegendreShortcut::Type{&lt;:SpeedyWeather.SpeedyTransforms.AbstractLegendreShortcut}</code></p></li><li><p><code>mmax_truncation::Vector{Int64}</code></p></li><li><p><code>grid::Any</code></p></li><li><p><code>nlayers::Int64</code></p></li><li><p><code>nlon_max::Int64</code></p></li><li><p><code>nlons::Vector{Int64}</code></p></li><li><p><code>nlat::Int64</code></p></li><li><p><code>coslat::Any</code></p></li><li><p><code>coslat⁻¹::Any</code></p></li><li><p><code>lon_offsets::Any</code></p></li><li><p><code>norm_sphere::Any</code></p></li><li><p><code>rfft_plans::Vector{AbstractFFTs.Plan}</code></p></li><li><p><code>brfft_plans::Vector{AbstractFFTs.Plan}</code></p></li><li><p><code>rfft_plans_1D::Vector{AbstractFFTs.Plan}</code></p></li><li><p><code>brfft_plans_1D::Vector{AbstractFFTs.Plan}</code></p></li><li><p><code>legendre_polynomials::Any</code></p></li><li><p><code>scratch_memory_north::Any</code></p></li><li><p><code>scratch_memory_south::Any</code></p></li><li><p><code>scratch_memory_grid::Any</code></p></li><li><p><code>scratch_memory_spec::Any</code></p></li><li><p><code>scratch_memory_column_north::Any</code></p></li><li><p><code>scratch_memory_column_south::Any</code></p></li><li><p><code>jm_index_size::Int64</code></p></li><li><p><code>kjm_indices::Any</code></p></li><li><p><code>solid_angles::Any</code></p></li><li><p><code>grad_y1::Any</code></p></li><li><p><code>grad_y2::Any</code></p></li><li><p><code>grad_y_vordiv1::Any</code></p></li><li><p><code>grad_y_vordiv2::Any</code></p></li><li><p><code>vordiv_to_uv_x::Any</code></p></li><li><p><code>vordiv_to_uv1::Any</code></p></li><li><p><code>vordiv_to_uv2::Any</code></p></li><li><p><code>eigenvalues::Any</code></p></li><li><p><code>eigenvalues⁻¹::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L8-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform-Tuple{AbstractField, LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform-Tuple{AbstractField, LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpectralTransform(
    field::AbstractField,
    coeffs::LowerTriangularArray;
    kwargs...
) -&gt; SpectralTransform{var&quot;#s263&quot;, _A, var&quot;#s182&quot;, var&quot;#s1821&quot;, _B, _C, _D, _E, LowerTriangularArray{var&quot;#s2631&quot;, 1, _A1, var&quot;#s1822&quot;}, LowerTriangularArray{var&quot;#s2632&quot;, 2, _A2, var&quot;#s1823&quot;}} where {var&quot;#s263&quot;&lt;:Real, _A, var&quot;#s182&quot;&lt;:SpeedyWeather.LowerTriangularArrays.AbstractSpectrum, Architecture, var&quot;#s1821&quot;&lt;:AbstractGrid{Architecture}, _B, _C, _D, _E, var&quot;#s2631&quot;&lt;:Real, _A1, var&quot;#s1822&quot;&lt;:SpeedyWeather.LowerTriangularArrays.AbstractSpectrum, var&quot;#s2632&quot;&lt;:Real, _A2, var&quot;#s1823&quot;&lt;:SpeedyWeather.LowerTriangularArrays.AbstractSpectrum}
</code></pre><p>Generator function for a <code>SpectralTransform</code> struct to transform between <code>field</code> and <code>coeffs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L335">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform-Tuple{SpeedyWeather.LowerTriangularArrays.AbstractSpectrum, AbstractGrid}" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform-Tuple{SpeedyWeather.LowerTriangularArrays.AbstractSpectrum, AbstractGrid}"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpectralTransform(
    spectrum::SpeedyWeather.LowerTriangularArrays.AbstractSpectrum,
    grid::AbstractGrid;
    NF,
    ArrayType,
    nlayers,
    LegendreShortcut
) -&gt; SpectralTransform{Float64, Array, var&quot;#s182&quot;, var&quot;#s1821&quot;, Vector{Float64}, Vector{ComplexF64}, Matrix{ComplexF64}, Array{ComplexF64, 3}, LowerTriangularMatrix{Float64, Vector{Float64}, var&quot;#s1822&quot;}, LowerTriangularArray{Float64, 2, Matrix{Float64}, var&quot;#s1823&quot;}} where {var&quot;#s182&quot;&lt;:SpeedyWeather.LowerTriangularArrays.AbstractSpectrum, Architecture, var&quot;#s1821&quot;&lt;:AbstractGrid{Architecture}, var&quot;#s1822&quot;&lt;:SpeedyWeather.LowerTriangularArrays.AbstractSpectrum, var&quot;#s1823&quot;&lt;:SpeedyWeather.LowerTriangularArrays.AbstractSpectrum}
</code></pre><p>Generator function for a SpectralTransform struct. With <code>NF</code> the number format, <code>Grid</code> the grid type <code>&lt;:AbstractGrid</code> and spectral truncation <code>lmax, mmax</code> this function sets up necessary constants for the spetral transform. Also plans the Fourier transforms, retrieves the colatitudes, and preallocates the Legendre polynomials and quadrature weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.RingGrids.get_nlat_half" href="#SpeedyWeather.RingGrids.get_nlat_half"><code>SpeedyWeather.RingGrids.get_nlat_half</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_nlat_half(trunc::Integer) -&gt; Any
get_nlat_half(trunc::Integer, dealiasing::Real) -&gt; Any
</code></pre><p>For the spectral truncation <code>trunc</code> (0-based, e.g. 31 for T31) return the grid resolution parameter <code>nlat_half</code> (number of latitude rings on one hemisphere including the Equator) following a dealiasing parameter (default 2) to match spectral and grid resolution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/aliasing.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.UV_from_vor!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.UV_from_vor!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.UV_from_vor!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">UV_from_vor!(
    U::LowerTriangularArray,
    V::LowerTriangularArray,
    vor::LowerTriangularArray,
    S::SpectralTransform;
    radius
) -&gt; Tuple{LowerTriangularArray, LowerTriangularArray}
</code></pre><p>Get U, V (=(u, v)*coslat) from vorticity ζ spectral space (divergence D=0) Two operations are combined into a single linear operation. First, invert the spherical Laplace ∇² operator to get stream function from vorticity. Then compute zonal and meridional gradients to get U, V. Acts on the unit sphere, i.e. it omits any radius scaling as all inplace gradient operators, unless the <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.UV_from_vordiv!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.UV_from_vordiv!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.UV_from_vordiv!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">UV_from_vordiv!(
    U::LowerTriangularArray,
    V::LowerTriangularArray,
    vor::LowerTriangularArray,
    div::LowerTriangularArray,
    S::SpectralTransform;
    radius
) -&gt; Tuple{LowerTriangularArray, LowerTriangularArray}
</code></pre><p>Get U, V (=(u, v)*coslat) from vorticity ζ and divergence D in spectral space. Two operations are combined into a single linear operation. First, invert the spherical Laplace ∇² operator to get stream function from vorticity and velocity potential from divergence. Then compute zonal and meridional gradients to get U, V. Acts on the unit sphere, i.e. it omits any radius scaling as all inplace gradient operators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L283">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms._divergence!-Tuple{Any, LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms._divergence!-Tuple{Any, LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms._divergence!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_divergence!(
    kernel,
    div::LowerTriangularArray,
    u::LowerTriangularArray,
    v::LowerTriangularArray,
    S::SpectralTransform;
    radius
) -&gt; LowerTriangularArray
</code></pre><p>Generic divergence function of vector <code>u</code>, <code>v</code> that writes into the output into <code>div</code>. Generic as it uses the kernel <code>kernel</code> such that curl, div, add or flipsign options are provided through <code>kernel</code>, but otherwise a single function is used. Acts on the unit sphere, i.e. it omits 1/radius scaling as all gradient operators, unless the <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms._fourier_batched!-Tuple{AbstractArray{&lt;:Complex, 3}, AbstractArray{&lt;:Complex, 3}, AbstractField, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms._fourier_batched!-Tuple{AbstractArray{&lt;:Complex, 3}, AbstractArray{&lt;:Complex, 3}, AbstractField, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms._fourier_batched!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_fourier_batched!(
    f_north::AbstractArray{&lt;:Complex, 3},
    f_south::AbstractArray{&lt;:Complex, 3},
    field::AbstractField,
    S::SpectralTransform
)
</code></pre><p>(Forward) Fast Fourier transform (grid to spectral) in zonal direction of <code>grids</code>, stored in scratch memories <code>f_north</code>, <code>f_south</code> to be passed on to the Legendre transform. Batched version that requires the number of vertical layers to be the same as precomputed in <code>S</code>. Not to be called directly, use <code>transform!</code> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/fourier.jl#L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms._fourier_batched!-Tuple{AbstractField, AbstractArray{&lt;:Complex, 3}, AbstractArray{&lt;:Complex, 3}, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms._fourier_batched!-Tuple{AbstractField, AbstractArray{&lt;:Complex, 3}, AbstractArray{&lt;:Complex, 3}, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms._fourier_batched!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_fourier_batched!(
    field::AbstractField,
    g_north::AbstractArray{&lt;:Complex, 3},
    g_south::AbstractArray{&lt;:Complex, 3},
    S::SpectralTransform
)
</code></pre><p>Inverse fast Fourier transform (spectral to grid) of Legendre-transformed inputs <code>g_north</code> and <code>g_south</code> to be stored in <code>field</code>. Not to be called directly, use <code>transform!</code> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/fourier.jl#L206">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms._fourier_serial!-Tuple{AbstractArray{&lt;:Complex, 3}, AbstractArray{&lt;:Complex, 3}, AbstractField, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms._fourier_serial!-Tuple{AbstractArray{&lt;:Complex, 3}, AbstractArray{&lt;:Complex, 3}, AbstractField, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms._fourier_serial!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_fourier_serial!(
    f_north::AbstractArray{&lt;:Complex, 3},
    f_south::AbstractArray{&lt;:Complex, 3},
    field::AbstractField,
    S::SpectralTransform
)
</code></pre><p>(Forward) Fast Fourier transform (grid to spectral) in zonal direction of <code>grids</code>, stored in scratch memories <code>f_north</code>, <code>f_south</code> to be passed on to the Legendre transform. Serial version that does not require the number of vertical layers to be the same as precomputed in <code>S</code>. Not to be called directly, use <code>transform!</code> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/fourier.jl#L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms._fourier_serial!-Tuple{AbstractField, AbstractArray{&lt;:Complex, 3}, AbstractArray{&lt;:Complex, 3}, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms._fourier_serial!-Tuple{AbstractField, AbstractArray{&lt;:Complex, 3}, AbstractArray{&lt;:Complex, 3}, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms._fourier_serial!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_fourier_serial!(
    field::AbstractField,
    g_north::AbstractArray{&lt;:Complex, 3},
    g_south::AbstractArray{&lt;:Complex, 3},
    S::SpectralTransform
)
</code></pre><p>(Inverse) Fast Fourier transform (spectral to grid) of Legendre-transformed inputs <code>g_north</code> and <code>g_south</code> to be stored in <code>grids</code>. Serial version that does not require the number of vertical layers to be the same as precomputed in <code>S</code>. Not to be called directly, use <code>transform!</code> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/fourier.jl#L242">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms._legendre!-Tuple{AbstractArray{&lt;:Complex, 3}, AbstractArray{&lt;:Complex, 3}, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms._legendre!-Tuple{AbstractArray{&lt;:Complex, 3}, AbstractArray{&lt;:Complex, 3}, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms._legendre!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_legendre!(
    g_north::AbstractArray{&lt;:Complex, 3},
    g_south::AbstractArray{&lt;:Complex, 3},
    specs::LowerTriangularArray,
    S::SpectralTransform;
    unscale_coslat
)
</code></pre><p>Inverse Legendre transform, batched in the vertical. Not to be used directly, but called from transform!.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/legendre.jl#L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms._legendre!-Tuple{LowerTriangularArray, AbstractArray{&lt;:Complex, 3}, AbstractArray{&lt;:Complex, 3}, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms._legendre!-Tuple{LowerTriangularArray, AbstractArray{&lt;:Complex, 3}, AbstractArray{&lt;:Complex, 3}, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms._legendre!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_legendre!(
    specs::LowerTriangularArray,
    f_north::AbstractArray{&lt;:Complex, 3},
    f_south::AbstractArray{&lt;:Complex, 3},
    S::SpectralTransform
)
</code></pre><p>(Forward) Legendre transform, batched in the vertical. Not to be used directly, but called from transform!.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/legendre.jl#L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.curl!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.curl!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.curl!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">curl!(
    curl::LowerTriangularArray,
    u::LowerTriangularArray,
    v::LowerTriangularArray,
    S::SpectralTransform;
    flipsign,
    add,
    kwargs...
) -&gt; LowerTriangularArray
</code></pre><p>Curl of a vector <code>u, v</code> written into <code>curl</code>, <code>curl = ∇×(u, v)</code>. <code>u, v</code> are expected to have a 1/coslat-scaling included, otherwise <code>curl</code> is scaled. Acts on the unit sphere, i.e. it omits 1/radius scaling as all gradient operators unless the <code>radius</code> keyword argument is provided. <code>flipsign</code> option calculates -∇×(u, v) instead. <code>add</code> option calculates <code>curl += ∇×(u, v)</code> instead. <code>flipsign</code> and <code>add</code> can be combined. This functions only creates the kernel and calls the generic divergence function _divergence! subsequently with flipped u, v -&gt; v, u for the curl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.curl-Tuple{AbstractField, AbstractField}" href="#SpeedyWeather.SpeedyTransforms.curl-Tuple{AbstractField, AbstractField}"><code>SpeedyWeather.SpeedyTransforms.curl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">curl(u::AbstractField, v::AbstractField; kwargs...) -&gt; Any
</code></pre><p>Curl (∇×) of two vector components <code>u, v</code> on a grid. Applies 1/coslat scaling, transforms to spectral space and returns the spectral curl. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.curl-Tuple{LowerTriangularArray, LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.curl-Tuple{LowerTriangularArray, LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.curl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">curl(
    u::LowerTriangularArray,
    v::LowerTriangularArray;
    kwargs...
) -&gt; Any
</code></pre><p>Curl (∇×) of two vector components <code>u, v</code> of size (n+1)xn, the last row will be set to zero in the returned <code>LowerTriangularMatrix</code>. This function requires both <code>u, v</code> to be transforms of fields that are scaled with <code>1/cos(lat)</code>. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided. An example usage is therefore</p><pre><code class="nohighlight hljs">RingGrids.scale_coslat⁻¹!(u_grid)
RingGrids.scale_coslat⁻¹!(v_grid)
u = transform(u_grid)
v = transform(v_grid)
vor = curl(u, v, radius=6.371e6)
vor_grid = transform(div)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.divergence!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.divergence!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.divergence!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">divergence!(
    div::LowerTriangularArray,
    u::LowerTriangularArray,
    v::LowerTriangularArray,
    S::SpectralTransform;
    flipsign,
    add,
    kwargs...
) -&gt; LowerTriangularArray
</code></pre><p>Divergence of a vector <code>u, v</code> written into <code>div</code>, <code>div = ∇⋅(u, v)</code>.  <code>u, v</code> are expected to have a 1/coslat-scaling included, otherwise <code>div</code> is scaled. Acts on the unit sphere, i.e. it omits 1/radius scaling as all gradient operators, unless the <code>radius</code> keyword argument is provided. <code>flipsign</code> option calculates -∇⋅(u, v) instead. <code>add</code> option calculates <code>div += ∇⋅(u, v)</code> instead. <code>flipsign</code> and <code>add</code> can be combined. This functions only creates the kernel and calls the generic divergence function _divergence! subsequently.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.divergence-Tuple{AbstractField, AbstractField}" href="#SpeedyWeather.SpeedyTransforms.divergence-Tuple{AbstractField, AbstractField}"><code>SpeedyWeather.SpeedyTransforms.divergence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">divergence(
    u::AbstractField,
    v::AbstractField;
    kwargs...
) -&gt; Any
</code></pre><p>Divergence (∇⋅) of two vector components <code>u, v</code> on a grid. Applies 1/coslat scaling, transforms to spectral space and returns the spectral divergence. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.divergence-Tuple{LowerTriangularArray, LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.divergence-Tuple{LowerTriangularArray, LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.divergence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">divergence(
    u::LowerTriangularArray,
    v::LowerTriangularArray;
    kwargs...
) -&gt; LowerTriangularArray
</code></pre><p>Divergence (∇⋅) of two vector components <code>u, v</code> which need to have size (n+1)xn, the last row will be set to zero in the returned <code>LowerTriangularMatrix</code>. This function requires both <code>u, v</code> to be transforms of fields that are scaled with <code>1/cos(lat)</code>. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided. An example usage is therefore</p><pre><code class="nohighlight hljs">RingGrids.scale_coslat⁻¹!(u_grid)
RingGrids.scale_coslat⁻¹!(v_grid)
u = transform(u_grid, one_more_degree=true)
v = transform(v_grid, one_more_degree=true)
div = divergence(u, v, radius = 6.371e6)
div_grid = transform(div)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.get_recursion_factors-Union{Tuple{NF}, Tuple{Type{NF}, Spectrum}} where NF" href="#SpeedyWeather.SpeedyTransforms.get_recursion_factors-Union{Tuple{NF}, Tuple{Type{NF}, Spectrum}} where NF"><code>SpeedyWeather.SpeedyTransforms.get_recursion_factors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_recursion_factors(
    _::Type{NF},
    spectrum::Spectrum
) -&gt; Any
</code></pre><p>Returns a matrix of recursion factors <code>ϵ</code> up to degree <code>lmax</code> and order <code>mmax</code> (1-based) of the <code>spectrum</code> in number format <code>NF</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L407">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.get_truncation" href="#SpeedyWeather.SpeedyTransforms.get_truncation"><code>SpeedyWeather.SpeedyTransforms.get_truncation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_truncation(nlat_half::Integer) -&gt; Any
get_truncation(nlat_half::Integer, dealiasing::Real) -&gt; Any
</code></pre><p>For the grid resolution parameter <code>nlat_half</code> (e.g. 24 for a 48-ring FullGaussianGrid) return the spectral truncation <code>trunc</code> (max degree of spherical harmonics) following a dealiasing parameter (default 2) to match spectral and grid resolution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/aliasing.jl#L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.is_power_2-Tuple{Integer}" href="#SpeedyWeather.SpeedyTransforms.is_power_2-Tuple{Integer}"><code>SpeedyWeather.SpeedyTransforms.is_power_2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">true/false = is_power_2(i::Integer)</code></pre><p>Checks whether an integer <code>i</code> is a power of 2, i.e. i = 2^k, with k = 0, 1, 2, 3, ....</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/aliasing.jl#L61-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.ismatching-Tuple{SpectralTransform, AbstractField}" href="#SpeedyWeather.SpeedyTransforms.ismatching-Tuple{SpectralTransform, AbstractField}"><code>SpeedyWeather.SpeedyTransforms.ismatching</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ismatching(
    S::SpectralTransform,
    field::AbstractField
) -&gt; Any
</code></pre><p>Spectral transform <code>S</code> and <code>grid</code> match if the resolution <code>nlat_half</code> and the type of the grid match and the number of vertical layers is equal or larger in the transform (constraints due to allocated scratch memory size).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.ismatching-Tuple{SpectralTransform, LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.ismatching-Tuple{SpectralTransform, LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.ismatching</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ismatching(
    S::SpectralTransform,
    L::LowerTriangularArray
) -&gt; Any
</code></pre><p>Spectral transform <code>S</code> and lower triangular matrix <code>L</code> match if the spectral dimensions <code>(lmax, mmax)</code> match and the number of vertical layers is equal or larger in the transform (constraints due to allocated scratch memory size).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L361">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.plan_FFTs!-Union{Tuple{N}, Tuple{NF}, Tuple{Vector{AbstractFFTs.Plan}, Vector{AbstractFFTs.Plan}, Vector{AbstractFFTs.Plan}, Vector{AbstractFFTs.Plan}, AbstractField{NF, N, &lt;:AbstractArray{NF}}, AbstractArray{Complex{NF}}, AbstractArray, Vector{&lt;:Int64}}} where {NF&lt;:AbstractFloat, N}" href="#SpeedyWeather.SpeedyTransforms.plan_FFTs!-Union{Tuple{N}, Tuple{NF}, Tuple{Vector{AbstractFFTs.Plan}, Vector{AbstractFFTs.Plan}, Vector{AbstractFFTs.Plan}, Vector{AbstractFFTs.Plan}, AbstractField{NF, N, &lt;:AbstractArray{NF}}, AbstractArray{Complex{NF}}, AbstractArray, Vector{&lt;:Int64}}} where {NF&lt;:AbstractFloat, N}"><code>SpeedyWeather.SpeedyTransforms.plan_FFTs!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plan_FFTs!(
    rfft_plans::Vector{AbstractFFTs.Plan},
    brfft_plans::Vector{AbstractFFTs.Plan},
    rfft_plans_1D::Vector{AbstractFFTs.Plan},
    brfft_plans_1D::Vector{AbstractFFTs.Plan},
    fake_grid_data::AbstractField{NF&lt;:AbstractFloat, N, &lt;:AbstractArray{NF&lt;:AbstractFloat}},
    scratch_memory_north::AbstractArray{Complex{NF&lt;:AbstractFloat}},
    rings::AbstractArray,
    nlons::Vector{&lt;:Int64}
) -&gt; NTuple{4, Vector{AbstractFFTs.Plan}}
</code></pre><p>Util function to generate FFT plans based on the array type of the fake Grid  data provided. Uses views, which is less allocate-y than indexing but breaks  when using CuArrays (see CUDA extension for alternative implementation for  CuArrays).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/fourier.jl#L282">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.power_spectrum-Tuple{LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.power_spectrum-Tuple{LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.power_spectrum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">power_spectrum(spec::LowerTriangularArray; normalize) -&gt; Any
</code></pre><p>Compute the power spectrum of the spherical harmonic coefficients <code>spec</code> (lower triangular matrix/array) of type <code>Complex{NF}</code>. For any additional dimensions in <code>spec</code>, the power spectrum is computed along the first/spherical harmonic dimension.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/power_spectrum.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.recursion_factor-Tuple{Int64, Int64}" href="#SpeedyWeather.SpeedyTransforms.recursion_factor-Tuple{Int64, Int64}"><code>SpeedyWeather.SpeedyTransforms.recursion_factor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">recursion_factor(l::Int64, m::Int64) -&gt; Float64
</code></pre><p>Recursion factors <code>ϵ</code> as a function of degree <code>l</code> and order <code>m</code> (0-based) of the spherical harmonics. ϵ(l, m) = sqrt((l^2-m^2)/(4*l^2-1)).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L401">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.roundup_fft-Union{Tuple{Integer}, Tuple{T}} where T&lt;:Integer" href="#SpeedyWeather.SpeedyTransforms.roundup_fft-Union{Tuple{Integer}, Tuple{T}} where T&lt;:Integer"><code>SpeedyWeather.SpeedyTransforms.roundup_fft</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">m = roundup_fft(n::Int;
                small_primes::Vector{Int}=[2, 3, 5])</code></pre><p>Returns an integer <code>m &gt;= n</code> with only small prime factors 2, 3 (default, others can be specified with the keyword argument <code>small_primes</code>) to obtain an efficiently fourier-transformable number of longitudes, m = 2^i * 3^j * 5^k &gt;= n, with i, j, k &gt;=0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/aliasing.jl#L33-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_interpolation-Union{Tuple{ArrayType}, Tuple{S}, Tuple{N}, Tuple{T}, Tuple{NF}, Tuple{Type{NF}, LowerTriangularArray{T, N, ArrayType, S}, Integer, Integer}} where {NF, T, N, S, ArrayType}" href="#SpeedyWeather.SpeedyTransforms.spectral_interpolation-Union{Tuple{ArrayType}, Tuple{S}, Tuple{N}, Tuple{T}, Tuple{NF}, Tuple{Type{NF}, LowerTriangularArray{T, N, ArrayType, S}, Integer, Integer}} where {NF, T, N, S, ArrayType}"><code>SpeedyWeather.SpeedyTransforms.spectral_interpolation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_interpolation(
    _::Type{NF},
    alms::LowerTriangularArray{T, N, ArrayType, S},
    ltrunc::Integer,
    mtrunc::Integer
) -&gt; Any
</code></pre><p>Returns a LowerTriangularArray that is interpolated from <code>alms</code> to the size (<code>ltrunc</code>+1) x (<code>mtrunc</code>+1), both inputs are 0-based, by padding zeros for higher wavenumbers. If <code>ltrunc</code> or <code>mtrunc</code> are smaller than the corresponding size of<code>alms</code> than <code>spectral_truncation</code> is automatically called instead, returning a smaller LowerTriangularArray.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_truncation.jl#L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_smoothing!-Tuple{LowerTriangularArray, Real}" href="#SpeedyWeather.SpeedyTransforms.spectral_smoothing!-Tuple{LowerTriangularArray, Real}"><code>SpeedyWeather.SpeedyTransforms.spectral_smoothing!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_smoothing!(
    L::LowerTriangularArray,
    c::Real;
    power,
    truncation
)
</code></pre><p>Smooth the spectral field <code>A</code> following A <em>= (1-(1-c)</em>∇²ⁿ) with power n of a normalised Laplacian so that the highest degree lmax is dampened by multiplication with c. Anti-diffusion for c&gt;1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_truncation.jl#L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_smoothing-Tuple{LowerTriangularArray, Real}" href="#SpeedyWeather.SpeedyTransforms.spectral_smoothing-Tuple{LowerTriangularArray, Real}"><code>SpeedyWeather.SpeedyTransforms.spectral_smoothing</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_smoothing(
    A::LowerTriangularArray,
    c::Real;
    power
) -&gt; Any
</code></pre><p>Smooth the spectral field <code>A</code> following A_smooth = (1-c*∇²ⁿ)A with power n of a normalised Laplacian so that the highest degree lmax is dampened by multiplication with c. Anti-diffusion for c&lt;0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_truncation.jl#L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{AbstractMatrix}" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{AbstractMatrix}"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(
    A::AbstractMatrix
) -&gt; LowerTriangularArray{T, 2, ArrayType} where {T, ArrayType&lt;:AbstractMatrix{T}}
</code></pre><p>Sets the upper triangle of <code>A</code> to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_truncation.jl#L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{LowerTriangularArray, Integer, Integer}" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{LowerTriangularArray, Integer, Integer}"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(
    alms::LowerTriangularArray,
    ltrunc::Integer,
    mtrunc::Integer
) -&gt; LowerTriangularArray
</code></pre><p>Triangular truncation to degree <code>ltrunc</code> and order <code>mtrunc</code> (both 0-based). Truncate spectral coefficients <code>alms</code> in-place by setting all coefficients for which the degree <code>l</code> is larger than the truncation <code>ltrunc</code> or order <code>m</code> larger than the truncaction <code>mtrunc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_truncation.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{LowerTriangularArray, Integer}" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{LowerTriangularArray, Integer}"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(
    alms::LowerTriangularArray,
    trunc::Integer
) -&gt; LowerTriangularArray
</code></pre><p>Triangular truncation of <code>alms</code> to degree and order <code>trunc</code> in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_truncation.jl#L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(
    alms::LowerTriangularArray
) -&gt; LowerTriangularArray
</code></pre><p>Triangular truncation of <code>alms</code> to the size of it, sets additional rows to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_truncation.jl#L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation-Union{Tuple{ArrayType}, Tuple{S}, Tuple{N}, Tuple{T}, Tuple{NF}, Tuple{Type{NF}, LowerTriangularArray{T, N, ArrayType, S}, Integer, Integer}} where {NF, T, N, S, ArrayType}" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation-Union{Tuple{ArrayType}, Tuple{S}, Tuple{N}, Tuple{T}, Tuple{NF}, Tuple{Type{NF}, LowerTriangularArray{T, N, ArrayType, S}, Integer, Integer}} where {NF, T, N, S, ArrayType}"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_truncation(
    _::Type{NF},
    alms::LowerTriangularArray{T, N, ArrayType, S},
    ltrunc::Integer,
    mtrunc::Integer
) -&gt; Any
</code></pre><p>Returns a LowerTriangularArray that is truncated from <code>alms</code> to the size (<code>ltrunc</code>+1) x (<code>mtrunc</code>+1), both inputs are 0-based. If <code>ltrunc</code> or <code>mtrunc</code> is larger than the corresponding size of<code>alms</code> than <code>spectral_interpolation</code> is automatically called instead, returning a LowerTriangularArray padded zero coefficients for higher wavenumbers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_truncation.jl#L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform!-Tuple{AbstractField, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.transform!-Tuple{AbstractField, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.transform!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform!(
    field::AbstractField,
    coeffs::LowerTriangularArray,
    S::SpectralTransform;
    unscale_coslat
) -&gt; AbstractField
</code></pre><p>Spectral transform (spectral to grid space) from n-dimensional array <code>coeffs</code> of spherical harmonic coefficients to an n-dimensional array <code>field</code>. Uses FFT in the zonal direction, and a Legendre Transform in the meridional direction exploiting symmetries. The spectral transform is number format-flexible but <code>field</code> and the spectral transform <code>S</code> have to have the same number format. Uses the precalculated arrays, FFT plans and other constants in the SpectralTransform struct <code>S</code>. The spectral transform is grid-flexible as long as <code>field.grid</code> and <code>S.grid</code> match.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L425">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform!-Tuple{LowerTriangularArray, AbstractField, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.transform!-Tuple{LowerTriangularArray, AbstractField, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.transform!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform!(
    coeffs::LowerTriangularArray,
    field::AbstractField,
    S::SpectralTransform
) -&gt; LowerTriangularArray
</code></pre><p>Spectral transform (grid to spectral space) from n-dimensional array <code>field</code> to an n-dimensional array <code>coeffs</code> of spherical harmonic coefficients. Uses FFT in the zonal direction, and a Legendre Transform in the meridional direction exploiting symmetries. The spectral transform is number format-flexible but <code>field</code> and the spectral transform <code>S</code> have to have the same number format. Uses the precalculated arrays, FFT plans and other constants in the SpectralTransform struct <code>S</code>. The spectral transform is grid-flexible as long as <code>field.grid</code> and <code>S.grid</code> match.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L455">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform-Tuple{AbstractField, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.transform-Tuple{AbstractField, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform(field::AbstractField, S::SpectralTransform) -&gt; Any
</code></pre><p>Spherical harmonic transform from <code>field</code> to a newly allocated <code>coeffs::LowerTriangularArray</code> using the precomputed spectral transform <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L486">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform-Tuple{AbstractField}" href="#SpeedyWeather.SpeedyTransforms.transform-Tuple{AbstractField}"><code>SpeedyWeather.SpeedyTransforms.transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform(field::AbstractField; kwargs...) -&gt; Any
</code></pre><p>Spectral transform (grid to spectral space) from <code>field</code> to a newly allocated <code>LowerTriangularArray</code>. Based on the size of <code>field</code> and the keyword <code>dealiasing</code> the spectral resolution trunc is retrieved. SpectralTransform struct <code>S</code> is allocated to execute <code>transform(field, S)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L527">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform-Tuple{LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.transform-Tuple{LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform(
    coeffs::LowerTriangularArray,
    S::SpectralTransform;
    kwargs...
) -&gt; Any
</code></pre><p>Spherical harmonic transform from <code>coeffs</code> to a newly allocated <code>field::AbstractField</code> using the precomputed spectral transform <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L499">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform-Tuple{LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.transform-Tuple{LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform(
    coeffs::LowerTriangularArray;
    unscale_coslat,
    kwargs...
) -&gt; Field{_A, _B, _C, FullGaussianGrid{SpeedyWeather.RingGrids.DummyArchitecture, _A1, _B1}} where {_A, _B, _C&lt;:AbstractArray, _A1, _B1}
</code></pre><p>Spectral transform (spectral to grid space) from spherical coefficients <code>alms</code> to a newly allocated gridded field <code>map</code>. Based on the size of <code>alms</code> the grid type <code>grid</code>, the spatial resolution is retrieved based on the truncation defined for <code>grid</code>. SpectralTransform struct <code>S</code> is allocated to execute <code>transform(alms, S)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_transform.jl#L513">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.zero_imaginary_zonal_modes!-Tuple{LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.zero_imaginary_zonal_modes!-Tuple{LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.zero_imaginary_zonal_modes!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">zero_imaginary_zonal_modes!(
    alms::LowerTriangularArray
) -&gt; LowerTriangularArray
</code></pre><p>Set imaginary component of m=0 modes (the zonal modes in the first column) to 0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_truncation.jl#L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇!(
    dpdx::LowerTriangularArray,
    dpdy::LowerTriangularArray,
    p::LowerTriangularArray,
    S::SpectralTransform;
    radius
) -&gt; Tuple{LowerTriangularArray, LowerTriangularArray}
</code></pre><p>Applies the gradient operator ∇ applied to input <code>p</code> and stores the result in <code>dpdx</code> (zonal derivative) and <code>dpdy</code> (meridional derivative). The gradient operator acts on the unit sphere and therefore omits the 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L488">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇-Tuple{AbstractField, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇-Tuple{AbstractField, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇(
    field::AbstractField,
    S::SpectralTransform;
    kwargs...
) -&gt; Tuple{Any, Any}
</code></pre><p>The zonal and meridional gradient of <code>grid</code>. Transform to spectral space, takes the gradient and unscales the 1/coslat scaling in the gradient. Acts on the unit-sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided. Makes use of an existing spectral transform <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L567">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇-Tuple{AbstractField}" href="#SpeedyWeather.SpeedyTransforms.∇-Tuple{AbstractField}"><code>SpeedyWeather.SpeedyTransforms.∇</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇(field::AbstractField; kwargs...) -&gt; Tuple{Any, Any}
</code></pre><p>The zonal and meridional gradient of <code>grid</code>. Transform to spectral space, takes the gradient and unscales the 1/coslat scaling in the gradient. Acts on the unit-sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L579">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇-Tuple{LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇-Tuple{LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇(
    p::LowerTriangularArray,
    S::SpectralTransform;
    kwargs...
) -&gt; Tuple{Any, Any}
</code></pre><p>The zonal and meridional gradient of <code>p</code> using an existing <code>SpectralTransform</code> <code>S</code>. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L549">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇-Tuple{LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.∇-Tuple{LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.∇</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇(p::LowerTriangularArray; kwargs...) -&gt; Tuple{Any, Any}
</code></pre><p>The zonal and meridional gradient of <code>p</code>. Precomputes a <code>SpectralTransform</code> <code>S</code>. Acts on the unit-sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L559">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇²!-Tuple{LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇²!-Tuple{LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇²!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇²!(
    ∇²alms::LowerTriangularArray,
    alms::LowerTriangularArray,
    S::SpectralTransform;
    add,
    flipsign,
    inverse,
    radius
) -&gt; LowerTriangularArray
</code></pre><p>Laplace operator ∇² applied to the spectral coefficients <code>alms</code> in spherical coordinates. The eigenvalues which are precomputed in <code>S</code>. ∇²! is the in-place version which directly stores the output in the first argument <code>∇²alms</code>. Acts on the unit sphere, i.e. it omits any radius scaling as all inplace gradient operators, unless the <code>radius</code> keyword argument is provided.</p><p><strong>Keyword arguments</strong></p><ul><li><code>add=true</code> adds the ∇²(alms) to the output</li><li><code>flipsign=true</code> computes -∇²(alms) instead</li><li><code>inverse=true</code> computes ∇⁻²(alms) instead</li></ul><p>Default is <code>add=false</code>, <code>flipsign=false</code>, <code>inverse=false</code>. These options can be combined.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L376">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇²-Tuple{LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇²-Tuple{LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇²</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇²(
    alms::LowerTriangularArray,
    S::SpectralTransform;
    kwargs...
) -&gt; Any
</code></pre><p>Laplace operator ∇² applied to input <code>alms</code>, using precomputed eigenvalues from <code>S</code>. Acts on the unit sphere, i.e. it omits 1/radius^2 scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L431">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇²-Tuple{LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.∇²-Tuple{LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.∇²</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇²(alms::LowerTriangularArray; kwargs...) -&gt; Any
</code></pre><p>Returns the Laplace operator ∇² applied to input <code>alms</code>. Acts on the unit sphere, i.e. it omits 1/radius^2 scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L446">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇⁻²!-Tuple{LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇⁻²!-Tuple{LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇⁻²!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇⁻²!(
    ∇⁻²alms::LowerTriangularArray,
    alms::LowerTriangularArray,
    S::SpectralTransform;
    add,
    flipsign,
    kwargs...
) -&gt; LowerTriangularArray
</code></pre><p>Calls <code>∇²!(∇⁻²alms, alms, S; add, flipsign, inverse=true)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L475">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇⁻²-Tuple{LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇⁻²-Tuple{LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇⁻²</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇⁻²(
    ∇²alms::LowerTriangularArray,
    S::SpectralTransform;
    kwargs...
) -&gt; Any
</code></pre><p>InverseLaplace operator ∇⁻² applied to input <code>alms</code>, using precomputed eigenvalues from <code>S</code>. Acts on the unit sphere, i.e. it omits radius^2 scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L453">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇⁻²-Tuple{LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.∇⁻²-Tuple{LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.∇⁻²</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇⁻²(∇²alms::LowerTriangularArray; kwargs...) -&gt; Any
</code></pre><p>Returns the inverse Laplace operator ∇⁻² applied to input <code>alms</code>. Acts on the unit sphere, i.e. it omits radius^2 scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/4a80fa4ce36972b6ac0c6fe7bf0a28e68ac2d93d/src/SpeedyTransforms/spectral_gradients.jl#L468">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lowertriangularmatrices/">« LowerTriangularArrays</a><a class="docs-footer-nextpage" href="../gradients/">Gradient operators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Wednesday 18 June 2025 16:13">Wednesday 18 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
