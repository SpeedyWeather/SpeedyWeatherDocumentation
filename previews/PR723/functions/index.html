<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Function and type index · SpeedyWeather.jl</title><meta name="title" content="Function and type index · SpeedyWeather.jl"/><meta property="og:title" content="Function and type index · SpeedyWeather.jl"/><meta property="twitter:title" content="Function and type index · SpeedyWeather.jl"/><meta name="description" content="Documentation for SpeedyWeather.jl."/><meta property="og:description" content="Documentation for SpeedyWeather.jl."/><meta property="twitter:description" content="Documentation for SpeedyWeather.jl."/><meta property="og:url" content="https://speedyweather.github.io/SpeedyWeatherDocumentation/stable/functions/"/><meta property="twitter:url" content="https://speedyweather.github.io/SpeedyWeatherDocumentation/stable/functions/"/><link rel="canonical" href="https://speedyweather.github.io/SpeedyWeatherDocumentation/stable/functions/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpeedyWeather.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Running SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../how_to_run_speedy/">How to run SpeedyWeather</a></li><li><a class="tocitem" href="../examples_2D/">Examples 2D</a></li><li><a class="tocitem" href="../examples_3D/">Examples 3D</a></li><li><a class="tocitem" href="../initial_conditions/">Initial conditions</a></li><li><a class="tocitem" href="../tracers/">Tracer advection</a></li><li><a class="tocitem" href="../particles/">Particle advection</a></li><li><a class="tocitem" href="../stochastic_physics/">Stochastic physics</a></li><li><a class="tocitem" href="../land/">Land surface model</a></li><li><a class="tocitem" href="../analysis/">Analysis</a></li><li><a class="tocitem" href="../structure/">Tree structure</a></li><li><a class="tocitem" href="../differentiability/">Differentiability and Adjoint Model</a></li><li><a class="tocitem" href="../output/">NetCDF output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Extending SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../extensions/">Extensions</a></li><li><a class="tocitem" href="../forcing_drag/">Forcing and drag</a></li><li><a class="tocitem" href="../parameterizations/">Parameterizations</a></li><li><a class="tocitem" href="../orography/">Orography</a></li><li><a class="tocitem" href="../land_sea_mask/">Land-Sea Mask</a></li><li><a class="tocitem" href="../ocean/">Ocean</a></li><li><a class="tocitem" href="../custom_netcdf_output/">NetCDF output variables</a></li><li><a class="tocitem" href="../callbacks/">Callbacks</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Dynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../barotropic/">Barotropic model</a></li><li><a class="tocitem" href="../shallowwater/">Shallow water model</a></li><li><a class="tocitem" href="../primitiveequation/">Primitive equation model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../large_scale_condensation/">Large-scale condensation</a></li><li><a class="tocitem" href="../convection/">Convection</a></li><li><a class="tocitem" href="../radiation/">Radiation</a></li><li><a class="tocitem" href="../vertical_diffusion/">Vertical diffusion</a></li><li><a class="tocitem" href="../surface_fluxes/">Surface fluxes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../spectral_transform/">Spherical Harmonic Transform</a></li><li><a class="tocitem" href="../grids/">Grids</a></li></ul></li><li><a class="tocitem" href="../ringgrids/">RingGrids</a></li><li><a class="tocitem" href="../lowertriangularmatrices/">LowerTriangularMatrices</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">SpeedyTransforms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../speedytransforms/">Spectral transforms</a></li><li><a class="tocitem" href="../gradients/">Gradient operators</a></li></ul></li><li class="is-active"><a class="tocitem" href>Function and type index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Function and type index</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Function and type index</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/main/docs/src/functions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Function-and-type-index"><a class="docs-heading-anchor" href="#Function-and-type-index">Function and type index</a><a id="Function-and-type-index-1"></a><a class="docs-heading-anchor-permalink" href="#Function-and-type-index" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Core.Type-Tuple{SpectralGrid}" href="#Core.Type-Tuple{SpectralGrid}"><code>Core.Type</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generator function pulling the resolution information from <code>spectral_grid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/land_sea_mask.jl#L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.AbstractDevice" href="#SpeedyWeather.AbstractDevice"><code>SpeedyWeather.AbstractDevice</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractDevice</code></pre><p>Supertype of all devices SpeedyWeather.jl can run on.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/gpu.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.AbstractLandSeaMask" href="#SpeedyWeather.AbstractLandSeaMask"><code>SpeedyWeather.AbstractLandSeaMask</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract super type for land-sea masks. Custom land-sea masks have to be defined as</p><pre><code class="nohighlight hljs">CustomMask{NF&lt;:AbstractFloat, Grid&lt;:AbstractGrid{NF}} &lt;: AbstractLandSeaMask</code></pre><p>and need to have at least a field called <code>mask::Grid</code> that uses a <code>Grid</code> as defined by the spectral grid object, so of correct size and with the number format <code>NF</code>. All <code>AbstractLandSeaMask</code> have a convenient generator function to be used like <code>mask = CustomMask(spectral_grid, option=argument)</code>, but you may add your own or customize by defining <code>CustomMask(args...)</code> which should return an instance of type <code>CustomMask{NF, Grid}</code> with parameters matching the spectral grid. Then the initialize function has to be extended for that new mask</p><pre><code class="nohighlight hljs">initialize!(mask::CustomMask, model::PrimitiveEquation)</code></pre><p>which generally is used to tweak the mask.mask grid as you like, using any other options you have included in <code>CustomMask</code> as fields or anything else (preferrably read-only, because this is only to initialize the land-sea mask, nothing else) from <code>model</code>. You can for example read something from file, set some values manually, or use coordinates from <code>model.geometry</code>.</p><p>The land-sea mask grid is expected to have values between [0, 1] as we use a fractional mask, allowing for grid points being, e.g. quarter land and three quarters sea for 0.25 with 0 (=sea) and 1 (=land). The surface fluxes will weight proportionally the fluxes e.g. from sea and land surface temperatures. Note however, that the land-sea mask can declare grid points being (at least partially) ocean even though the sea surface temperatures aren&#39;t defined (=NaN) in that grid point. In that case, not flux is applied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/land_sea_mask.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.AbstractOcean" href="#SpeedyWeather.AbstractOcean"><code>SpeedyWeather.AbstractOcean</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract super type for ocean models, which control the sea surface temperature and sea ice concentration as boundary conditions to a SpeedyWeather simulation. A new ocean model has to be defined as</p><pre><code class="nohighlight hljs">CustomOceanModel &lt;: AbstractOcean</code></pre><p>and can have parameters like <code>CustomOceanModel{T}</code> and fields. They need to extend the following functions</p><pre><code class="nohighlight hljs">function initialize!(ocean_model::CustomOceanModel, model::PrimitiveEquation)
    # your code here to initialize the ocean model itself
    # you can use other fields from model, e.g. model.geometry
end

function initialize!(
    ocean::PrognosticVariablesOcean,
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    ocean_model::CustomOceanModel,
    model::PrimitiveEquation,
)
    # your code here to initialize the prognostic variables for the ocean
    # namely, ocean.sea_surface_temperature, ocean.sea_ice_concentration, e.g.
    # ocean.sea_surface_temperature .= 300      # 300K everywhere
end

function ocean_timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    ocean_model::CustomOceanModel,
    model::PrimitiveEquation,
)
    # your code here to change the progn.ocean.sea_surface_temperature and/or
    # progn.ocean.sea_ice_concentration on any timestep
end</code></pre><p>Temperatures in ocean.sea<em>surface</em>temperature have units of Kelvin, or NaN for no ocean. Note that neither sea surface temperature, land-sea mask or orography have to agree. It is possible to have an ocean on top of a mountain. For an ocean grid-cell that is (partially) masked by the land-sea mask, its value will be (fractionally) ignored in the calculation of surface fluxes (potentially leading to a zero flux depending on land surface temperatures). For an ocean grid-cell that is NaN but not masked by the land-sea mask, its value is always ignored.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/ocean.jl#L1-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.AdiabaticConversion" href="#SpeedyWeather.AdiabaticConversion"><code>SpeedyWeather.AdiabaticConversion</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Terms used to compute the adiabatic conversion term in the spectral model. Fields are: </p><ul><li><p><code>nlayers::Int64</code></p></li><li><p><code>σ_lnp_A::Any</code>: σ-related factor A needed for adiabatic conversion term</p></li><li><p><code>σ_lnp_B::Any</code>: σ-related factor B needed for adiabatic conversion term</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/adiabatic_conversion.jl#L5-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.AlbedoOutput" href="#SpeedyWeather.AlbedoOutput"><code>SpeedyWeather.AlbedoOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/radiation.jl#L29-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.AquaPlanet" href="#SpeedyWeather.AquaPlanet"><code>SpeedyWeather.AquaPlanet</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>AquaPlanet sea surface temperatures that are constant in time and longitude, but vary in latitude following a coslat². To be created like</p><pre><code class="nohighlight hljs">ocean = AquaPlanet(spectral_grid, temp_equator=302, temp_poles=273)</code></pre><p>Fields and options are</p><ul><li><p><code>temp_equator::Any</code>: [OPTION] Temperature on the Equator [K]</p></li><li><p><code>temp_poles::Any</code>: [OPTION] Temperature at the poles [K]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/ocean.jl#L238-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.AquaPlanetMask" href="#SpeedyWeather.AquaPlanetMask"><code>SpeedyWeather.AquaPlanetMask</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Land-sea mask with zero = sea everywhere.</p><ul><li><code>mask::Any</code>: Land-sea mask [1] on grid-point space. Land=1, sea=0, land-area fraction in between.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/land_sea_mask.jl#L136-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.BarotropicModel" href="#SpeedyWeather.BarotropicModel"><code>SpeedyWeather.BarotropicModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The BarotropicModel contains all model components needed for the simulation of the barotropic vorticity equations. To be constructed like</p><pre><code class="nohighlight hljs">model = BarotropicModel(spectral_grid; kwargs...)</code></pre><p>with <code>spectral_grid::SpectralGrid</code> used to initalize all non-default components passed on as keyword arguments, e.g. <code>planet=Earth(spectral_grid)</code>. Fields, representing model components, are</p><ul><li><p><code>spectral_grid::SpectralGrid</code></p></li><li><p><code>device_setup::Any</code></p></li><li><p><code>geometry::Any</code></p></li><li><p><code>planet::Any</code></p></li><li><p><code>atmosphere::Any</code></p></li><li><p><code>coriolis::Any</code></p></li><li><p><code>forcing::Any</code></p></li><li><p><code>drag::Any</code></p></li><li><p><code>particle_advection::Any</code></p></li><li><p><code>initial_conditions::Any</code></p></li><li><p><code>random_process::Any</code></p></li><li><p><code>tracers::Dict{Symbol, Tracer}</code></p></li><li><p><code>time_stepping::Any</code></p></li><li><p><code>spectral_transform::Any</code></p></li><li><p><code>implicit::Any</code></p></li><li><p><code>horizontal_diffusion::Any</code></p></li><li><p><code>output::Any</code></p></li><li><p><code>callbacks::Dict{Symbol, SpeedyWeather.AbstractCallback}</code></p></li><li><p><code>feedback::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/barotropic.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.BulkRichardsonDrag" href="#SpeedyWeather.BulkRichardsonDrag"><code>SpeedyWeather.BulkRichardsonDrag</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Boundary layer drag coefficient from the bulk Richardson number, following Frierson, 2006, Journal of the Atmospheric Sciences.</p><ul><li><p><code>κ::Any</code>: von Kármán constant [1]</p></li><li><p><code>z₀::Any</code>: roughness length [m]</p></li><li><p><code>Ri_c::Any</code>: Critical Richardson number for stable mixing cutoff [1]</p></li><li><p><code>drag_max::Base.RefValue</code>: Maximum drag coefficient, κ²/log(zₐ/z₀) for zₐ from reference temperature</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/boundary_layer.jl#L94-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.CPU" href="#SpeedyWeather.CPU"><code>SpeedyWeather.CPU</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CPU &lt;: AbstractDevice</code></pre><p>Indicates that SpeedyWeather.jl runs on a single CPU.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/gpu.jl#L10-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ClausiusClapeyron" href="#SpeedyWeather.ClausiusClapeyron"><code>SpeedyWeather.ClausiusClapeyron</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Parameters for computing saturation vapour pressure of water using the Clausis-Clapeyron equation,</p><pre><code class="nohighlight hljs">e(T) = e₀ * exp( -Lᵥ/Rᵥ * (1/T - 1/T₀)),</code></pre><p>where T is in Kelvin, Lᵥ the the latent heat of condensation and Rᵥ the gas constant of water vapour</p><ul><li><p><code>e₀::AbstractFloat</code>: Saturation water vapour pressure at 0°C [Pa]</p></li><li><p><code>T₀::AbstractFloat</code>: 0°C in Kelvin</p></li><li><p><code>Lᵥ::AbstractFloat</code>: Latent heat of condensation/vaporization of water [J/kg]</p></li><li><p><code>cₚ::AbstractFloat</code>: Specific heat at constant pressure [J/K/kg]</p></li><li><p><code>R_vapour::AbstractFloat</code>: Gas constant of water vapour [J/kg/K]</p></li><li><p><code>R_dry::AbstractFloat</code>: Gas constant of dry air [J/kg/K]</p></li><li><p><code>Lᵥ_Rᵥ::AbstractFloat</code>: Latent heat of condensation divided by gas constant of water vapour [K]</p></li><li><p><code>T₀⁻¹::AbstractFloat</code>: Inverse of T₀, one over 0°C in Kelvin</p></li><li><p><code>mol_ratio::AbstractFloat</code>: Ratio of molecular masses [1] of water vapour over dry air (=R<em>dry/R</em>vapour).</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L5-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ClausiusClapeyron-Tuple{NF} where NF" href="#SpeedyWeather.ClausiusClapeyron-Tuple{NF} where NF"><code>SpeedyWeather.ClausiusClapeyron</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Functor: Saturation water vapour pressure as a function of temperature using the Clausius-Clapeyron equation,</p><pre><code class="nohighlight hljs">e(T) = e₀ * exp( -Lᵥ/Rᵥ * (1/T - 1/T₀)),</code></pre><p>where T is in Kelvin, Lᵥ the the latent heat of vaporization and Rᵥ the gas constant of water vapour, T₀ is 0˚C in Kelvin.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Clock" href="#SpeedyWeather.Clock"><code>SpeedyWeather.Clock</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Clock struct keeps track of the model time, how many days to integrate for and how many time steps this takes.</p><ul><li><p><code>time::DateTime</code>: current model time</p></li><li><p><code>start::DateTime</code>: start time of simulation</p></li><li><p><code>period::Second</code>: period to integrate for</p></li><li><p><code>timestep_counter::Int64</code>: Counting all time steps during simulation</p></li><li><p><code>n_timesteps::Int64</code>: number of time steps to integrate for, set in <code>initialize!(::Clock, ::AbstractTimeStepper)</code></p></li><li><p><code>Δt::Millisecond</code>: Time step</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/clock.jl#L6-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Clock-Tuple{SpeedyWeather.AbstractTimeStepper}" href="#SpeedyWeather.Clock-Tuple{SpeedyWeather.AbstractTimeStepper}"><code>SpeedyWeather.Clock</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Clock(
    time_stepping::SpeedyWeather.AbstractTimeStepper;
    kwargs...
) -&gt; Clock
</code></pre><p>Create and initialize a clock from <code>time_stepping</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/clock.jl#L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.CloudTopOutput" href="#SpeedyWeather.CloudTopOutput"><code>SpeedyWeather.CloudTopOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/precipitation.jl#L95-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ColumnVariables" href="#SpeedyWeather.ColumnVariables"><code>SpeedyWeather.ColumnVariables</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Mutable struct that contains all prognostic (copies thereof) and diagnostic variables in a single column needed to evaluate the physical parametrizations. For now the struct is mutable as we will reuse the struct to iterate over horizontal grid points. Most column vectors have <code>nlayers</code> entries, from [1] at the top to [end] at the lowermost model level at the planetary boundary layer.</p><ul><li><p><code>nlayers::Int64</code></p></li><li><p><code>nbands_shortwave::Int64</code></p></li><li><p><code>nbands_longwave::Int64</code></p></li><li><p><code>ij::Int64</code></p></li><li><p><code>jring::Int64</code></p></li><li><p><code>lond::Any</code></p></li><li><p><code>latd::Any</code></p></li><li><p><code>land_fraction::Any</code></p></li><li><p><code>orography::Any</code></p></li><li><p><code>u::Any</code></p></li><li><p><code>v::Any</code></p></li><li><p><code>temp::Any</code></p></li><li><p><code>humid::Any</code></p></li><li><p><code>ln_pres::Any</code></p></li><li><p><code>pres::Any</code></p></li><li><p><code>u_tend::Any</code></p></li><li><p><code>v_tend::Any</code></p></li><li><p><code>temp_tend::Any</code></p></li><li><p><code>humid_tend::Any</code></p></li><li><p><code>flux_u_upward::Any</code></p></li><li><p><code>flux_u_downward::Any</code></p></li><li><p><code>flux_v_upward::Any</code></p></li><li><p><code>flux_v_downward::Any</code></p></li><li><p><code>flux_temp_upward::Any</code></p></li><li><p><code>flux_temp_downward::Any</code></p></li><li><p><code>flux_humid_upward::Any</code></p></li><li><p><code>flux_humid_downward::Any</code></p></li><li><p><code>random_value::Any</code></p></li><li><p><code>boundary_layer_depth::Int64</code></p></li><li><p><code>boundary_layer_drag::Any</code></p></li><li><p><code>surface_geopotential::Any</code></p></li><li><p><code>surface_u::Any</code></p></li><li><p><code>surface_v::Any</code></p></li><li><p><code>surface_temp::Any</code></p></li><li><p><code>surface_humid::Any</code></p></li><li><p><code>surface_wind_speed::Any</code></p></li><li><p><code>skin_temperature_sea::Any</code></p></li><li><p><code>skin_temperature_land::Any</code></p></li><li><p><code>soil_moisture_availability::Any</code></p></li><li><p><code>evaporative_flux::Any</code></p></li><li><p><code>evaporative_flux_ocean::Any</code></p></li><li><p><code>evaporative_flux_land::Any</code></p></li><li><p><code>sensible_heat_flux::Any</code></p></li><li><p><code>sensible_heat_flux_ocean::Any</code></p></li><li><p><code>sensible_heat_flux_land::Any</code></p></li><li><p><code>surface_air_density::Any</code></p></li><li><p><code>sat_humid::Any</code></p></li><li><p><code>dry_static_energy::Any</code></p></li><li><p><code>temp_virt::Any</code></p></li><li><p><code>geopot::Any</code></p></li><li><p><code>cloud_top::Int64</code></p></li><li><p><code>precip_convection::Any</code></p></li><li><p><code>precip_large_scale::Any</code></p></li><li><p><code>precip_rate_convection::Any</code></p></li><li><p><code>precip_rate_large_scale::Any</code></p></li><li><p><code>cos_zenith::Any</code></p></li><li><p><code>albedo_ocean::Any</code></p></li><li><p><code>albedo_land::Any</code></p></li><li><p><code>surface_shortwave_down::Any</code></p></li><li><p><code>surface_longwave_down::Any</code></p></li><li><p><code>surface_shortwave_up::Any</code></p></li><li><p><code>surface_shortwave_up_ocean::Any</code></p></li><li><p><code>surface_shortwave_up_land::Any</code></p></li><li><p><code>surface_longwave_up::Any</code></p></li><li><p><code>surface_longwave_up_ocean::Any</code></p></li><li><p><code>surface_longwave_up_land::Any</code></p></li><li><p><code>outgoing_longwave_radiation::Any</code></p></li><li><p><code>outgoing_shortwave_radiation::Any</code></p></li><li><p><code>optical_depth_shortwave::Any</code></p></li><li><p><code>optical_depth_longwave::Any</code></p></li><li><p><code>a::Any</code></p></li><li><p><code>b::Any</code></p></li><li><p><code>c::Any</code></p></li><li><p><code>d::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/define_column.jl#L4-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ConstantOceanClimatology" href="#SpeedyWeather.ConstantOceanClimatology"><code>SpeedyWeather.ConstantOceanClimatology</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Constant ocean climatology that reads monthly sea surface temperature fields from file, and interpolates them only for the initial conditions in time to be stored in the prognostic variables. It is therefore an ocean from climatology but without a seasonal cycle that is constant in time. To be created like</p><pre><code class="nohighlight hljs">ocean = SeasonalOceanClimatology(spectral_grid)</code></pre><p>and the ocean time is set with <code>initialize!(model, time=time)</code>. Fields and options are</p><ul><li><p><code>path::String</code>: [OPTION] path to the folder containing the land-sea mask file, pkg path default</p></li><li><p><code>file::String</code>: [OPTION] filename of sea surface temperatures</p></li><li><p><code>varname::String</code>: [OPTION] Variable name in netcdf file</p></li><li><p><code>file_Grid::Type{&lt;:AbstractGrid}</code>: [OPTION] Grid the sea surface temperature file comes on</p></li><li><p><code>missing_value::Float64</code>: [OPTION] The missing value in the data respresenting land</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/ocean.jl#L172-L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ConvectiveHeating" href="#SpeedyWeather.ConvectiveHeating"><code>SpeedyWeather.ConvectiveHeating</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Convective heating as defined by Lee and Kim, 2003, JAS implemented as convection parameterization. Fields are</p><ul><li><p><code>nlat::Int64</code></p></li><li><p><code>time_scale::Second</code>: [OPTION] Q<em>max heating strength as 1K/time</em>scale</p></li><li><p><code>p₀::Any</code>: [OPTION] Pressure of maximum heating [hPa]</p></li><li><p><code>σₚ::Any</code>: [OPTION] Vertical extent of heating [hPa]</p></li><li><p><code>θ₀::Any</code>: [OPTION] Latitude of heating [˚N]</p></li><li><p><code>σθ::Any</code>: [OPTION] Latitudinal width of heating [˚]</p></li><li><p><code>lat_mask::Vector</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/convection.jl#L439-L442">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ConvectivePrecipitationOutput" href="#SpeedyWeather.ConvectivePrecipitationOutput"><code>SpeedyWeather.ConvectivePrecipitationOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li><li><p><code>transform::Any</code></p></li><li><p><code>rate::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/precipitation.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ConvectivePrecipitationRateOutput" href="#SpeedyWeather.ConvectivePrecipitationRateOutput"><code>SpeedyWeather.ConvectivePrecipitationRateOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li><li><p><code>transform::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/precipitation.jl#L24-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DeviceSetup" href="#SpeedyWeather.DeviceSetup"><code>SpeedyWeather.DeviceSetup</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Holds information about the device the model is running on and workgroup size.</p><ul><li><p><code>device::SpeedyWeather.AbstractDevice</code>: ::AbstractDevice, device the model is running on.</p></li><li><p><code>device_KA::Any</code>: ::KernelAbstractions.Device, device for use with KernelAbstractions</p></li><li><p><code>n::Int64</code>: workgroup size</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/gpu.jl#L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DiagnosticVariables" href="#SpeedyWeather.DiagnosticVariables"><code>SpeedyWeather.DiagnosticVariables</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>All diagnostic variables.</p><ul><li><p><code>trunc::Int64</code>: Spectral resolution: Max degree of spherical harmonics (0-based)</p></li><li><p><code>nlat_half::Int64</code>: Grid resoltion: Number of latitude rings on one hemisphere (Equator incl.)</p></li><li><p><code>nlayers::Int64</code>: Number of vertical layers</p></li><li><p><code>nparticles::Int64</code>: Number of particles for particle advection</p></li><li><p><code>tendencies::Tendencies</code>: Tendencies (spectral and grid) of the prognostic variables</p></li><li><p><code>grid::GridVariables</code>: Gridded prognostic variables</p></li><li><p><code>dynamics::DynamicsVariables</code>: Intermediate variables for the dynamical core</p></li><li><p><code>physics::PhysicsVariables</code>: Global fields returned from physics parameterizations</p></li><li><p><code>particles::ParticleVariables{NF, ArrayType, ParticleVector, VectorType, Grid} where {NF, ArrayType, Grid, ParticleVector, VectorType}</code>: Intermediate variables for the particle advection</p></li><li><p><code>column::ColumnVariables</code>: Vertical column for the physics parameterizations</p></li><li><p><code>temp_average::Any</code>: Average temperature of every horizontal layer [K]</p></li><li><p><code>scale::Base.RefValue</code>: Scale applied to vorticity and divergence</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L414-L416">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DiagnosticVariables-Tuple{SpectralGrid}" href="#SpeedyWeather.DiagnosticVariables-Tuple{SpectralGrid}"><code>SpeedyWeather.DiagnosticVariables</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DiagnosticVariables(
    SG::SpectralGrid;
    nbands_shortwave,
    nbands_longwave
) -&gt; DiagnosticVariables
</code></pre><p>Generator function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L482">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DivergenceOutput" href="#SpeedyWeather.DivergenceOutput"><code>SpeedyWeather.DivergenceOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li><li><p><code>unscale::Bool</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/dynamics.jl#L77-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DryBettsMiller" href="#SpeedyWeather.DryBettsMiller"><code>SpeedyWeather.DryBettsMiller</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The simplified Betts-Miller convection scheme from Frierson, 2007, https://doi.org/10.1175/JAS3935.1 but with humidity set to zero. Fields and options are</p><ul><li><p><code>nlayers::Int64</code>: number of vertical layers/levels</p></li><li><p><code>time_scale::Second</code>: [OPTION] Relaxation time for profile adjustment</p></li><li><p><code>surface_temp::Any</code>: [OPTION] Surface perturbation of temp to calculate the dry adiabat</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/convection.jl#L294-L298">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DynamicsVariables" href="#SpeedyWeather.DynamicsVariables"><code>SpeedyWeather.DynamicsVariables</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Intermediate quantities for the dynamics of a given layer.</p><ul><li><p><code>trunc::Int64</code></p></li><li><p><code>nlat_half::Int64</code></p></li><li><p><code>nlayers::Int64</code></p></li><li><p><code>a::Any</code>: Multi-purpose a, 3D work array to be reused in various places</p></li><li><p><code>b::Any</code>: Multi-purpose b, 3D work array to be reused in various places</p></li><li><p><code>a_grid::Any</code>: Multi-purpose a, 3D work array to be reused in various places</p></li><li><p><code>b_grid::Any</code>: Multi-purpose b, 3D work array to be reused in various places</p></li><li><p><code>a_2D::Any</code>: Multi-purpose a, work array to be reused in various places</p></li><li><p><code>b_2D::Any</code>: Multi-purpose b, work array to be reused in various places</p></li><li><p><code>a_2D_grid::Any</code>: Multi-purpose a, work array to be reused in various places</p></li><li><p><code>b_2D_grid::Any</code>: Multi-purpose b, work array to be reused in various places</p></li><li><p><code>uv∇lnp::Any</code>: Pressure flux (uₖ, vₖ)⋅∇ln(pₛ)</p></li><li><p><code>uv∇lnp_sum_above::Any</code>: Sum of Δσₖ-weighted uv∇lnp above</p></li><li><p><code>div_sum_above::Any</code>: Sum of div_weighted from top to k</p></li><li><p><code>temp_virt::Any</code>: Virtual temperature [K], spectral for geopotential</p></li><li><p><code>geopot::Any</code>: Geopotential [m²/s²] on full layers</p></li><li><p><code>σ_tend::Any</code>: Vertical velocity (dσ/dt), on half levels k+1/2 below, pointing to the surface (σ=1)</p></li><li><p><code>∇lnp_x::Any</code>: Zonal gradient of log surf pressure</p></li><li><p><code>∇lnp_y::Any</code>: Meridional gradient of log surf pressure</p></li><li><p><code>u_mean_grid::Any</code>: Vertical average of zonal velocity [m/s]</p></li><li><p><code>v_mean_grid::Any</code>: Vertical average of meridional velocity [m/s]</p></li><li><p><code>div_mean_grid::Any</code>: Vertical average of divergence [1/s], grid</p></li><li><p><code>div_mean::Any</code>: Vertical average of divergence [1/s], spectral</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L160-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DynamicsVariables-Tuple{SpectralGrid}" href="#SpeedyWeather.DynamicsVariables-Tuple{SpectralGrid}"><code>SpeedyWeather.DynamicsVariables</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DynamicsVariables(
    SG::SpectralGrid
) -&gt; DynamicsVariables{&lt;:AbstractFloat, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray}
</code></pre><p>Generator function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L236">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Earth" href="#SpeedyWeather.Earth"><code>SpeedyWeather.Earth</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Create a struct <code>Earth&lt;:AbstractPlanet</code>, with the following physical/orbital characteristics. Note that <code>radius</code> is not part of it as this should be chosen in <code>SpectralGrid</code>. Keyword arguments are</p><ul><li><p><code>rotation::AbstractFloat</code>: angular frequency of Earth&#39;s rotation [rad/s]</p></li><li><p><code>gravity::AbstractFloat</code>: gravitational acceleration [m/s^2]</p></li><li><p><code>daily_cycle::Bool</code>: switch on/off daily cycle</p></li><li><p><code>length_of_day::Second</code>: Seconds in a daily rotation</p></li><li><p><code>seasonal_cycle::Bool</code>: switch on/off seasonal cycle</p></li><li><p><code>length_of_year::Second</code>: Seconds in an orbit around the sun</p></li><li><p><code>equinox::DateTime</code>: time of spring equinox (year irrelevant)</p></li><li><p><code>axial_tilt::AbstractFloat</code>: angle [˚] rotation axis tilt wrt to orbit</p></li><li><p><code>solar_constant::AbstractFloat</code>: Total solar irradiance at the distance of 1 AU [W/m²]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/planet.jl#L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.EarthAtmosphere" href="#SpeedyWeather.EarthAtmosphere"><code>SpeedyWeather.EarthAtmosphere</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Create a struct <code>EarthAtmosphere &lt;: AbstractAtmosphere</code>, with the following physical/chemical characteristics. Keyword arguments are</p><ul><li><p><code>mol_mass_dry_air::AbstractFloat</code>: molar mass of dry air [g/mol]</p></li><li><p><code>mol_mass_vapour::AbstractFloat</code>: molar mass of water vapour [g/mol]</p></li><li><p><code>heat_capacity::AbstractFloat</code>: specific heat at constant pressure cₚ [J/K/kg]</p></li><li><p><code>R_gas::AbstractFloat</code>: universal gas constant [J/K/mol]</p></li><li><p><code>R_dry::AbstractFloat</code>: specific gas constant for dry air [J/kg/K]</p></li><li><p><code>R_vapour::AbstractFloat</code>: specific gas constant for water vapour [J/kg/K]</p></li><li><p><code>mol_ratio::AbstractFloat</code>: Ratio of gas constants: dry air / water vapour, often called ε [1]</p></li><li><p><code>μ_virt_temp::AbstractFloat</code>: Virtual temperature Tᵥ calculation, Tᵥ = T(1 + μ*q), humidity q, absolute tempereature T</p></li><li><p><code>κ::AbstractFloat</code>: = R_dry/cₚ, gas const for air over heat capacity</p></li><li><p><code>water_density::AbstractFloat</code>: water density [kg/m³]</p></li><li><p><code>latent_heat_condensation::AbstractFloat</code>: latent heat of condensation [J/kg]</p></li><li><p><code>latent_heat_sublimation::AbstractFloat</code>: latent heat of sublimation [J/kg]</p></li><li><p><code>stefan_boltzmann::AbstractFloat</code>: stefan-Boltzmann constant [W/m²/K⁴]</p></li><li><p><code>pres_ref::AbstractFloat</code>: surface reference pressure [Pa]</p></li><li><p><code>temp_ref::AbstractFloat</code>: surface reference temperature [K]</p></li><li><p><code>moist_lapse_rate::AbstractFloat</code>: reference moist-adiabatic temperature lapse rate [K/m]</p></li><li><p><code>dry_lapse_rate::AbstractFloat</code>: reference dry-adiabatic temperature lapse rate [K/m]</p></li><li><p><code>layer_thickness::AbstractFloat</code>: layer thickness for the shallow water model [m]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/atmosphere.jl#L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.EarthLandSeaMask" href="#SpeedyWeather.EarthLandSeaMask"><code>SpeedyWeather.EarthLandSeaMask</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Land-sea mask, fractional, read from file.</p><ul><li><p><code>path::String</code>: path to the folder containing the land-sea mask file, pkg path default</p></li><li><p><code>file::String</code>: filename of land sea mask</p></li><li><p><code>file_Grid::Type{&lt;:AbstractGrid}</code>: Grid the land-sea mask file comes on</p></li><li><p><code>mask::Any</code>: Land-sea mask [1] on grid-point space. Land=1, sea=0, land-area fraction in between.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/land_sea_mask.jl#L66-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.EarthOrography" href="#SpeedyWeather.EarthOrography"><code>SpeedyWeather.EarthOrography</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Earth&#39;s orography read from file, with smoothing.</p><ul><li><p><code>path::String</code>: path to the folder containing the orography file, pkg path default</p></li><li><p><code>file::String</code>: filename of orography</p></li><li><p><code>file_Grid::Type{&lt;:AbstractGrid}</code>: Grid the orography file comes on</p></li><li><p><code>scale::Any</code>: scale orography by a factor</p></li><li><p><code>smoothing::Bool</code>: smooth the orography field?</p></li><li><p><code>smoothing_power::Any</code>: power of Laplacian for smoothing</p></li><li><p><code>smoothing_strength::Any</code>: highest degree l is multiplied by</p></li><li><p><code>smoothing_fraction::Any</code>: fraction of highest wavenumbers to smooth</p></li><li><p><code>orography::Any</code>: height [m] on grid-point space.</p></li><li><p><code>geopot_surf::Any</code>: surface geopotential, height*gravity [m²/s²]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/orography.jl#L115-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.EvaporativeFluxOutput" href="#SpeedyWeather.EvaporativeFluxOutput"><code>SpeedyWeather.EvaporativeFluxOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/surface_fluxes.jl#L17-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Feedback" href="#SpeedyWeather.Feedback"><code>SpeedyWeather.Feedback</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Feedback struct that contains options and object for command-line feedback like the progress meter.</p><ul><li><p><code>verbose::Bool</code>: print feedback to REPL?, default is isinteractive(), true in interactive REPL mode</p></li><li><p><code>debug::Bool</code>: check for NaRs in the prognostic variables</p></li><li><p><code>output::Bool</code>: write a progress.txt file? State synced with NetCDFOutput.output</p></li><li><p><code>id::String</code>: identification of run, taken from ::OutputWriter</p></li><li><p><code>run_path::String</code>: path to run folder, taken from ::OutputWriter</p></li><li><p><code>progress_meter::ProgressMeter.Progress</code>: struct containing everything progress related</p></li><li><p><code>progress_txt::IOStream</code>: txt is a Nothing in case of no output</p></li><li><p><code>nars_detected::Bool</code>: did Infs/NaNs occur in the simulation?</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/feedback.jl#L5-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.GPU" href="#SpeedyWeather.GPU"><code>SpeedyWeather.GPU</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GPU &lt;: AbstractDevice</code></pre><p>Indicates that SpeedyWeather.jl runs on a single GPU.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/gpu.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Geometry" href="#SpeedyWeather.Geometry"><code>SpeedyWeather.Geometry</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Construct Geometry struct containing parameters and arrays describing an iso-latitude grid <code>&lt;:AbstractGrid</code> and the vertical levels. Pass on <code>SpectralGrid</code> to calculate the following fields</p><ul><li><p><code>spectral_grid::SpectralGrid</code>: SpectralGrid that defines spectral and grid resolution</p></li><li><p><code>nlat_half::Int64</code>: resolution parameter nlat_half of Grid, # of latitudes on one hemisphere (incl Equator)</p></li><li><p><code>nlon_max::Int64</code>: maximum number of longitudes (at/around Equator)</p></li><li><p><code>nlat::Int64</code>: number of latitude rings</p></li><li><p><code>nlayers::Int64</code>: number of vertical levels</p></li><li><p><code>npoints::Int64</code>: total number of horizontal grid points</p></li><li><p><code>radius::Any</code>: Planet&#39;s radius [m]</p></li><li><p><code>lond::Any</code>: array of longitudes in degrees (0...360˚), empty for non-full grids</p></li><li><p><code>latd::Any</code>: array of latitudes in degrees (90˚...-90˚)</p></li><li><p><code>lat::Any</code>: array of latitudes in radians (π...-π)</p></li><li><p><code>colat::Any</code>: array of colatitudes in radians (0...π)</p></li><li><p><code>londs::Any</code>: longitude (0˚...360˚) for each grid point in ring order</p></li><li><p><code>latds::Any</code>: latitude (-90˚...˚90) for each grid point in ring order</p></li><li><p><code>lons::Any</code>: longitude (0...2π) for each grid point in ring order</p></li><li><p><code>lats::Any</code>: latitude (-π/2...π/2) for each grid point in ring order</p></li><li><p><code>sinlat::Any</code>: sin of latitudes</p></li><li><p><code>coslat::Any</code>: cos of latitudes</p></li><li><p><code>coslat⁻¹::Any</code>: = 1/cos(lat)</p></li><li><p><code>coslat²::Any</code>: = cos²(lat)</p></li><li><p><code>coslat⁻²::Any</code>: # = 1/cos²(lat)</p></li><li><p><code>σ_levels_half::Any</code>: σ at half levels, σ_k+1/2</p></li><li><p><code>σ_levels_full::Any</code>: σ at full levels, σₖ</p></li><li><p><code>σ_levels_thick::Any</code>: σ level thicknesses, σₖ₊₁ - σₖ</p></li><li><p><code>ln_σ_levels_full::Any</code>: log of σ at full levels, include surface (σ=1) as last element</p></li><li><p><code>full_to_half_interpolation::Any</code>: Full to half levels interpolation</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/geometry.jl#L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Geometry-Tuple{SpectralGrid}" href="#SpeedyWeather.Geometry-Tuple{SpectralGrid}"><code>SpeedyWeather.Geometry</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Geometry(
    SG::SpectralGrid;
    vertical_coordinates
) -&gt; Geometry{&lt;:AbstractFloat, &lt;:AbstractGrid, &lt;:AbstractVector}
</code></pre><p>Generator function for <code>Geometry</code> struct based on <code>spectral_grid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/geometry.jl#L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.GlobalSurfaceTemperatureCallback" href="#SpeedyWeather.GlobalSurfaceTemperatureCallback"><code>SpeedyWeather.GlobalSurfaceTemperatureCallback</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Callback that records the global mean surface temperature on every time step.</p><ul><li><p><code>timestep_counter::Int64</code></p></li><li><p><code>temp::Vector</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/callbacks.jl#L112-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.GridVariables" href="#SpeedyWeather.GridVariables"><code>SpeedyWeather.GridVariables</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Transformed prognostic variables (and u, v, temp_virt) into grid-point space.</p><ul><li><p><code>nlat_half::Int64</code></p></li><li><p><code>nlayers::Int64</code></p></li><li><p><code>vor_grid::Any</code>: Relative vorticity of the horizontal wind [1/s]</p></li><li><p><code>div_grid::Any</code>: Divergence of the horizontal wind [1/s]</p></li><li><p><code>temp_grid::Any</code>: Absolute temperature [K]</p></li><li><p><code>temp_virt_grid::Any</code>: Virtual tempereature [K]</p></li><li><p><code>humid_grid::Any</code>: Specific_humidity [kg/kg]</p></li><li><p><code>u_grid::Any</code>: Zonal velocity [m/s]</p></li><li><p><code>v_grid::Any</code>: Meridional velocity [m/s]</p></li><li><p><code>pres_grid::Any</code>: Logarithm of surface pressure [Pa]</p></li><li><p><code>tracers_grid::Dict{Symbol}</code>: Tracers [?]</p></li><li><p><code>random_pattern::Any</code>: Random pattern controlled by random process [1]</p></li><li><p><code>temp_grid_prev::Any</code>: Absolute temperature [K] at previous time step</p></li><li><p><code>humid_grid_prev::Any</code>: Specific humidity [kg/kg] at previous time step</p></li><li><p><code>u_grid_prev::Any</code>: Zonal velocity [m/s] at previous time step</p></li><li><p><code>v_grid_prev::Any</code>: Meridional velocity [m/s] at previous time step</p></li><li><p><code>pres_grid_prev::Any</code>: Logarithm of surface pressure [Pa] at previous time step</p></li><li><p><code>tracers_grid_prev::Dict{Symbol}</code>: Tracers [?] at previous time step</p></li></ul><p>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L98-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.GridVariables-Tuple{SpectralGrid}" href="#SpeedyWeather.GridVariables-Tuple{SpectralGrid}"><code>SpeedyWeather.GridVariables</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GridVariables(
    SG::SpectralGrid
) -&gt; GridVariables{&lt;:AbstractFloat, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray}
</code></pre><p>Generator function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L147">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.HeldSuarez" href="#SpeedyWeather.HeldSuarez"><code>SpeedyWeather.HeldSuarez</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Temperature relaxation from Held and Suarez, 1996 BAMS</p><ul><li><p><code>nlat::Int64</code>: number of latitude rings</p></li><li><p><code>nlayers::Int64</code>: number of vertical levels</p></li><li><p><code>σb::AbstractFloat</code>: sigma coordinate below which faster surface relaxation is applied</p></li><li><p><code>relax_time_slow::Second</code>: time scale for slow global relaxation</p></li><li><p><code>relax_time_fast::Second</code>: time scale for faster tropical surface relaxation</p></li><li><p><code>Tmin::AbstractFloat</code>: minimum equilibrium temperature [K]</p></li><li><p><code>Tmax::AbstractFloat</code>: maximum equilibrium temperature [K]</p></li><li><p><code>ΔTy::AbstractFloat</code>: meridional temperature gradient [K]</p></li><li><p><code>Δθz::AbstractFloat</code>: vertical temperature gradient [K]</p></li><li><p><code>κ::Base.RefValue{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>p₀::Base.RefValue{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_relax_freq::Matrix{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_equil_a::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_equil_b::Vector{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/temperature_relaxation.jl#L16-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.HeldSuarez-Tuple{SpectralGrid}" href="#SpeedyWeather.HeldSuarez-Tuple{SpectralGrid}"><code>SpeedyWeather.HeldSuarez</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HeldSuarez(SG::SpectralGrid; kwargs...) -&gt; HeldSuarez
</code></pre><p>create a HeldSuarez temperature relaxation with arrays allocated given <code>spectral_grid</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/temperature_relaxation.jl#L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.HumidityOutput" href="#SpeedyWeather.HumidityOutput"><code>SpeedyWeather.HumidityOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/dynamics.jl#L140-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.HyperDiffusion" href="#SpeedyWeather.HyperDiffusion"><code>SpeedyWeather.HyperDiffusion</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Horizontal hyper diffusion of vor, div, temp, humid; implicitly in spectral space with a <code>power</code> of the Laplacian (default = 4) and the strength controlled by <code>time_scale</code> (default = 1 hour). For vorticity and divergence, by default, the <code>time_scale</code> (=1/strength of diffusion) is reduced with increasing resolution through <code>resolution_scaling</code> and the power is linearly decreased in the vertical above the <code>tapering_σ</code> sigma level to <code>power_stratosphere</code> (default 2).</p><p>For the BarotropicModel and ShallowWaterModel no tapering or scaling is applied. Fields and options are</p><ul><li><p><code>trunc::Int64</code>: spectral resolution</p></li><li><p><code>nlayers::Int64</code>: number of vertical levels</p></li><li><p><code>power::Any</code>: [OPTION] power of Laplacian</p></li><li><p><code>time_scale::Second</code>: [OPTION] diffusion time scale</p></li><li><p><code>time_scale_div::Second</code>: [OPTION] diffusion time scale for temperature and humidity</p></li><li><p><code>resolution_scaling::Any</code>: [OPTION] stronger diffusion with resolution? 0: constant with trunc, 1: (inverse) linear with trunc, etc</p></li><li><p><code>power_stratosphere::Any</code>: [OPTION] different power for tropopause/stratosphere</p></li><li><p><code>tapering_σ::Any</code>: [OPTION] linearly scale towards power_stratosphere above this σ</p></li><li><p><code>expl::Any</code></p></li><li><p><code>impl::Any</code></p></li><li><p><code>expl_div::Any</code></p></li><li><p><code>impl_div::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/horizontal_diffusion.jl#L5-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.HyperDiffusion-Tuple{SpectralGrid}" href="#SpeedyWeather.HyperDiffusion-Tuple{SpectralGrid}"><code>SpeedyWeather.HyperDiffusion</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HyperDiffusion(
    spectral_grid::SpectralGrid;
    kwargs...
) -&gt; HyperDiffusion{&lt;:AbstractFloat}
</code></pre><p>Generator function based on the resolutin in <code>spectral_grid</code>. Passes on keyword arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/horizontal_diffusion.jl#L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ImplicitCondensation" href="#SpeedyWeather.ImplicitCondensation"><code>SpeedyWeather.ImplicitCondensation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Large scale condensation as with implicit precipitation.</p><ul><li><p><code>relative_humidity_threshold::AbstractFloat</code>: Relative humidity threshold [1 = 100%] to trigger condensation</p></li><li><p><code>time_scale::AbstractFloat</code>: Time scale in multiples of time step Δt, the larger the less immediate</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/large_scale_condensation.jl#L10-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ImplicitPrimitiveEquation" href="#SpeedyWeather.ImplicitPrimitiveEquation"><code>SpeedyWeather.ImplicitPrimitiveEquation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Struct that holds various precomputed arrays for the semi-implicit correction to prevent gravity waves from amplifying in the primitive equation model.</p><ul><li><p><code>trunc::Int64</code>: spectral resolution</p></li><li><p><code>nlayers::Int64</code>: number of vertical layers</p></li><li><p><code>α::Any</code>: time-step coefficient: 0=explicit, 0.5=centred implicit, 1=backward implicit</p></li><li><p><code>temp_profile::Any</code>: vertical temperature profile, obtained from diagn on first time step</p></li><li><p><code>ξ::Base.RefValue</code>: time step 2α*Δt packed in RefValue for mutability</p></li><li><p><code>R::Any</code>: divergence: operator for the geopotential calculation</p></li><li><p><code>U::Any</code>: divergence: the -RdTₖ∇² term excl the eigenvalues from ∇² for divergence</p></li><li><p><code>L::Any</code>: temperature: operator for the TₖD + κTₖDlnps/Dt term</p></li><li><p><code>W::Any</code>: pressure: vertical averaging of the -D̄ term in the log surface pres equation</p></li><li><p><code>L0::Any</code>: components to construct L, 1/ 2Δσ</p></li><li><p><code>L1::Any</code>: vert advection term in the temperature equation (below+above)</p></li><li><p><code>L2::Any</code>: factor in front of the div<em>sum</em>above term</p></li><li><p><code>L3::Any</code>: <em>sum</em>above operator itself</p></li><li><p><code>L4::Any</code>: factor in front of div term in Dlnps/Dt</p></li><li><p><code>S::Any</code>: for every l the matrix to be inverted</p></li><li><p><code>S⁻¹::Any</code>: combined inverted operator: S = 1 - ξ²(RL + UW)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/implicit.jl#L111-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ImplicitPrimitiveEquation-Tuple{SpectralGrid, Vararg{Any}}" href="#SpeedyWeather.ImplicitPrimitiveEquation-Tuple{SpectralGrid, Vararg{Any}}"><code>SpeedyWeather.ImplicitPrimitiveEquation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ImplicitPrimitiveEquation(
    spectral_grid::SpectralGrid,
    kwargs...
) -&gt; ImplicitPrimitiveEquation{&lt;:AbstractFloat, &lt;:AbstractVector, &lt;:AbstractMatrix, &lt;:AbstractArray}
</code></pre><p>Generator using the resolution from SpectralGrid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/implicit.jl#L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ImplicitShallowWater" href="#SpeedyWeather.ImplicitShallowWater"><code>SpeedyWeather.ImplicitShallowWater</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Struct that holds various precomputed arrays for the semi-implicit correction to prevent gravity waves from amplifying in the shallow water model. The implicit time step between i-1 and i+1 is controlled by the parameter <code>α</code> in the range [0, 1]</p><pre><code class="nohighlight hljs">α = 0   means the gravity wave terms are evaluated at i-1 (forward)
α = 0.5 evaluates at i+1 and i-1 (centered implicit)
α = 1   evaluates at i+1 (backward implicit)
α ∈ [0.5, 1] are also possible which controls the strength of the gravity wave dampening.
α = 0.5 slows gravity waves and prevents them from amplifying
α &gt; 0.5 will dampen the gravity waves within days to a few timesteps (α=1)</code></pre><p>Fields are</p><ul><li><p><code>α::Any</code>: [OPTION] coefficient for semi-implicit computations to filter gravity waves, 0.5 &lt;= α &lt;= 1</p></li><li><p><code>gravity::Base.RefValue</code>: Gravity [m/s²], taken from model.planet at initialize!</p></li><li><p><code>layer_thickness::Base.RefValue</code>: Layer thickness [m], taken from model.atmosphere at initialize!</p></li><li><p><code>time_step::Base.RefValue</code>: Time step [s], = αdt = 2αΔt (for leapfrog)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/implicit.jl#L13-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ImplicitShallowWater-Tuple{SpectralGrid}" href="#SpeedyWeather.ImplicitShallowWater-Tuple{SpectralGrid}"><code>SpeedyWeather.ImplicitShallowWater</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ImplicitShallowWater(
    SG::SpectralGrid;
    kwargs...
) -&gt; ImplicitShallowWater{&lt;:AbstractFloat}
</code></pre><p>Generator using the resolution from <code>spectral_grid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/implicit.jl#L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.InterfaceDisplacementOutput" href="#SpeedyWeather.InterfaceDisplacementOutput"><code>SpeedyWeather.InterfaceDisplacementOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/dynamics.jl#L93-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.JLD2Output" href="#SpeedyWeather.JLD2Output"><code>SpeedyWeather.JLD2Output</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Output writer for a JLD2 file that saves the PrognosticVariables and DiagnosticVariables structs directly to a JLD2 file. All internal scalings and units are still applied to these outputs. Fields are </p><ul><li><p><code>active::Bool</code></p></li><li><p><code>path::String</code>: [OPTION] path to output folder, run_???? will be created within</p></li><li><p><code>id::String</code>: [OPTION] run identification number/string</p></li><li><p><code>run_path::String</code></p></li><li><p><code>filename::String</code>: [OPTION] name of the output jld2 file</p></li><li><p><code>write_restart::Bool</code>: [OPTION] also write restart file if output==true?</p></li><li><p><code>pkg_version::VersionNumber</code></p></li><li><p><code>output_dt::Second</code>: [OPTION] output frequency, time step</p></li><li><p><code>merge_output::Bool</code>: [OPTION] will reopen and resave the file to merge everything in one big vector. Turn off if the file is too large for memory.</p></li><li><p><code>output_prognostic::Bool</code>: [OPTION] output the PrognosticVariables</p></li><li><p><code>output_diagnostic::Bool</code>: [OPTION] output the DiagnosticVariables as well</p></li><li><p><code>output_every_n_steps::Int64</code></p></li><li><p><code>timestep_counter::Int64</code></p></li><li><p><code>output_counter::Int64</code></p></li><li><p><code>jld2_file::Union{Nothing, JLD2.JLDFile}</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/jld2_output.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.JablonowskiRelaxation" href="#SpeedyWeather.JablonowskiRelaxation"><code>SpeedyWeather.JablonowskiRelaxation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>HeldSuarez-like temperature relaxation, but towards the Jablonowski temperature profile with increasing temperatures in the stratosphere.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/temperature_relaxation.jl#L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.JablonowskiRelaxation-Tuple{SpectralGrid}" href="#SpeedyWeather.JablonowskiRelaxation-Tuple{SpectralGrid}"><code>SpeedyWeather.JablonowskiRelaxation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JablonowskiRelaxation(
    SG::SpectralGrid;
    kwargs...
) -&gt; JablonowskiRelaxation
</code></pre><p>create a JablonowskiRelaxation temperature relaxation with arrays allocated given <code>spectral_grid</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/temperature_relaxation.jl#L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.JablonowskiTemperature" href="#SpeedyWeather.JablonowskiTemperature"><code>SpeedyWeather.JablonowskiTemperature</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Create a struct that contains all parameters for the Jablonowski and Williamson, 2006 intitial conditions for the primitive equation model. Default values as in Jablonowski.</p><ul><li><p><code>η₀::Float64</code>: conversion from σ to Jablonowski&#39;s ηᵥ-coordinates</p></li><li><p><code>σ_tropopause::Float64</code>: Sigma coordinates of the tropopause [1]</p></li><li><p><code>u₀::Float64</code>: max amplitude of zonal wind [m/s]</p></li><li><p><code>ΔT::Float64</code>: temperature difference used for stratospheric lapse rate [K], Jablonowski uses ΔT = 4.8e5 [K]</p></li><li><p><code>Tmin::Float64</code>: minimum temperature [K] of profile</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L432">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.JeevanjeeRadiation" href="#SpeedyWeather.JeevanjeeRadiation"><code>SpeedyWeather.JeevanjeeRadiation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Temperature flux longwave radiation from Jeevanjee and Romps, 2018, following Seeley and Wordsworth, 2023, eq (1)</p><pre><code class="nohighlight hljs">dF/dT = α*(T_t - T)</code></pre><p>with <code>F</code> the upward temperature flux between two layers with temperature difference <code>dT</code>, <code>α = 0.025 W/m²/K²</code> and <code>T_t = 200K</code> a prescribed tropopause temperature. Flux into the lowermost layer is 0. Flux out of uppermost layer also 0, but <code>dT/dt = (T_t - T)/τ</code> is added to relax the uppermost layer towards the tropopause temperature <code>T_t</code> with time scale <code>τ = 24h</code> (Seeley and Wordsworth, 2023 use 6h, which is unstable a low resolutions here). Fields are</p><ul><li><p><code>α::Any</code>: Radiative forcing constant (W/m²/K²)</p></li><li><p><code>temp_tropopause::Any</code>: Tropopause temperature [K]</p></li><li><p><code>time_scale::Second</code>: Tropopause relaxation time scale to temp_tropopause</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/longwave_radiation.jl#L73-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.JetStreamForcing" href="#SpeedyWeather.JetStreamForcing"><code>SpeedyWeather.JetStreamForcing</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Forcing term for the Barotropic or ShallowWaterModel with an idealised jet stream similar to the initial conditions from Galewsky, 2004, but mirrored for both hemispheres.</p><ul><li><p><code>nlat::Int64</code>: Number of latitude rings</p></li><li><p><code>nlayers::Int64</code>: Number of vertical layers</p></li><li><p><code>latitude::Any</code>: jet latitude [˚N]</p></li><li><p><code>width::Any</code>: jet width [˚], default ≈ 19.29˚</p></li><li><p><code>sigma::Any</code>: sigma level [1], vertical location of jet</p></li><li><p><code>speed::Any</code>: jet speed scale [m/s]</p></li><li><p><code>time_scale::Second</code>: time scale [days]</p></li><li><p><code>amplitude::Vector</code>: precomputed amplitude vector [m/s²]</p></li><li><p><code>tapering::Vector</code>: precomputed vertical tapering</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/forcing.jl#L31-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.KolmogorovFlow" href="#SpeedyWeather.KolmogorovFlow"><code>SpeedyWeather.KolmogorovFlow</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Kolmogorov flow forcing. Fields are</p><ul><li><p><code>strength::Any</code>: [OPTION] Strength of forcing [1/s²]</p></li><li><p><code>wavenumber::Any</code>: [OPTION] Wavenumber of forcing in meridional direction (pole to pole)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/forcing.jl#L217-L220">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LandBucketTemperature" href="#SpeedyWeather.LandBucketTemperature"><code>SpeedyWeather.LandBucketTemperature</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>MITgcm&#39;s two-layer soil model (https://mitgcm.readthedocs.io/en/latest/phys_pkgs/land.html). Fields assert</p><ul><li><p><code>initial_temperature::Any</code>: [OPTION] Initial soil temperature [K]</p></li><li><p><code>mask::Bool</code>: [OPTION] Apply land-sea mask to NaN ocean-only points?</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/land/temperature.jl#L133-L135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LandSeaMaskOutput" href="#SpeedyWeather.LandSeaMaskOutput"><code>SpeedyWeather.LandSeaMaskOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variable, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/land.jl#L53-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LargeScalePrecipitationOutput" href="#SpeedyWeather.LargeScalePrecipitationOutput"><code>SpeedyWeather.LargeScalePrecipitationOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li><li><p><code>transform::Any</code></p></li><li><p><code>rate::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/precipitation.jl#L60-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LargeScalePrecipitationRateOutput" href="#SpeedyWeather.LargeScalePrecipitationRateOutput"><code>SpeedyWeather.LargeScalePrecipitationRateOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li><li><p><code>transform::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/precipitation.jl#L81-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Leapfrog" href="#SpeedyWeather.Leapfrog"><code>SpeedyWeather.Leapfrog</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Leapfrog time stepping defined by the following fields</p><ul><li><p><code>trunc::Int64</code>: spectral resolution (max degree of spherical harmonics)</p></li><li><p><code>nsteps::Int64</code>: Number of timesteps stored simultaneously in prognostic variables</p></li><li><p><code>Δt_at_T31::Second</code>: Time step in minutes for T31, scale linearly to <code>trunc</code></p></li><li><p><code>radius::AbstractFloat</code>: Radius of sphere [m], used for scaling</p></li><li><p><code>adjust_with_output::Bool</code>: Adjust Δt<em>at</em>T31 with the output<em>dt to reach output</em>dt exactly in integer time steps</p></li><li><p><code>robert_filter::AbstractFloat</code>: Robert (1966) time filter coefficeint to suppress comput. mode</p></li><li><p><code>williams_filter::AbstractFloat</code>: Williams time filter (Amezcua 2011) coefficient for 3rd order acc</p></li><li><p><code>Δt_millisec::Millisecond</code>: time step Δt [ms] at specified resolution</p></li><li><p><code>Δt_sec::AbstractFloat</code>: time step Δt [s] at specified resolution</p></li><li><p><code>Δt::AbstractFloat</code>: time step Δt [s/m] at specified resolution, scaled by 1/radius</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/time_integration.jl#L4-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Leapfrog-Tuple{SpectralGrid}" href="#SpeedyWeather.Leapfrog-Tuple{SpectralGrid}"><code>SpeedyWeather.Leapfrog</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Leapfrog(spectral_grid::SpectralGrid; kwargs...) -&gt; Leapfrog
</code></pre><p>Generator function for a Leapfrog struct using <code>spectral_grid</code> for the resolution information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/time_integration.jl#L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LinearDrag" href="#SpeedyWeather.LinearDrag"><code>SpeedyWeather.LinearDrag</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Linear boundary layer drag following Held and Suarez, 1996 BAMS</p><ul><li><p><code>nlayers::Int64</code></p></li><li><p><code>σb::AbstractFloat</code></p></li><li><p><code>time_scale::Second</code></p></li><li><p><code>drag_coefs::Vector{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/boundary_layer.jl#L18-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LinearDrag-Tuple{SpectralGrid}" href="#SpeedyWeather.LinearDrag-Tuple{SpectralGrid}"><code>SpeedyWeather.LinearDrag</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearDrag(SG::SpectralGrid; kwargs...) -&gt; LinearDrag
</code></pre><p>Generator function using <code>nlayers</code> from <code>SG::SpectralGrid</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/boundary_layer.jl#L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ManualAlbedo" href="#SpeedyWeather.ManualAlbedo"><code>SpeedyWeather.ManualAlbedo</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Manual albedo field, to be used with <code>set!</code> and is copied into the diagnostic variables on every time step. Defined so that parameterizations can change the albedo at every time step (e.g. snow cover) without losing the information of the original surface albedo. Fields are</p><ul><li><code>albedo::Any</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/albedo.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.MeridionalVelocityOutput" href="#SpeedyWeather.MeridionalVelocityOutput"><code>SpeedyWeather.MeridionalVelocityOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/dynamics.jl#L62-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.NetCDFOutput" href="#SpeedyWeather.NetCDFOutput"><code>SpeedyWeather.NetCDFOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NetCDFOutput(
    S::SpectralGrid;
    ...
) -&gt; NetCDFOutput{_A, _B, Interpolator} where {_A, _B, Interpolator&lt;:(AnvilInterpolator{Float32, _A, SpeedyWeather.RingGrids.GridGeometry{Grid, VectorType, VectorIntType, VectorRangeType}, SpeedyWeather.RingGrids.AnvilLocator{Float32, _A1, _B}} where {_A, Grid, VectorType, VectorIntType, VectorRangeType, _A1, _B})}
NetCDFOutput(
    S::SpectralGrid,
    Model::Type{&lt;:AbstractModel};
    output_Grid,
    nlat_half,
    output_NF,
    output_dt,
    kwargs...
) -&gt; NetCDFOutput{_A, _B, Interpolator} where {_A, _B, Interpolator&lt;:(AnvilInterpolator{Float32, _A, SpeedyWeather.RingGrids.GridGeometry{Grid, VectorType, VectorIntType, VectorRangeType}, SpeedyWeather.RingGrids.AnvilLocator{Float32, _A1, _B}} where {_A, Grid, VectorType, VectorIntType, VectorRangeType, _A1, _B})}
</code></pre><p>Constructor for NetCDFOutput based on <code>S::SpectralGrid</code> and optionally the <code>Model</code> type (e.g. <code>ShallowWater</code>, <code>PrimitiveWet</code>) as second positional argument. The output grid is optionally determined by keyword arguments <code>output_Grid</code> (its type, full grid required), <code>nlat_half</code> (resolution) and <code>output_NF</code> (number format). By default, uses the full grid equivalent of the grid and resolution used in <code>SpectralGrid</code> <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.NetCDFOutput" href="#SpeedyWeather.NetCDFOutput"><code>SpeedyWeather.NetCDFOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Output writer for a netCDF file with (re-)gridded variables. Interpolates non-rectangular grids. Fields are</p><ul><li><p><code>active::Bool</code></p></li><li><p><code>path::String</code>: [OPTION] path to output folder, run_???? will be created within</p></li><li><p><code>id::String</code>: [OPTION] run identification number/string</p></li><li><p><code>run_path::String</code></p></li><li><p><code>filename::String</code>: [OPTION] name of the output netcdf file</p></li><li><p><code>write_restart::Bool</code>: [OPTION] also write restart file if output==true?</p></li><li><p><code>pkg_version::VersionNumber</code></p></li><li><p><code>startdate::DateTime</code></p></li><li><p><code>output_dt::Second</code>: [OPTION] output frequency, time step</p></li><li><p><code>variables::Dict{Symbol, SpeedyWeather.AbstractOutputVariable}</code>: [OPTION] dictionary of variables to output, e.g. u, v, vor, div, pres, temp, humid</p></li><li><p><code>output_every_n_steps::Int64</code></p></li><li><p><code>timestep_counter::Int64</code></p></li><li><p><code>output_counter::Int64</code></p></li><li><p><code>netcdf_file::Union{Nothing, NCDatasets.NCDataset}</code></p></li><li><p><code>interpolator::Any</code></p></li><li><p><code>grid2D::Any</code></p></li><li><p><code>grid3D::Any</code></p></li><li><p><code>grid3Dland::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L17-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.NoCallback" href="#SpeedyWeather.NoCallback"><code>SpeedyWeather.NoCallback</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Dummy callback that doesn&#39;t do anything.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/callbacks.jl#L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.NoConvection" href="#SpeedyWeather.NoConvection"><code>SpeedyWeather.NoConvection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Dummy type to disable convection.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/convection.jl#L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.NoOrography" href="#SpeedyWeather.NoOrography"><code>SpeedyWeather.NoOrography</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Orography with zero height in <code>orography</code> and zero surface geopotential <code>geopot_surf</code>.</p><ul><li><p><code>orography::Any</code>: height [m] on grid-point space.</p></li><li><p><code>geopot_surf::Any</code>: surface geopotential, height*gravity [m²/s²]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/orography.jl#L4-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.NoOutputVariable" href="#SpeedyWeather.NoOutputVariable"><code>SpeedyWeather.NoOutputVariable</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Dummy output variable that doesn&#39;t do anything.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L437">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.NoRandomProcess" href="#SpeedyWeather.NoRandomProcess"><code>SpeedyWeather.NoRandomProcess</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Dummy type for no random process.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/random_process.jl#L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.NoSurfacePerturbation" href="#SpeedyWeather.NoSurfacePerturbation"><code>SpeedyWeather.NoSurfacePerturbation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Returns the surface temperature and humidity without perturbation from the lowermost layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/convection.jl#L8-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.NoSurfacePerturbation-Tuple{ColumnVariables, PrimitiveEquation}" href="#SpeedyWeather.NoSurfacePerturbation-Tuple{ColumnVariables, PrimitiveEquation}"><code>SpeedyWeather.NoSurfacePerturbation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Returns the surface temperature and humidity without perturbation from the lowermost layer. Used as a functor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/convection.jl#L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.OrographyOutput" href="#SpeedyWeather.OrographyOutput"><code>SpeedyWeather.OrographyOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/boundaries.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Particle" href="#SpeedyWeather.Particle"><code>SpeedyWeather.Particle</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Particle with location lon (longitude), lat (latitude) and σ (vertical coordinate). Longitude is assumed to be in [0,360˚E), latitude in [-90˚,90˚N] and σ in [0,1] but not strictly enforced at creation, see <code>mod(::Particle)</code> and <code>ismod(::Particle)</code>. A particle is either active or inactive, determined by the Boolean in it&#39;s 2nd type parameter. By default, a particle is active, of number format DEFAULT_NF and at 0˚N, 0˚E, σ=0.</p><ul><li><p><code>lon::AbstractFloat</code>: longitude in [0,360˚]</p></li><li><p><code>lat::AbstractFloat</code>: latitude [-90˚,90˚]</p></li><li><p><code>σ::AbstractFloat</code>: vertical sigma coordinate [0 (top) to 1 (surface)]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/particles.jl#L5-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ParticleTracker" href="#SpeedyWeather.ParticleTracker"><code>SpeedyWeather.ParticleTracker</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A ParticleTracker is implemented as a callback to output the trajectories of particles from particle advection. To be added like</p><pre><code class="nohighlight hljs">add!(model.callbacks, ParticleTracker(spectral_grid; kwargs...))</code></pre><p>Output done via netCDF. Fields and options are</p><ul><li><p><code>schedule::Schedule</code>: [OPTION] when to schedule particle tracking</p></li><li><p><code>file_name::String</code>: [OPTION] File name for netCDF file</p></li><li><p><code>compression_level::Int64</code>: [OPTION] lossless compression level; 1=low but fast, 9=high but slow</p></li><li><p><code>shuffle::Bool</code>: [OPTION] shuffle/bittranspose filter for compression</p></li><li><p><code>keepbits::Int64</code>: [OPTION] mantissa bits to keep, (14, 15, 16) means at least (2km, 1km, 500m) accurate locations</p></li><li><p><code>nparticles::Int64</code>: Number of particles to track</p></li><li><p><code>netcdf_file::Union{Nothing, NCDatasets.NCDataset}</code>: The netcdf file to be written into, will be created at initialization</p></li><li><p><code>lon::Vector</code></p></li><li><p><code>lat::Vector</code></p></li><li><p><code>σ::Vector</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/particle_tracker.jl#L3-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ParticleVariables" href="#SpeedyWeather.ParticleVariables"><code>SpeedyWeather.ParticleVariables</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Diagnostic variables for the particle advection</p><ul><li><p><code>nparticles::Int64</code>: Number of particles</p></li><li><p><code>nlat_half::Int64</code>: Number of latitudes on one hemisphere (Eq. incld.), resolution parameter of Grid</p></li><li><p><code>locations::Any</code>: Work array: particle locations</p></li><li><p><code>u::Any</code>: Work array: velocity u</p></li><li><p><code>v::Any</code>: Work array: velocity v</p></li><li><p><code>σ_tend::Any</code>: Work array: velocity w = dσ/dt</p></li><li><p><code>interpolator::AnvilInterpolator</code>: Interpolator to interpolate velocity fields onto particle positions</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L372-L374">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ParticleVariables-Tuple{SpectralGrid}" href="#SpeedyWeather.ParticleVariables-Tuple{SpectralGrid}"><code>SpeedyWeather.ParticleVariables</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ParticleVariables(
    SG::SpectralGrid
) -&gt; ParticleVariables{var&quot;#s241&quot;, var&quot;#s240&quot;, var&quot;#s99&quot;, _A, &lt;:AbstractGrid} where {var&quot;#s241&quot;&lt;:AbstractFloat, var&quot;#s240&quot;&lt;:AbstractArray, var&quot;#s99&quot;&lt;:AbstractArray, _A}
</code></pre><p>Generator function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L403">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.PhysicsVariables" href="#SpeedyWeather.PhysicsVariables"><code>SpeedyWeather.PhysicsVariables</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Diagnostic variables of the physical parameterizations.</p><ul><li><p><code>nlat_half::Int64</code></p></li><li><p><code>ocean::DynamicsVariablesOcean</code></p></li><li><p><code>land::DynamicsVariablesLand</code></p></li><li><p><code>precip_large_scale::Any</code>: Accumulated large-scale precipitation [m]</p></li><li><p><code>precip_convection::Any</code>: Accumulated large-scale precipitation [m]</p></li><li><p><code>precip_rate_large_scale::Any</code>: Rate of large-scale precipitation [m/s], instantaneous</p></li><li><p><code>precip_rate_convection::Any</code>: Rate of large-scale precipitation [m/s], instantaneous</p></li><li><p><code>cloud_top::Any</code>: Cloud top [m]</p></li><li><p><code>sensible_heat_flux::Any</code>: Sensible heat flux [W/m²], positive up</p></li><li><p><code>evaporative_flux::Any</code>: Evaporative flux [kg/s/m^2], positive up</p></li><li><p><code>surface_shortwave_up::Any</code>: Surface radiation: shortwave up [W/m²]</p></li><li><p><code>surface_shortwave_down::Any</code>: Surface radiation: shortwave down [W/m²]</p></li><li><p><code>surface_longwave_up::Any</code>: Surface radiation: longwave up [W/m²]</p></li><li><p><code>surface_longwave_down::Any</code>: Surface radiation: longwave down [W/m²]</p></li><li><p><code>outgoing_shortwave_radiation::Any</code>: Outgoing shortwave radiation [W/m^2]</p></li><li><p><code>outgoing_longwave_radiation::Any</code>: Outgoing longwave radiation [W/m^2]</p></li><li><p><code>albedo::Any</code>: Albedo [1]</p></li><li><p><code>cos_zenith::Any</code>: Cosine of solar zenith angle [1]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L295-L297">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.PhysicsVariables-Tuple{SpectralGrid}" href="#SpeedyWeather.PhysicsVariables-Tuple{SpectralGrid}"><code>SpeedyWeather.PhysicsVariables</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PhysicsVariables(
    SG::SpectralGrid
) -&gt; PhysicsVariables{&lt;:AbstractFloat, &lt;:AbstractArray, &lt;:AbstractArray}
</code></pre><p>Generator function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L358">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.PrimitiveDryModel" href="#SpeedyWeather.PrimitiveDryModel"><code>SpeedyWeather.PrimitiveDryModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The PrimitiveDryModel contains all model components (themselves structs) needed for the simulation of the primitive equations without humidity. To be constructed like</p><pre><code class="nohighlight hljs">model = PrimitiveDryModel(spectral_grid; kwargs...)</code></pre><p>with <code>spectral_grid::SpectralGrid</code> used to initalize all non-default components passed on as keyword arguments, e.g. <code>planet=Earth(spectral_grid)</code>. Fields, representing model components, are</p><ul><li><p><code>spectral_grid::SpectralGrid</code></p></li><li><p><code>device_setup::Any</code></p></li><li><p><code>dynamics::Bool</code></p></li><li><p><code>geometry::Any</code></p></li><li><p><code>planet::Any</code></p></li><li><p><code>atmosphere::Any</code></p></li><li><p><code>coriolis::Any</code></p></li><li><p><code>geopotential::Any</code></p></li><li><p><code>adiabatic_conversion::Any</code></p></li><li><p><code>particle_advection::Any</code></p></li><li><p><code>initial_conditions::Any</code></p></li><li><p><code>forcing::Any</code></p></li><li><p><code>drag::Any</code></p></li><li><p><code>random_process::Any</code></p></li><li><p><code>tracers::Dict{Symbol, Tracer}</code></p></li><li><p><code>orography::Any</code></p></li><li><p><code>land_sea_mask::Any</code></p></li><li><p><code>ocean::Any</code></p></li><li><p><code>land::Any</code></p></li><li><p><code>solar_zenith::Any</code></p></li><li><p><code>albedo::Any</code></p></li><li><p><code>physics::Bool</code></p></li><li><p><code>boundary_layer_drag::Any</code></p></li><li><p><code>temperature_relaxation::Any</code></p></li><li><p><code>vertical_diffusion::Any</code></p></li><li><p><code>surface_thermodynamics::Any</code></p></li><li><p><code>surface_wind::Any</code></p></li><li><p><code>surface_heat_flux::Any</code></p></li><li><p><code>convection::Any</code></p></li><li><p><code>optical_depth::Any</code></p></li><li><p><code>shortwave_radiation::Any</code></p></li><li><p><code>longwave_radiation::Any</code></p></li><li><p><code>stochastic_physics::Any</code></p></li><li><p><code>time_stepping::Any</code></p></li><li><p><code>spectral_transform::Any</code></p></li><li><p><code>implicit::Any</code></p></li><li><p><code>horizontal_diffusion::Any</code></p></li><li><p><code>vertical_advection::Any</code></p></li><li><p><code>output::Any</code></p></li><li><p><code>callbacks::Dict{Symbol, SpeedyWeather.AbstractCallback}</code></p></li><li><p><code>feedback::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/primitive_dry.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.PrimitiveWetModel" href="#SpeedyWeather.PrimitiveWetModel"><code>SpeedyWeather.PrimitiveWetModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The PrimitiveWetModel contains all model components (themselves structs) needed for the simulation of the primitive equations with humidity. To be constructed like</p><pre><code class="nohighlight hljs">model = PrimitiveWetModel(spectral_grid; kwargs...)</code></pre><p>with <code>spectral_grid::SpectralGrid</code> used to initalize all non-default components passed on as keyword arguments, e.g. <code>planet=Earth(spectral_grid)</code>. Fields, representing model components, are</p><ul><li><p><code>spectral_grid::SpectralGrid</code></p></li><li><p><code>device_setup::Any</code></p></li><li><p><code>dynamics::Bool</code></p></li><li><p><code>geometry::Any</code></p></li><li><p><code>planet::Any</code></p></li><li><p><code>atmosphere::Any</code></p></li><li><p><code>coriolis::Any</code></p></li><li><p><code>geopotential::Any</code></p></li><li><p><code>adiabatic_conversion::Any</code></p></li><li><p><code>particle_advection::Any</code></p></li><li><p><code>initial_conditions::Any</code></p></li><li><p><code>forcing::Any</code></p></li><li><p><code>drag::Any</code></p></li><li><p><code>random_process::Any</code></p></li><li><p><code>tracers::Dict{Symbol, Tracer}</code></p></li><li><p><code>orography::Any</code></p></li><li><p><code>land_sea_mask::Any</code></p></li><li><p><code>ocean::Any</code></p></li><li><p><code>land::Any</code></p></li><li><p><code>solar_zenith::Any</code></p></li><li><p><code>albedo::Any</code></p></li><li><p><code>physics::Bool</code></p></li><li><p><code>clausius_clapeyron::Any</code></p></li><li><p><code>boundary_layer_drag::Any</code></p></li><li><p><code>temperature_relaxation::Any</code></p></li><li><p><code>vertical_diffusion::Any</code></p></li><li><p><code>surface_thermodynamics::Any</code></p></li><li><p><code>surface_wind::Any</code></p></li><li><p><code>surface_heat_flux::Any</code></p></li><li><p><code>surface_evaporation::Any</code></p></li><li><p><code>large_scale_condensation::Any</code></p></li><li><p><code>convection::Any</code></p></li><li><p><code>optical_depth::Any</code></p></li><li><p><code>shortwave_radiation::Any</code></p></li><li><p><code>longwave_radiation::Any</code></p></li><li><p><code>stochastic_physics::Any</code></p></li><li><p><code>time_stepping::Any</code></p></li><li><p><code>spectral_transform::Any</code></p></li><li><p><code>implicit::Any</code></p></li><li><p><code>horizontal_diffusion::Any</code></p></li><li><p><code>vertical_advection::Any</code></p></li><li><p><code>hole_filling::Any</code></p></li><li><p><code>output::Any</code></p></li><li><p><code>callbacks::Dict{Symbol, SpeedyWeather.AbstractCallback}</code></p></li><li><p><code>feedback::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/primitive_wet.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.PrognosticVariables-Tuple{SpectralGrid, AbstractModel}" href="#SpeedyWeather.PrognosticVariables-Tuple{SpectralGrid, AbstractModel}"><code>SpeedyWeather.PrognosticVariables</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PrognosticVariables(
    SG::SpectralGrid,
    model::AbstractModel
) -&gt; PrognosticVariables{var&quot;#s241&quot;, var&quot;#s240&quot;, _A, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray} where {var&quot;#s241&quot;&lt;:AbstractFloat, var&quot;#s240&quot;&lt;:AbstractArray, _A}
</code></pre><p>Generator function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/prognostic_variables.jl#L150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.PrognosticVariables-Tuple{SpectralGrid}" href="#SpeedyWeather.PrognosticVariables-Tuple{SpectralGrid}"><code>SpeedyWeather.PrognosticVariables</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PrognosticVariables(
    SG::SpectralGrid;
    nsteps
) -&gt; PrognosticVariables{var&quot;#s241&quot;, var&quot;#s240&quot;, _A, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray} where {var&quot;#s241&quot;&lt;:AbstractFloat, var&quot;#s240&quot;&lt;:AbstractArray, _A}
</code></pre><p>Generator function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/prognostic_variables.jl#L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.RandomPatternOutput" href="#SpeedyWeather.RandomPatternOutput"><code>SpeedyWeather.RandomPatternOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/stochastic.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.RandomVelocity" href="#SpeedyWeather.RandomVelocity"><code>SpeedyWeather.RandomVelocity</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Start with random velocity as initial conditions</p><ul><li><p><code>max_speed::Float64</code>: [OPTION] maximum speed [ms⁻¹]</p></li><li><p><code>truncation::Int64</code>: [OPTION] Maximum wavenumber after truncation</p></li><li><p><code>seed::Int64</code>: [OPTION] Random number generator seed, 0=randomly seed from Julia&#39;s GLOBAL_RNG</p></li><li><p><code>random_number_generator::Random.Xoshiro</code>: Independent random number generator for this random process</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L116-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.RandomVorticity" href="#SpeedyWeather.RandomVorticity"><code>SpeedyWeather.RandomVorticity</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Start with random vorticity as initial conditions</p><ul><li><p><code>power::Float64</code>: [OPTION] Power of the spectral distribution k^power</p></li><li><p><code>amplitude::Float64</code>: [OPTION] the (approximate) amplitude in [1/s], used as standard deviation of spherical harmonic coefficients</p></li><li><p><code>max_wavenumber::Int64</code>: [OPTION] Maximum wavenumber</p></li><li><p><code>seed::Int64</code>: [OPTION] Random number generator seed, 0=randomly seed from Julia&#39;s GLOBAL_RNG</p></li><li><p><code>random_number_generator::Random.Xoshiro</code>: Independent random number generator for this random process</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L65-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.RandomWaves" href="#SpeedyWeather.RandomWaves"><code>SpeedyWeather.RandomWaves</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Parameters for random initial conditions for the interface displacement η in the shallow water equations.</p><ul><li><p><code>A::Float64</code></p></li><li><p><code>lmin::Int64</code></p></li><li><p><code>lmax::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L676-L679">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.RockyPlanetMask" href="#SpeedyWeather.RockyPlanetMask"><code>SpeedyWeather.RockyPlanetMask</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Land-sea mask with one = land everywhere.</p><ul><li><code>mask::Any</code>: Land-sea mask [1] on grid-point space. Land=1, sea=0, land-area fraction in between.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/land_sea_mask.jl#L153-L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.RossbyHaurwitzWave" href="#SpeedyWeather.RossbyHaurwitzWave"><code>SpeedyWeather.RossbyHaurwitzWave</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Rossby-Haurwitz wave initial conditions as in Williamson et al. 1992, J Computational Physics with an additional cut-off amplitude <code>c</code> to filter out tiny harmonics in the vorticity field. Parameters are </p><ul><li><p><code>m::Int64</code></p></li><li><p><code>ω::Float64</code></p></li><li><p><code>K::Float64</code></p></li><li><p><code>c::Float64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L378-L381">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Schedule" href="#SpeedyWeather.Schedule"><code>SpeedyWeather.Schedule</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A schedule for callbacks, to execute them periodically after a given period has passed (first timestep excluded) or on/after specific times (initial time excluded). For two consecutive time steps i, i+1, an event is scheduled at i+1 when it occurs in (i,i+1]. Similarly, a periodic schedule of period p will be executed at start+p, but p is rounded to match the multiple of the model timestep. Periodic schedules and event schedules can be combined, executing at both. A Schedule is supposed to be added into callbacks as fields</p><pre><code class="nohighlight hljs">Base.@kwdef struct MyCallback
    schedule::Schedule = Schedule(every=Day(1))
    other_fields
end</code></pre><p>see also initialize!(::Schedule,::Clock) and isscheduled(::Schedule,::Clock). Fields</p><ul><li><p><code>every::Second</code>: [OPTION] Execute every time period, first timestep excluded. Default=never.</p></li><li><p><code>times::Vector{DateTime}</code>: [OPTION] Events scheduled at times</p></li><li><p><code>schedule::BitVector</code>: Actual schedule, true=execute this timestep, false=don&#39;t</p></li><li><p><code>steps::Int64</code>: Number of scheduled executions</p></li><li><p><code>counter::Int64</code>: Count up the number of executions</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/schedule.jl#L5-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Schedule-Tuple{Vararg{DateTime}}" href="#SpeedyWeather.Schedule-Tuple{Vararg{DateTime}}"><code>SpeedyWeather.Schedule</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Schedule(times::DateTime...) -&gt; Schedule
</code></pre><p>A Schedule based on DateTime arguments, For two consecutive time steps i, i+1, an event is scheduled at i+1 when it occurs in (i,i+1].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/schedule.jl#L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SeaSurfaceTemperatureOutput" href="#SpeedyWeather.SeaSurfaceTemperatureOutput"><code>SpeedyWeather.SeaSurfaceTemperatureOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li><li><p><code>transform::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/ocean.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SeasonalOceanClimatology" href="#SpeedyWeather.SeasonalOceanClimatology"><code>SpeedyWeather.SeasonalOceanClimatology</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Seasonal ocean climatology that reads monthly sea surface temperature fields from file, and interpolates them in time regularly (default every 3 days) to be stored in the prognostic variables. Fields and options are</p><ul><li><p><code>nlat_half::Int64</code>: number of latitudes on one hemisphere, Equator included</p></li><li><p><code>path::String</code>: [OPTION] Path to the folder containing the sea surface temperatures, pkg path default</p></li><li><p><code>file::String</code>: [OPTION] Filename of sea surface temperatures</p></li><li><p><code>varname::String</code>: [OPTION] Variable name in netcdf file</p></li><li><p><code>file_Grid::Type{&lt;:AbstractGrid}</code>: [OPTION] Grid the sea surface temperature file comes on</p></li><li><p><code>missing_value::Any</code>: [OPTION] The missing value in the data respresenting land</p></li><li><p><code>monthly_temperature::Any</code>: Monthly sea surface temperatures [K], interpolated onto Grid</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/ocean.jl#L73-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SensibleHeatFluxOutput" href="#SpeedyWeather.SensibleHeatFluxOutput"><code>SpeedyWeather.SensibleHeatFluxOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/surface_fluxes.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ShallowWaterModel" href="#SpeedyWeather.ShallowWaterModel"><code>SpeedyWeather.ShallowWaterModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The ShallowWaterModel contains all model components needed for the simulation of the shallow water equations. To be constructed like</p><pre><code class="nohighlight hljs">model = ShallowWaterModel(spectral_grid; kwargs...)</code></pre><p>with <code>spectral_grid::SpectralGrid</code> used to initalize all non-default components passed on as keyword arguments, e.g. <code>planet=Earth(spectral_grid)</code>. Fields, representing model components, are</p><ul><li><p><code>spectral_grid::SpectralGrid</code></p></li><li><p><code>device_setup::Any</code></p></li><li><p><code>geometry::Any</code></p></li><li><p><code>planet::Any</code></p></li><li><p><code>atmosphere::Any</code></p></li><li><p><code>coriolis::Any</code></p></li><li><p><code>orography::Any</code></p></li><li><p><code>forcing::Any</code></p></li><li><p><code>drag::Any</code></p></li><li><p><code>particle_advection::Any</code></p></li><li><p><code>initial_conditions::Any</code></p></li><li><p><code>random_process::Any</code></p></li><li><p><code>tracers::Dict{Symbol, Tracer}</code></p></li><li><p><code>time_stepping::Any</code></p></li><li><p><code>spectral_transform::Any</code></p></li><li><p><code>implicit::Any</code></p></li><li><p><code>horizontal_diffusion::Any</code></p></li><li><p><code>output::Any</code></p></li><li><p><code>callbacks::Dict{Symbol, SpeedyWeather.AbstractCallback}</code></p></li><li><p><code>feedback::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/shallow_water.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SigmaCoordinates" href="#SpeedyWeather.SigmaCoordinates"><code>SpeedyWeather.SigmaCoordinates</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Sigma coordinates for the vertical coordinates, defined by their half layers. Sigma coordinates are currently hardcoded in Geometry.</p><ul><li><p><code>nlayers::Int64</code></p></li><li><p><code>σ_half::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/vertical_coordinates.jl#L5-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SimplifiedBettsMiller" href="#SpeedyWeather.SimplifiedBettsMiller"><code>SpeedyWeather.SimplifiedBettsMiller</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The simplified Betts-Miller convection scheme from Frierson, 2007, https://doi.org/10.1175/JAS3935.1. This implements the qref-formulation in their paper. Fields and options are</p><ul><li><p><code>nlayers::Int64</code>: number of vertical layers</p></li><li><p><code>time_scale::Second</code>: [OPTION] Relaxation time for profile adjustment</p></li><li><p><code>relative_humidity::Any</code>: [OPTION] Relative humidity for reference profile</p></li><li><p><code>surface_temp_humid::Any</code>: [OPTION] Surface perturbation of temp, humid to calculate the moist pseudo adiabat</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/convection.jl#L44-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Simulation" href="#SpeedyWeather.Simulation"><code>SpeedyWeather.Simulation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Simulation is a container struct to be used with <code>run!(::Simulation)</code>. It contains</p><ul><li><p><code>prognostic_variables::PrognosticVariables</code>: define the current state of the model</p></li><li><p><code>diagnostic_variables::DiagnosticVariables</code>: contain the tendencies and auxiliary arrays to compute them</p></li><li><p><code>model::AbstractModel</code>: all parameters, constant at runtime</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/simulation.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SinSolarDeclination" href="#SpeedyWeather.SinSolarDeclination"><code>SpeedyWeather.SinSolarDeclination</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Coefficients to calculate the solar declination angle δ [radians] based on a simple sine function, with Earth&#39;s axial tilt as amplitude, equinox as phase shift.</p><ul><li><p><code>axial_tilt::Any</code></p></li><li><p><code>equinox::DateTime</code></p></li><li><p><code>length_of_year::Second</code></p></li><li><p><code>length_of_day::Second</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L5-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SinSolarDeclination-Tuple{NF} where NF" href="#SpeedyWeather.SinSolarDeclination-Tuple{NF} where NF"><code>SpeedyWeather.SinSolarDeclination</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>SinSolarDeclination functor, computing the solar declination angle of angular fraction of year g [radians] using the coefficients of the SinSolarDeclination struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SinSolarDeclination-Tuple{SpectralGrid, SpeedyWeather.AbstractPlanet}" href="#SpeedyWeather.SinSolarDeclination-Tuple{SpectralGrid, SpeedyWeather.AbstractPlanet}"><code>SpeedyWeather.SinSolarDeclination</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generator function using the planet&#39;s orbital parameters to adapt the solar declination calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L18-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SinSolarDeclination-Tuple{SpectralGrid}" href="#SpeedyWeather.SinSolarDeclination-Tuple{SpectralGrid}"><code>SpeedyWeather.SinSolarDeclination</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generator function pulling the number format NF from a SpectralGrid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SoilMoistureAvailabilityOutput" href="#SpeedyWeather.SoilMoistureAvailabilityOutput"><code>SpeedyWeather.SoilMoistureAvailabilityOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variable, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/land.jl#L36-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SoilMoistureOutput" href="#SpeedyWeather.SoilMoistureOutput"><code>SpeedyWeather.SoilMoistureOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variable, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>is_land::Bool</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/land.jl#L19-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SoilTemperatureOutput" href="#SpeedyWeather.SoilTemperatureOutput"><code>SpeedyWeather.SoilTemperatureOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variable, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>is_land::Bool</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li><li><p><code>transform::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/land.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarDeclination" href="#SpeedyWeather.SolarDeclination"><code>SpeedyWeather.SolarDeclination</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Coefficients to calculate the solar declination angle δ from</p><pre><code class="nohighlight hljs">δ = 0.006918    - 0.399912*cos(g)  + 0.070257*sin(g)
                - 0.006758*cos(2g) + 0.000907*sin(2g)
                - 0.002697*cos(3g) + 0.001480*sin(3g)</code></pre><p>with g the angular fraction of the year in radians. Following Spencer 1971, Fourier series representation of the position of the sun. Search 2(5):172.</p><ul><li><p><code>a::AbstractFloat</code></p></li><li><p><code>s1::AbstractFloat</code></p></li><li><p><code>c1::AbstractFloat</code></p></li><li><p><code>s2::AbstractFloat</code></p></li><li><p><code>c2::AbstractFloat</code></p></li><li><p><code>s3::AbstractFloat</code></p></li><li><p><code>c3::AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L36-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarDeclination-Tuple{Any}" href="#SpeedyWeather.SolarDeclination-Tuple{Any}"><code>SpeedyWeather.SolarDeclination</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>SolarDeclination functor, computing the solar declination angle of angular fraction of year g [radians] using the coefficients of the SolarDeclination struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarDeclination-Tuple{SpectralGrid}" href="#SpeedyWeather.SolarDeclination-Tuple{SpectralGrid}"><code>SpeedyWeather.SolarDeclination</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generator function pulling the number format NF from a SpectralGrid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarTimeCorrection" href="#SpeedyWeather.SolarTimeCorrection"><code>SpeedyWeather.SolarTimeCorrection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Coefficients for the solar time correction (also called Equation of time) which adjusts the solar hour to an oscillation of sunrise/set by about +-16min throughout the year.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L77-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarTimeCorrection-Tuple{Any}" href="#SpeedyWeather.SolarTimeCorrection-Tuple{Any}"><code>SpeedyWeather.SolarTimeCorrection</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Functor that returns the time correction for a angular fraction of the year g [radians], so that g=0 for Jan-01 and g=2π for Dec-31.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarZenith" href="#SpeedyWeather.SolarZenith"><code>SpeedyWeather.SolarZenith</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Solar zenith angle varying with daily and seasonal cycle.</p><ul><li><p><code>length_of_day::Second</code></p></li><li><p><code>length_of_year::Second</code></p></li><li><p><code>equation_of_time::Bool</code></p></li><li><p><code>seasonal_cycle::Bool</code></p></li><li><p><code>solar_declination::SpeedyWeather.SinSolarDeclination{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>time_correction::SpeedyWeather.SolarTimeCorrection</code></p></li><li><p><code>initial_time::Base.RefValue{DateTime}</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L141-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarZenithSeason" href="#SpeedyWeather.SolarZenithSeason"><code>SpeedyWeather.SolarZenithSeason</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Solar zenith angle varying with seasonal cycle only.</p><ul><li><p><code>length_of_day::Second</code></p></li><li><p><code>length_of_year::Second</code></p></li><li><p><code>seasonal_cycle::Bool</code></p></li><li><p><code>solar_declination::SpeedyWeather.SinSolarDeclination{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>initial_time::Base.RefValue{DateTime}</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L239-L241">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpectralAR1Process" href="#SpeedyWeather.SpectralAR1Process"><code>SpeedyWeather.SpectralAR1Process</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>First-order auto-regressive random process (AR1) in spectral space, evolving <code>wavenumbers</code> with respectice <code>time_scales</code> and <code>standard_deviations</code> independently. Transformed after every time step to grid space with a <code>clamp</code> applied to limit extrema. For reproducability <code>seed</code> can be provided and an independent <code>random_number_generator</code> is used that is reseeded on every <code>initialize!</code>. Fields are: </p><ul><li><p><code>trunc::Int64</code></p></li><li><p><code>time_scale::Second</code>: [OPTION] Time scale of the AR1 process</p></li><li><p><code>wavenumber::Int64</code>: [OPTION] Wavenumber of the AR1 process</p></li><li><p><code>standard_deviation::Any</code>: [OPTION] Standard deviation of the AR1 process</p></li><li><p><code>clamp::Tuple{NF, NF} where NF</code>: [OPTION] Range to clamp values into after every transform into grid space</p></li><li><p><code>seed::Int64</code>: [OPTION] Random number generator seed, 0=randomly seed from Julia&#39;s GLOBAL_RNG</p></li><li><p><code>random_number_generator::Random.Xoshiro</code>: Independent random number generator for this random process</p></li><li><p><code>autoregressive_factor::Base.RefValue</code>: Precomputed auto-regressive factor [1], function of time scale and model time step</p></li><li><p><code>noise_factors::Any</code>: Precomputed noise factors [1] for every total wavenumber l</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/random_process.jl#L46-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpectralFilter" href="#SpeedyWeather.SpectralFilter"><code>SpeedyWeather.SpectralFilter</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Spectral filter for horizontal diffusion. Fields are: </p><ul><li><p><code>trunc::Int64</code>: spectral resolution</p></li><li><p><code>nlayers::Int64</code>: number of vertical levels</p></li><li><p><code>shift::Any</code>: [OPTION] shift diffusion to higher (positive shift) or lower (neg) wavenumbers, relative to trunc</p></li><li><p><code>scale::Any</code>: [OPTION] Scale-selectiveness, steepness of the sigmoid, higher is more selective</p></li><li><p><code>time_scale::Second</code>: [OPTION] diffusion time scale</p></li><li><p><code>time_scale_div::Second</code>: [OPTION] stronger diffusion time scale for divergence</p></li><li><p><code>resolution_scaling::Any</code>: [OPTION] resolution scaling to shorten time_scale with trunc</p></li><li><p><code>power::Any</code>: [OPTION] power of the tanh function</p></li><li><p><code>power_div::Any</code>: [OPTION] power of the tanh function for divergence</p></li><li><p><code>expl::Any</code></p></li><li><p><code>impl::Any</code></p></li><li><p><code>expl_div::Any</code></p></li><li><p><code>impl_div::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/horizontal_diffusion.jl#L241">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpectralFilter-Tuple{SpectralGrid}" href="#SpeedyWeather.SpectralFilter-Tuple{SpectralGrid}"><code>SpeedyWeather.SpectralFilter</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpectralFilter(
    spectral_grid::SpectralGrid;
    kwargs...
) -&gt; SpectralFilter{&lt;:AbstractFloat}
</code></pre><p>Generator function based on the resolutin in <code>spectral_grid</code>. Passes on keyword arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/horizontal_diffusion.jl#L285">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpectralGrid" href="#SpeedyWeather.SpectralGrid"><code>SpeedyWeather.SpectralGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the horizontal spectral resolution and corresponding grid and the vertical coordinate for SpeedyWeather.jl. Options are</p><ul><li><p><code>NF::Type{&lt;:AbstractFloat}</code>: [OPTION] number format used throughout the model</p></li><li><p><code>device::SpeedyWeather.AbstractDevice</code>: [OPTION] device archictecture to run on</p></li><li><p><code>ArrayType::Type{&lt;:AbstractArray}</code>: [OPTION] array type to use for all variables</p></li><li><p><code>VectorType::Type{&lt;:AbstractVector}</code>: [DERIVED] Type of vector</p></li><li><p><code>MatrixType::Type{&lt;:AbstractMatrix}</code>: [DERIVED] Type of matrix</p></li><li><p><code>TensorType::Type{&lt;:AbstractArray}</code>: [DERIVED] Type of 3D array</p></li><li><p><code>trunc::Int64</code>: [OPTION] horizontal resolution as the maximum degree of spherical harmonics</p></li><li><p><code>SpectralVariable2D::Type{&lt;:AbstractArray}</code>: [DERIVED] Type of spectral variable in 2D (horizontal only, flattened into 1D vector)</p></li><li><p><code>SpectralVariable3D::Type{&lt;:AbstractArray}</code>: [DERIVED] Type of spectral variable in 3D (horizontal only + e.g vertical, flattened into 2D matrix)</p></li><li><p><code>SpectralVariable4D::Type{&lt;:AbstractArray}</code>: [DERIVED] Type of spectral variable in 4D (horizontal only + e.g. vertical and time, flattened into 3D array)</p></li><li><p><code>Grid::Type{&lt;:AbstractGrid}</code>: [OPTION] horizontal grid used for calculations in grid-point space</p></li><li><p><code>GridVariable2D::Type{&lt;:AbstractArray}</code>: [DERIVED] Type of grid variable in 2D (horizontal only, flattened into 1D vector)</p></li><li><p><code>GridVariable3D::Type{&lt;:AbstractArray}</code>: [DERIVED] Type of grid variable in 3D (horizontal + e.g. vertical, flattened into 2D matrix)</p></li><li><p><code>GridVariable4D::Type{&lt;:AbstractArray}</code>: [DERIVED] Type of grid variable in 4D (horizontal + e.g. vertical + time, flattened into 3D array)</p></li><li><p><code>dealiasing::Float64</code>: [OPTION] how to match spectral with grid resolution: dealiasing factor, 1=linear, 2=quadratic, 3=cubic grid</p></li><li><p><code>radius::Float64</code>: [OPTION] radius of the sphere [m]</p></li><li><p><code>nparticles::Int64</code>: [OPTION] number of particles for particle advection [1]</p></li><li><p><code>ParticleVector::Type{&lt;:AbstractArray}</code>: [DERIVED] ArrayType of particle vector</p></li><li><p><code>nlat_half::Int64</code>: [DERIVED] number of latitude rings on one hemisphere (Equator incl)</p></li><li><p><code>nlat::Int64</code>: [DERIVED] number of latitude rings on both hemispheres</p></li><li><p><code>npoints::Int64</code>: [DERIVED] total number of grid points in the horizontal</p></li><li><p><code>nlayers::Int64</code>: [OPTION] number of vertical layers in the atmosphere</p></li><li><p><code>nlayers_soil::Int64</code>: [OPTION] number of vertical layers in the soil/land</p></li></ul><p><code>nlat_half</code> and <code>npoints</code> should not be chosen but are derived from <code>trunc</code>, <code>Grid</code> and <code>dealiasing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/spectral_grid.jl#L17-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform-Tuple{SpectralGrid}" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform-Tuple{SpectralGrid}"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpectralTransform(
    spectral_grid::SpectralGrid;
    one_more_degree,
    kwargs...
) -&gt; SpectralTransform{NF, _A, _B, _C, _D, _E, LowerTriangularArray{NF1, 1, _A1}, LowerTriangularArray{NF2, 2, _A2}} where {NF&lt;:AbstractFloat, _A, _B, _C, _D, _E, NF1&lt;:AbstractFloat, _A1, NF2&lt;:AbstractFloat, _A2}
</code></pre><p>Generator function for a SpectralTransform struct pulling in parameters from a SpectralGrid struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/spectral_grid.jl#L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.StartFromFile" href="#SpeedyWeather.StartFromFile"><code>SpeedyWeather.StartFromFile</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Restart from a previous SpeedyWeather.jl simulation via the restart file restart.jld2 Applies interpolation in the horizontal but not in the vertical. restart.jld2 is identified by</p><ul><li><p><code>path::String</code>: path for restart file</p></li><li><p><code>id::Union{Int64, String}</code>: <code>run_id</code> of restart file in <code>run_????/restart.jld2</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L511-L515">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SurfacePressureOutput" href="#SpeedyWeather.SurfacePressureOutput"><code>SpeedyWeather.SurfacePressureOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li><li><p><code>transform::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/dynamics.jl#L108-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.TemperatureOutput" href="#SpeedyWeather.TemperatureOutput"><code>SpeedyWeather.TemperatureOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li><li><p><code>transform::Any</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/dynamics.jl#L124-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Tendencies" href="#SpeedyWeather.Tendencies"><code>SpeedyWeather.Tendencies</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Tendencies of the prognostic variables in spectral and grid-point space</p><ul><li><p><code>trunc::Int64</code></p></li><li><p><code>nlat_half::Int64</code></p></li><li><p><code>nlayers::Int64</code></p></li><li><p><code>vor_tend::Any</code>: Vorticity of horizontal wind field [1/s]</p></li><li><p><code>div_tend::Any</code>: Divergence of horizontal wind field [1/s]</p></li><li><p><code>temp_tend::Any</code>: Absolute temperature [K]</p></li><li><p><code>humid_tend::Any</code>: Specific humidity [kg/kg]</p></li><li><p><code>u_tend::Any</code>: Zonal velocity [m/s]</p></li><li><p><code>v_tend::Any</code>: Meridional velocity [m/s]</p></li><li><p><code>pres_tend::Any</code>: Logarithm of surface pressure [Pa]</p></li><li><p><code>tracers_tend::Dict{Symbol}</code>: Tracers [?]</p></li><li><p><code>u_tend_grid::Any</code>: Zonal velocity [m/s], grid</p></li><li><p><code>v_tend_grid::Any</code>: Meridinoal velocity [m/s], grid</p></li><li><p><code>temp_tend_grid::Any</code>: Absolute temperature [K], grid</p></li><li><p><code>humid_tend_grid::Any</code>: Specific humidity [kg/kg], grid</p></li><li><p><code>pres_tend_grid::Any</code>: Logarith of surface pressure [Pa], grid</p></li><li><p><code>tracers_tend_grid::Dict{Symbol}</code>: Tracers [?], grid</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L33-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Tendencies-Tuple{SpectralGrid}" href="#SpeedyWeather.Tendencies-Tuple{SpectralGrid}"><code>SpeedyWeather.Tendencies</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Tendencies(
    SG::SpectralGrid
) -&gt; Tendencies{&lt;:AbstractFloat, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray, &lt;:AbstractArray}
</code></pre><p>Generator function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.TetensEquation" href="#SpeedyWeather.TetensEquation"><code>SpeedyWeather.TetensEquation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Parameters for computing saturation vapour pressure of water using the Tetens&#39; equation,</p><pre><code class="nohighlight hljs">eᵢ(T) = e₀ * exp(Cᵢ * (T - T₀) / (T + Tᵢ)),</code></pre><p>where T is in Kelvin and i = 1, 2 for saturation above and below freezing, respectively. From Tetens (1930), and Murray (1967) for below freezing.</p><ul><li><p><code>e₀::AbstractFloat</code>: Saturation water vapour pressure at 0°C [Pa]</p></li><li><p><code>T₀::AbstractFloat</code>: 0°C in Kelvin</p></li><li><p><code>T₁::AbstractFloat</code>: Tetens denominator (water) [˚C]</p></li><li><p><code>T₂::AbstractFloat</code>: Tetens denominator following Murray (1967, below freezing) [˚C]</p></li><li><p><code>C₁::AbstractFloat</code>: Tetens numerator scaling [1], above freezing</p></li><li><p><code>C₂::AbstractFloat</code>: Tetens numerator scaling [1], below freezing</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L185-L192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.TetensEquation-Tuple{NF} where NF" href="#SpeedyWeather.TetensEquation-Tuple{NF} where NF"><code>SpeedyWeather.TetensEquation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Functor: Saturation water vapour pressure as a function of temperature using the Tetens equation,</p><pre><code class="nohighlight hljs">eᵢ(T) = e₀ * exp(Cᵢ * (T - T₀) / (T - Tᵢ)),</code></pre><p>where T is in Kelvin and i = 1, 2 for saturation above and below freezing, respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Tracer" href="#SpeedyWeather.Tracer"><code>SpeedyWeather.Tracer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Define tracer through a <code>name::Symbol</code> (used as key in the tracer dictionaries) and define it as <code>active</code> (=true default). <code>active=false</code> will (temporarily) disable the time evolution of the tracer. Fields are</p><ul><li><p><code>name::Symbol</code></p></li><li><p><code>active::Bool</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tracers.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.UniformCooling" href="#SpeedyWeather.UniformCooling"><code>SpeedyWeather.UniformCooling</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Uniform cooling following Paulius and Garner, 2006. JAS. https://doi.org/10.1175/JAS3705.1 imposing a default temperature tendency of -1.5K/day (=1K/16hours for a <code>time_scale</code> of 16 hours) on every level except for the stratosphere (diagnosed as <code>temp &lt; temp_min</code>) where a relaxation term with <code>time_scale_stratosphere</code> towards <code>temp_stratosphere</code> is applied.</p><pre><code class="nohighlight hljs">dT/dt = -1.5K/day for T &gt; 207.5K else (200K-T) / 5 days</code></pre><p>Fields are</p><ul><li><p><code>time_scale::Second</code>: [OPTION] time scale of cooling, default = -1.5K/day = -1K/16hrs</p></li><li><p><code>temp_min::Any</code>: [OPTION] temperature [K] below which stratospheric relaxation is applied</p></li><li><p><code>temp_stratosphere::Any</code>: [OPTION] target temperature [K] of stratospheric relaxation</p></li><li><p><code>time_scale_stratosphere::Second</code>: [OPTION] time scale of stratospheric relaxation</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/longwave_radiation.jl#L19-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.VorticityOutput" href="#SpeedyWeather.VorticityOutput"><code>SpeedyWeather.VorticityOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output of vorticity. Fields are</p><ul><li><p><code>name::String</code>: [Required] short name of variable (unique) used in netCDF file and key for dictionary</p></li><li><p><code>unit::String</code>: [Required] unit of variable</p></li><li><p><code>long_name::String</code>: [Required] long name of variable used in netCDF file</p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code>: [Required] NetCDF dimensions the variable uses, lon, lat, layer, time</p></li><li><p><code>missing_value::Float64</code>: [Optional] missing value for the variable, if not specified uses NaN</p></li><li><p><code>compression_level::Int64</code>: [Optional] compression level of the lossless compressor, 1=lowest/fastest, 9=highest/slowest, 3=default</p></li><li><p><code>shuffle::Bool</code>: [Optional] bitshuffle the data for compression, false = default</p></li><li><p><code>keepbits::Int64</code>: [Optional] number of mantissa bits to keep for compression (default: 15)</p></li><li><p><code>unscale::Bool</code>: [Optional] Unscale the variable for output? (default: true)</p></li></ul><p>Custom variable output defined similarly with required fields marked, optional fields otherwise use variable-independent defaults. Initialize with <code>VorticityOutput()</code> and non-default fields can always be passed on as keyword arguments, e.g. <code>VorticityOutput(long_name=&quot;relative vorticity&quot;, compression_level=0)</code>. Custom variable output also requires the <code>path(::MyOutputVariable, simulation)</code> to be extended to return the AbstractGridArray to be output. Custom element-wise variable transforms, e.g. scale and/or offset to change units, or even exp(x)/100 to change from log surface pressure to hPa are passed on as <code>transform::Function = x -&gt; exp(x)/100</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/dynamics.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ZonalJet" href="#SpeedyWeather.ZonalJet"><code>SpeedyWeather.ZonalJet</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A struct that contains all parameters for the Galewsky et al, 2004 zonal jet intitial conditions for the ShallowWaterModel. Default values as in Galewsky.</p><ul><li><p><code>latitude::Float64</code>: jet latitude [˚N]</p></li><li><p><code>width::Float64</code>: jet width [˚], default ≈ 19.29˚</p></li><li><p><code>umax::Float64</code>: jet maximum velocity [m/s]</p></li><li><p><code>perturb_lat::Float64</code>: perturbation latitude [˚N], position in jet by default</p></li><li><p><code>perturb_lon::Float64</code>: perturbation longitude [˚E]</p></li><li><p><code>perturb_xwidth::Float64</code>: perturbation zonal extent [˚], default ≈ 19.1˚</p></li><li><p><code>perturb_ywidth::Float64</code>: perturbation meridinoal extent [˚], default ≈ 3.8˚</p></li><li><p><code>perturb_height::Float64</code>: perturbation amplitude [m]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L166-L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ZonalRidge" href="#SpeedyWeather.ZonalRidge"><code>SpeedyWeather.ZonalRidge</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Zonal ridge orography after Jablonowski and Williamson, 2006.</p><ul><li><p><code>η₀::Any</code>: conversion from σ to Jablonowski&#39;s ηᵥ-coordinates</p></li><li><p><code>u₀::Any</code>: max amplitude of zonal wind [m/s] that scales orography height</p></li><li><p><code>orography::Any</code>: height [m] on grid-point space.</p></li><li><p><code>geopot_surf::Any</code>: surface geopotential, height*gravity [m²/s²]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/orography.jl#L45-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ZonalVelocityOutput" href="#SpeedyWeather.ZonalVelocityOutput"><code>SpeedyWeather.ZonalVelocityOutput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines netCDF output for a specific variables, see <a href="#SpeedyWeather.VorticityOutput"><code>VorticityOutput</code></a> for details. Fields are: </p><ul><li><p><code>name::String</code></p></li><li><p><code>unit::String</code></p></li><li><p><code>long_name::String</code></p></li><li><p><code>dims_xyzt::NTuple{4, Bool}</code></p></li><li><p><code>missing_value::Float64</code></p></li><li><p><code>compression_level::Int64</code></p></li><li><p><code>shuffle::Bool</code></p></li><li><p><code>keepbits::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/dynamics.jl#L47-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ZonalWind" href="#SpeedyWeather.ZonalWind"><code>SpeedyWeather.ZonalWind</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Create a struct that contains all parameters for the Jablonowski and Williamson, 2006 intitial conditions for the primitive equation model. Default values as in Jablonowski.</p><ul><li><p><code>η₀::Float64</code>: conversion from σ to Jablonowski&#39;s ηᵥ-coordinates</p></li><li><p><code>u₀::Float64</code>: max amplitude of zonal wind [m/s]</p></li><li><p><code>perturb_lat::Float64</code>: perturbation centred at [˚N]</p></li><li><p><code>perturb_lon::Float64</code>: perturbation centred at [˚E]</p></li><li><p><code>perturb_uₚ::Float64</code>: perturbation strength [m/s]</p></li><li><p><code>perturb_radius::Float64</code>: radius of Gaussian perturbation in units of Earth&#39;s radius [1]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L289">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.copy!-Tuple{PrognosticVariables, PrognosticVariables}" href="#Base.copy!-Tuple{PrognosticVariables, PrognosticVariables}"><code>Base.copy!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">copy!(
    progn_new::PrognosticVariables,
    progn_old::PrognosticVariables
)
</code></pre><p>Copies entries of <code>progn_old</code> into <code>progn_new</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/prognostic_variables.jl#L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.delete!-Tuple{NetCDFOutput, Vararg{Union{String, Symbol}}}" href="#Base.delete!-Tuple{NetCDFOutput, Vararg{Union{String, Symbol}}}"><code>Base.delete!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">delete!(
    output::NetCDFOutput,
    keys::Union{String, Symbol}...
) -&gt; NetCDFOutput
</code></pre><p>Delete output variables from <code>output</code> by their (short name) (Symbol or String), corresponding to the keys in the dictionary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.delete!-Tuple{PrognosticVariables, Vararg{Tracer}}" href="#Base.delete!-Tuple{PrognosticVariables, Vararg{Tracer}}"><code>Base.delete!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">delete!(progn::PrognosticVariables, tracers::Tracer...)
</code></pre><p>Delete <code>tracers</code> in the prognostic variables <code>progn</code> in <code>progn.tracers::Dict</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/prognostic_variables.jl#L327">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.delete!-Tuple{SpeedyWeather.AbstractSimulation, Tracer}" href="#Base.delete!-Tuple{SpeedyWeather.AbstractSimulation, Tracer}"><code>Base.delete!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">delete!(
    simulation::SpeedyWeather.AbstractSimulation,
    tracer::Tracer
) -&gt; Any
</code></pre><p>Delete a tracer from a simulation, deleted from the model and the variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tracers.jl#L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.fill!-Tuple{Tendencies, Any, Type{&lt;:Barotropic}}" href="#Base.fill!-Tuple{Tendencies, Any, Type{&lt;:Barotropic}}"><code>Base.fill!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fill!(
    tendencies::Tendencies,
    x,
    _::Type{&lt;:Barotropic}
) -&gt; Tendencies
</code></pre><p>Set the tendencies for the barotropic model to <code>x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L565">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.fill!-Tuple{Tendencies, Any, Type{&lt;:PrimitiveDry}}" href="#Base.fill!-Tuple{Tendencies, Any, Type{&lt;:PrimitiveDry}}"><code>Base.fill!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fill!(
    tendencies::Tendencies,
    x,
    _::Type{&lt;:PrimitiveDry}
) -&gt; Tendencies
</code></pre><p>Set the tendencies for the primitive dry model to <code>x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L593">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.fill!-Tuple{Tendencies, Any, Type{&lt;:PrimitiveWet}}" href="#Base.fill!-Tuple{Tendencies, Any, Type{&lt;:PrimitiveWet}}"><code>Base.fill!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fill!(
    tendencies::Tendencies,
    x,
    _::Type{&lt;:PrimitiveWet}
) -&gt; Tendencies
</code></pre><p>Set the tendencies for the primitive wet model to <code>x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L602">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.fill!-Tuple{Tendencies, Any, Type{&lt;:ShallowWater}}" href="#Base.fill!-Tuple{Tendencies, Any, Type{&lt;:ShallowWater}}"><code>Base.fill!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fill!(
    tendencies::Tendencies,
    x,
    _::Type{&lt;:ShallowWater}
) -&gt; Tendencies
</code></pre><p>Set the tendencies for the shallow-water model to <code>x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/diagnostic_variables.jl#L583">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.mod-Tuple{P} where P&lt;:Particle" href="#Base.mod-Tuple{P} where P&lt;:Particle"><code>Base.mod</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mod(p::Particle) -&gt; Any
</code></pre><p>Modulo operator for particle locations to map them back into [0,360˚E) and [-90˚,90˚N], in the horizontal and to clamp vertical σ coordinates into [0,1].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/particles.jl#L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.CallbackDict-Tuple{Vararg{Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}}}" href="#SpeedyWeather.CallbackDict-Tuple{Vararg{Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}}}"><code>SpeedyWeather.CallbackDict</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CallbackDict(
    pairs::Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}...
) -&gt; Dict{Symbol, SpeedyWeather.AbstractCallback}
</code></pre><p>Create Callback dictionary like normal dictionaries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/callbacks.jl#L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.CallbackDict-Tuple{}" href="#SpeedyWeather.CallbackDict-Tuple{}"><code>SpeedyWeather.CallbackDict</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CallbackDict(

) -&gt; Dict{Symbol, SpeedyWeather.AbstractCallback}
</code></pre><p>Empty Callback dictionary generator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/callbacks.jl#L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DeviceArray-Tuple{CPU, Any}" href="#SpeedyWeather.DeviceArray-Tuple{CPU, Any}"><code>SpeedyWeather.DeviceArray</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DeviceArray(_::CPU, x) -&gt; Any
</code></pre><p>Adapts <code>x</code> to an <code>Array</code> when <code>device::CPU</code> is used. Define for <code>CPU</code> for compatibility with adapt to CuArrays etc. Uses <code>adapt</code>, thus also can return SubArrays etc.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/gpu.jl#L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Device_KernelAbstractions-Tuple{CPU}" href="#SpeedyWeather.Device_KernelAbstractions-Tuple{CPU}"><code>SpeedyWeather.Device_KernelAbstractions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Device_KernelAbstractions(
    _::CPU
) -&gt; Type{KernelAbstractions.CPU}
</code></pre><p>Return used device for use with KernelAbstractions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/gpu.jl#L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, Barotropic}" href="#SpeedyWeather.SpeedyTransforms.transform!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, Barotropic}"><code>SpeedyWeather.SpeedyTransforms.transform!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Integer,
    model::Barotropic;
    kwargs...
)
</code></pre><p>Propagate the spectral state of the prognostic variables <code>progn</code> to the diagnostic variables in <code>diagn</code> for the barotropic vorticity model. Updates grid vorticity, spectral stream function and spectral and grid velocities u, v.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L744">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, NoRandomProcess, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.transform!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, NoRandomProcess, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.transform!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Integer,
    random_process::NoRandomProcess,
    spectral_transform::SpectralTransform
)
</code></pre><p><code>NoRandomProcess</code> does not need to transform any random pattern from spectral to grid space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/random_process.jl#L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, PrimitiveEquation}" href="#SpeedyWeather.SpeedyTransforms.transform!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, PrimitiveEquation}"><code>SpeedyWeather.SpeedyTransforms.transform!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Integer,
    model::PrimitiveEquation;
    initialize
)
</code></pre><p>Propagate the spectral state of the prognostic variables <code>progn</code> to the diagnostic variables in <code>diagn</code> for primitive equation models. Updates grid vorticity, grid divergence, grid temperature, pressure (<code>pres_grid</code>) and the velocities u, v.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L828">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, ShallowWater}" href="#SpeedyWeather.SpeedyTransforms.transform!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, ShallowWater}"><code>SpeedyWeather.SpeedyTransforms.transform!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Integer,
    model::ShallowWater;
    kwargs...
)
</code></pre><p>Propagate the spectral state of the prognostic variables <code>progn</code> to the diagnostic variables in <code>diagn</code> for the shallow water model. Updates grid vorticity, grid divergence, grid interface displacement (<code>pres_grid</code>) and the velocities u, v.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L783">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, SpeedyWeather.AbstractRandomProcess, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.transform!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, SpeedyWeather.AbstractRandomProcess, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.transform!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Integer,
    random_process::SpeedyWeather.AbstractRandomProcess,
    spectral_transform::SpectralTransform
)
</code></pre><p>General transform for <code>random processes &lt;: AbstractRandomProcess</code>. Takes the spectral <code>random_pattern</code> in the prognostic variables and transforms it to spectral space in <code>diagn.grid.random_pattern</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/random_process.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.WhichZenith-Tuple{SpectralGrid, SpeedyWeather.AbstractPlanet}" href="#SpeedyWeather.WhichZenith-Tuple{SpectralGrid, SpeedyWeather.AbstractPlanet}"><code>SpeedyWeather.WhichZenith</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WhichZenith(
    SG::SpectralGrid,
    P::SpeedyWeather.AbstractPlanet;
    kwargs...
) -&gt; Union{SolarZenith, SolarZenithSeason}
</code></pre><p>Chooses from SolarZenith (daily and seasonal cycle) or SolarZenithSeason given the parameters in model.planet. In both cases the seasonal cycle can be disabled, calculating the solar declination from the initial time instead of current time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.activate!-Tuple{SpeedyWeather.AbstractSimulation, Vararg{Tracer}}" href="#SpeedyWeather.activate!-Tuple{SpeedyWeather.AbstractSimulation, Vararg{Tracer}}"><code>SpeedyWeather.activate!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">activate!(
    simulation::SpeedyWeather.AbstractSimulation,
    tracers::Tracer...
)
</code></pre><p>Activate a deactivated (=frozen) tracers in a simulation, which is a setting in <code>simulation.model</code> only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tracers.jl#L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.activate-Union{Tuple{Particle{NF}}, Tuple{NF}} where NF" href="#SpeedyWeather.activate-Union{Tuple{Particle{NF}}, Tuple{NF}} where NF"><code>SpeedyWeather.activate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">activate(
    p::Particle{NF}
) -&gt; Particle{_A, true} where _A&lt;:AbstractFloat
</code></pre><p>Activate particle. Active particles can move.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/particles.jl#L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.active-Union{Tuple{Particle{NF, isactive}}, Tuple{isactive}, Tuple{NF}} where {NF, isactive}" href="#SpeedyWeather.active-Union{Tuple{Particle{NF, isactive}}, Tuple{isactive}, Tuple{NF}} where {NF, isactive}"><code>SpeedyWeather.active</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">active(_::Particle{NF, isactive}) -&gt; Any
</code></pre><p>Check whether particle is active.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/particles.jl#L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add!-Tuple{AbstractModel, Vararg{Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}}}" href="#SpeedyWeather.add!-Tuple{AbstractModel, Vararg{Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}}}"><code>SpeedyWeather.add!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add!(
    model::AbstractModel,
    key_callbacks::Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}...
) -&gt; Any
</code></pre><p>Add a or several callbacks to a model::AbstractModel. To be used like</p><pre><code class="nohighlight hljs">add!(model, :my_callback =&gt; callback)
add!(model, :my_callback1 =&gt; callback, :my_callback2 =&gt; other_callback)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/callbacks.jl#L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add!-Tuple{AbstractModel, Vararg{SpeedyWeather.AbstractCallback}}" href="#SpeedyWeather.add!-Tuple{AbstractModel, Vararg{SpeedyWeather.AbstractCallback}}"><code>SpeedyWeather.add!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add!(
    model::AbstractModel,
    callbacks::SpeedyWeather.AbstractCallback...
)
</code></pre><p>Add a or several callbacks to a mdoel without specifying the key which is randomly created like callback_????. To be used like</p><pre><code class="nohighlight hljs">add!(model.callbacks, callback)
add!(model.callbacks, callback1, callback2).</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/callbacks.jl#L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add!-Tuple{AbstractModel, Vararg{SpeedyWeather.AbstractOutputVariable}}" href="#SpeedyWeather.add!-Tuple{AbstractModel, Vararg{SpeedyWeather.AbstractOutputVariable}}"><code>SpeedyWeather.add!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add!(
    model::AbstractModel,
    outputvariables::SpeedyWeather.AbstractOutputVariable...
) -&gt; Any
</code></pre><p>Add <code>outputvariables</code> to the dictionary in <code>output::NetCDFOutput</code> of <code>model</code>, i.e. at <code>model.output.variables</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add!-Tuple{Dict{Symbol, SpeedyWeather.AbstractCallback}, Vararg{Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}}}" href="#SpeedyWeather.add!-Tuple{Dict{Symbol, SpeedyWeather.AbstractCallback}, Vararg{Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}}}"><code>SpeedyWeather.add!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add!(
    D::Dict{Symbol, SpeedyWeather.AbstractCallback},
    key_callbacks::Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}...
)
</code></pre><p>Add a or several callbacks to a Dict{String, AbstractCallback} dictionary. To be used like</p><pre><code class="nohighlight hljs">add!(model.callbacks, :my_callback =&gt; callback)
add!(model.callbacks, :my_callback1 =&gt; callback, :my_callback2 =&gt; other_callback)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/callbacks.jl#L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add!-Tuple{Dict{Symbol, SpeedyWeather.AbstractCallback}, Vararg{SpeedyWeather.AbstractCallback}}" href="#SpeedyWeather.add!-Tuple{Dict{Symbol, SpeedyWeather.AbstractCallback}, Vararg{SpeedyWeather.AbstractCallback}}"><code>SpeedyWeather.add!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add!(
    D::Dict{Symbol, SpeedyWeather.AbstractCallback},
    callbacks::SpeedyWeather.AbstractCallback...;
    verbose
)
</code></pre><p>Add a or several callbacks to a Dict{Symbol, AbstractCallback} dictionary without specifying the key which is randomly created like callback_????. To be used like</p><pre><code class="nohighlight hljs">add!(model.callbacks, callback)
add!(model.callbacks, callback1, callback2).</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/callbacks.jl#L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add!-Tuple{Dict{Symbol, SpeedyWeather.AbstractOutputVariable}, Vararg{SpeedyWeather.AbstractOutputVariable}}" href="#SpeedyWeather.add!-Tuple{Dict{Symbol, SpeedyWeather.AbstractOutputVariable}, Vararg{SpeedyWeather.AbstractOutputVariable}}"><code>SpeedyWeather.add!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add!(
    D::Dict{Symbol, SpeedyWeather.AbstractOutputVariable},
    outputvariables::SpeedyWeather.AbstractOutputVariable...
) -&gt; Dict{Symbol, SpeedyWeather.AbstractOutputVariable}
</code></pre><p>Add <code>outputvariables</code> to a dictionary defining the variables subject to NetCDF output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add!-Tuple{NetCDFOutput, Vararg{SpeedyWeather.AbstractOutputVariable}}" href="#SpeedyWeather.add!-Tuple{NetCDFOutput, Vararg{SpeedyWeather.AbstractOutputVariable}}"><code>SpeedyWeather.add!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add!(
    output::NetCDFOutput,
    outputvariables::SpeedyWeather.AbstractOutputVariable...
) -&gt; NetCDFOutput
</code></pre><p>Add <code>outputvariables</code> to the dictionary in <code>output::NetCDFOutput</code>, i.e. at <code>output.variables</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add!-Union{Tuple{SpectralVariable3D}, Tuple{SpectralVariable2D}, Tuple{nsteps}, Tuple{ArrayType}, Tuple{NF}, Tuple{PrognosticVariables{NF, ArrayType, nsteps, SpectralVariable2D, SpectralVariable3D}, Vararg{Tracer}}} where {NF, ArrayType, nsteps, SpectralVariable2D, SpectralVariable3D}" href="#SpeedyWeather.add!-Union{Tuple{SpectralVariable3D}, Tuple{SpectralVariable2D}, Tuple{nsteps}, Tuple{ArrayType}, Tuple{NF}, Tuple{PrognosticVariables{NF, ArrayType, nsteps, SpectralVariable2D, SpectralVariable3D}, Vararg{Tracer}}} where {NF, ArrayType, nsteps, SpectralVariable2D, SpectralVariable3D}"><code>SpeedyWeather.add!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add!(
    progn::PrognosticVariables{NF, ArrayType, nsteps, SpectralVariable2D, SpectralVariable3D},
    tracers::Tracer...
)
</code></pre><p>Add <code>tracers</code> to the prognostic variables <code>progn</code> in <code>progn.tracers::Dict</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/prognostic_variables.jl#L309">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add_default!-Tuple{Dict{Symbol, SpeedyWeather.AbstractOutputVariable}, Type{&lt;:Barotropic}}" href="#SpeedyWeather.add_default!-Tuple{Dict{Symbol, SpeedyWeather.AbstractOutputVariable}, Type{&lt;:Barotropic}}"><code>SpeedyWeather.add_default!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_default!(
    output_variables::Dict{Symbol, SpeedyWeather.AbstractOutputVariable},
    Model::Type{&lt;:Barotropic}
) -&gt; Dict{Symbol, SpeedyWeather.AbstractOutputVariable}
</code></pre><p>Add default variables to output for a <code>Barotropic</code> model: Vorticity, zonal and meridional velocity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add_default!-Tuple{Dict{Symbol, SpeedyWeather.AbstractOutputVariable}, Type{&lt;:PrimitiveDry}}" href="#SpeedyWeather.add_default!-Tuple{Dict{Symbol, SpeedyWeather.AbstractOutputVariable}, Type{&lt;:PrimitiveDry}}"><code>SpeedyWeather.add_default!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_default!(
    variables::Dict{Symbol, SpeedyWeather.AbstractOutputVariable},
    Model::Type{&lt;:PrimitiveDry}
) -&gt; Dict{Symbol, SpeedyWeather.AbstractOutputVariable}
</code></pre><p>Add default variables to output for a <code>PrimitiveDry</code> model, same as for a <code>Barotropic</code> model but also the surface pressure and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add_default!-Tuple{Dict{Symbol, SpeedyWeather.AbstractOutputVariable}, Type{&lt;:PrimitiveWet}}" href="#SpeedyWeather.add_default!-Tuple{Dict{Symbol, SpeedyWeather.AbstractOutputVariable}, Type{&lt;:PrimitiveWet}}"><code>SpeedyWeather.add_default!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_default!(
    variables::Dict{Symbol, SpeedyWeather.AbstractOutputVariable},
    Model::Type{&lt;:PrimitiveWet}
) -&gt; Dict{Symbol, SpeedyWeather.AbstractOutputVariable}
</code></pre><p>Add default variables to output for a <code>PrimitiveWet</code> model, same as for a <code>PrimitiveDry</code> model but also the specific humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add_default!-Tuple{Dict{Symbol, SpeedyWeather.AbstractOutputVariable}, Type{&lt;:ShallowWater}}" href="#SpeedyWeather.add_default!-Tuple{Dict{Symbol, SpeedyWeather.AbstractOutputVariable}, Type{&lt;:ShallowWater}}"><code>SpeedyWeather.add_default!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_default!(
    variables::Dict{Symbol, SpeedyWeather.AbstractOutputVariable},
    Model::Type{&lt;:ShallowWater}
) -&gt; Dict{Symbol, SpeedyWeather.AbstractOutputVariable}
</code></pre><p>Add default variables to output for a <code>ShallowWater</code> model, same as for a <code>Barotropic</code> model but also the interface displacement.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.bernoulli_potential!-Tuple{DiagnosticVariables, SpectralTransform}" href="#SpeedyWeather.bernoulli_potential!-Tuple{DiagnosticVariables, SpectralTransform}"><code>SpeedyWeather.bernoulli_potential!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bernoulli_potential!(
    diagn::DiagnosticVariables,
    S::SpectralTransform
)
</code></pre><p>Computes the Laplace operator ∇² of the Bernoulli potential <code>B</code> in spectral space.</p><ol><li>computes the kinetic energy KE = ½(u²+v²) on the grid</li><li>transforms KE to spectral space</li><li>adds geopotential for the Bernoulli potential in spectral space</li><li>takes the Laplace operator.</li></ol><p>This version is used for both ShallowWater and PrimitiveEquation, only the geopotential calculation in geopotential! differs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L655">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.boundary_layer_drag!-Tuple{ColumnVariables, LinearDrag}" href="#SpeedyWeather.boundary_layer_drag!-Tuple{ColumnVariables, LinearDrag}"><code>SpeedyWeather.boundary_layer_drag!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">boundary_layer_drag!(
    column::ColumnVariables,
    scheme::LinearDrag
)
</code></pre><p>Compute tendency for boundary layer drag of a <code>column</code> and add to its tendencies fields</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/boundary_layer.jl#L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.bulk_richardson!-Tuple{ColumnVariables, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.bulk_richardson!-Tuple{ColumnVariables, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.bulk_richardson!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bulk_richardson!(
    column::ColumnVariables,
    atmosphere::SpeedyWeather.AbstractAtmosphere
) -&gt; Any
</code></pre><p>Calculate the bulk richardson number following Frierson, 2007. For vertical stability in the boundary layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/vertical_diffusion.jl#L210">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.bulk_richardson_surface-Tuple{ColumnVariables, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.bulk_richardson_surface-Tuple{ColumnVariables, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.bulk_richardson_surface</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bulk_richardson_surface(
    column::ColumnVariables,
    atmosphere::SpeedyWeather.AbstractAtmosphere
) -&gt; Any
</code></pre><p>Calculate the bulk richardson number following Frierson, 2007. For vertical stability in the boundary layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/boundary_layer.jl#L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.callback!-Tuple{GlobalSurfaceTemperatureCallback, PrognosticVariables, DiagnosticVariables, AbstractModel}" href="#SpeedyWeather.callback!-Tuple{GlobalSurfaceTemperatureCallback, PrognosticVariables, DiagnosticVariables, AbstractModel}"><code>SpeedyWeather.callback!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">callback!(
    callback::GlobalSurfaceTemperatureCallback,
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    model::AbstractModel
) -&gt; Any
</code></pre><p>Pulls the average temperature from the lowermost layer and stores it in the next element of the callback.temp vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/callbacks.jl#L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.clip_negatives!-Union{Tuple{AbstractArray{T}}, Tuple{T}} where T" href="#SpeedyWeather.clip_negatives!-Union{Tuple{AbstractArray{T}}, Tuple{T}} where T"><code>SpeedyWeather.clip_negatives!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">clip_negatives!(A::AbstractArray)</code></pre><p>Set all negative entries <code>a</code> in <code>A</code> to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/utility_functions.jl#L24-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.convection!-Union{Tuple{NF}, Tuple{ColumnVariables{NF}, DryBettsMiller, Geometry, SpeedyWeather.AbstractAtmosphere, PrimitiveEquation}} where NF" href="#SpeedyWeather.convection!-Union{Tuple{NF}, Tuple{ColumnVariables{NF}, DryBettsMiller, Geometry, SpeedyWeather.AbstractAtmosphere, PrimitiveEquation}} where NF"><code>SpeedyWeather.convection!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convection!(
    column::ColumnVariables{NF},
    DBM::DryBettsMiller,
    geometry::Geometry,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    model::PrimitiveEquation
)
</code></pre><p>calculates temperature tendency for the dry convection scheme following the simplified Betts-Miller convection from Frierson 2007 but with zero humidity. Starts with a first-guess relaxation to determine the convective criterion, then adjusts the reference profiles for thermodynamic consistency (e.g. in dry convection the humidity profile is non-precipitating), and relaxes current vertical profiles to the adjusted references.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/convection.jl#L332">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.convection!-Union{Tuple{NF}, Tuple{ColumnVariables{NF}, SimplifiedBettsMiller, SpeedyWeather.AbstractClausiusClapeyron, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractTimeStepper, PrimitiveWet}} where NF" href="#SpeedyWeather.convection!-Union{Tuple{NF}, Tuple{ColumnVariables{NF}, SimplifiedBettsMiller, SpeedyWeather.AbstractClausiusClapeyron, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractTimeStepper, PrimitiveWet}} where NF"><code>SpeedyWeather.convection!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convection!(
    column::ColumnVariables{NF},
    SBM::SimplifiedBettsMiller,
    clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron,
    geometry::Geometry,
    planet::SpeedyWeather.AbstractPlanet,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    time_stepping::SpeedyWeather.AbstractTimeStepper,
    model::PrimitiveWet
)
</code></pre><p>calculates temperature and humidity tendencies for the convection scheme following the simplified Betts-Miller convection. Starts with a first-guess relaxation to determine the convective criteria (none, dry/shallow or deep), then adjusts reference profiles for thermodynamic consistency (e.g. in dry convection the humidity profile is non-precipitating), and relaxes current vertical profiles to the adjusted references.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/convection.jl#L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.coriolis-Tuple{Grid} where Grid&lt;:AbstractGridArray" href="#SpeedyWeather.coriolis-Tuple{Grid} where Grid&lt;:AbstractGridArray"><code>SpeedyWeather.coriolis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">coriolis(grid::AbstractGridArray; kwargs...) -&gt; Any
</code></pre><p>Return the Coriolis parameter <code>f</code> on a grid like <code>grid</code> on a planet of <code>rotation</code> [1/s]. Default rotation of Earth.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/coriolis.jl#L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.coriolis-Union{Tuple{Grid}, Tuple{Type{Grid}, Integer, Vararg{Integer}}} where Grid&lt;:AbstractGridArray" href="#SpeedyWeather.coriolis-Union{Tuple{Grid}, Tuple{Type{Grid}, Integer, Vararg{Integer}}} where Grid&lt;:AbstractGridArray"><code>SpeedyWeather.coriolis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">coriolis(grid::AbstractGridArray; kwargs...) -&gt; Any
</code></pre><p>Return the Coriolis parameter <code>f</code> on the grid <code>Grid</code> of resolution <code>nlat_half</code> on a planet of <code>rotation</code> [1/s]. Default rotation of Earth.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/coriolis.jl#L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.cos_zenith!-Union{Tuple{NF}, Tuple{AbstractGrid{NF}, SolarZenith, DateTime, SpeedyWeather.AbstractGeometry}} where NF" href="#SpeedyWeather.cos_zenith!-Union{Tuple{NF}, Tuple{AbstractGrid{NF}, SolarZenith, DateTime, SpeedyWeather.AbstractGeometry}} where NF"><code>SpeedyWeather.cos_zenith!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cos_zenith!(
    cos_zenith::AbstractGridArray{NF, 1, Array{NF, 1}},
    S::SolarZenith,
    time::DateTime,
    geometry::SpeedyWeather.AbstractGeometry
)
</code></pre><p>Calculate cos of solar zenith angle with a daily cycle at time <code>time</code>. Seasonal cycle or time correction may be disabled, depending on parameters in SolarZenith.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.cos_zenith!-Union{Tuple{NF}, Tuple{AbstractGrid{NF}, SolarZenithSeason, DateTime, SpeedyWeather.AbstractGeometry}} where NF" href="#SpeedyWeather.cos_zenith!-Union{Tuple{NF}, Tuple{AbstractGrid{NF}, SolarZenithSeason, DateTime, SpeedyWeather.AbstractGeometry}} where NF"><code>SpeedyWeather.cos_zenith!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cos_zenith!(
    cos_zenith::AbstractGridArray{NF, 1, Array{NF, 1}},
    S::SolarZenithSeason,
    time::DateTime,
    geometry::SpeedyWeather.AbstractGeometry
)
</code></pre><p>Calculate cos of solar zenith angle as daily average at time <code>time</code>. Seasonal cycle or time correction may be disabled, depending on parameters in SolarZenithSeason.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L253">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.create_output_folder-Tuple{String, Union{Int64, String}}" href="#SpeedyWeather.create_output_folder-Tuple{String, Union{Int64, String}}"><code>SpeedyWeather.create_output_folder</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_output_folder(
    path::String,
    id::Union{Int64, String}
) -&gt; String
</code></pre><p>Creates a new folder <code>run_*</code> with the identification <code>id</code>. Also returns the full path <code>run_path</code> of that folder.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L470">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.deactivate!-Tuple{SpeedyWeather.AbstractSimulation, Vararg{Tracer}}" href="#SpeedyWeather.deactivate!-Tuple{SpeedyWeather.AbstractSimulation, Vararg{Tracer}}"><code>SpeedyWeather.deactivate!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">deactivate!(
    simulation::SpeedyWeather.AbstractSimulation,
    tracers::Tracer...
)
</code></pre><p>Deactivate a tracer in a simulation, which is a setting in <code>simulation.model</code> only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tracers.jl#L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.deactivate-Union{Tuple{Particle{NF}}, Tuple{NF}} where NF" href="#SpeedyWeather.deactivate-Union{Tuple{Particle{NF}}, Tuple{NF}} where NF"><code>SpeedyWeather.deactivate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">deactivate(
    p::Particle{NF}
) -&gt; Particle{_A, false} where _A&lt;:AbstractFloat
</code></pre><p>Deactivate particle. Inactive particles cannot move.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/particles.jl#L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.default_array_type-Tuple{SpeedyWeather.AbstractDevice}" href="#SpeedyWeather.default_array_type-Tuple{SpeedyWeather.AbstractDevice}"><code>SpeedyWeather.default_array_type</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_array_type(
    device::SpeedyWeather.AbstractDevice
) -&gt; Type{Array}
</code></pre><p>Default array type on <code>device</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/gpu.jl#L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.default_sigma_coordinates-Tuple{Integer}" href="#SpeedyWeather.default_sigma_coordinates-Tuple{Integer}"><code>SpeedyWeather.default_sigma_coordinates</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_sigma_coordinates(
    nlayers::Integer
) -&gt; Vector{Float64}
</code></pre><p>Vertical sigma coordinates defined by their nlayers+1 half levels <code>σ_levels_half</code>. Sigma coordinates are fraction of surface pressure (p/p0) and are sorted from top (stratosphere) to bottom (surface). The first half level is at 0 the last at 1. Default levels are equally spaced from 0 to 1 (including).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/vertical_coordinates.jl#L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.drag!-Tuple{DiagnosticVariables, PrognosticVariables, LinearVorticityDrag, Integer, AbstractModel}" href="#SpeedyWeather.drag!-Tuple{DiagnosticVariables, PrognosticVariables, LinearVorticityDrag, Integer, AbstractModel}"><code>SpeedyWeather.drag!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">drag!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    drag::LinearVorticityDrag,
    lf::Integer,
    model::AbstractModel
)
</code></pre><p>Linear drag for the vorticity equations of the form F = -cξ with c drag coefficient [1/s].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/drag.jl#L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.drag!-Tuple{DiagnosticVariables, PrognosticVariables, QuadraticDrag, Integer, AbstractModel}" href="#SpeedyWeather.drag!-Tuple{DiagnosticVariables, PrognosticVariables, QuadraticDrag, Integer, AbstractModel}"><code>SpeedyWeather.drag!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">drag!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    drag::QuadraticDrag,
    lf::Integer,
    model::AbstractModel
)
</code></pre><p>Quadratic drag for the momentum equations.</p><pre><code class="nohighlight hljs">F = -c_D/H*|(u, v)|*(u, v)</code></pre><p>with <code>c_D</code> the non-dimensional drag coefficient as defined in <code>drag::QuadraticDrag</code>. <code>c_D</code> and layer thickness <code>H</code> are precomputed in <code>initialize!(::QuadraticDrag, ::AbstractModel)</code> and scaled by the radius as are the momentum equations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/drag.jl#L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.dry_adiabat!-Tuple{AbstractVector, AbstractVector, Real, AbstractVector, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.dry_adiabat!-Tuple{AbstractVector, AbstractVector, Real, AbstractVector, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.dry_adiabat!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dry_adiabat!(
    temp_ref_profile::AbstractVector,
    temp_environment::AbstractVector,
    temp_parcel::Real,
    σ::AbstractVector,
    atmosphere::SpeedyWeather.AbstractAtmosphere
) -&gt; Int64
</code></pre><p>Calculates the moist pseudo adiabat given temperature and humidity of surface parcel. Follows the dry adiabat till condensation and then continues on the pseudo moist-adiabat with immediate condensation to the level of zero buoyancy. Levels above are skipped, set to NaN instead and should be skipped in the relaxation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/convection.jl#L391">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.dry_static_energy!-Tuple{ColumnVariables, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.dry_static_energy!-Tuple{ColumnVariables, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.dry_static_energy!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dry_static_energy!(
    column::ColumnVariables,
    atmosphere::SpeedyWeather.AbstractAtmosphere
)
</code></pre><p>Compute the dry static energy SE = cₚT + Φ (latent heat times temperature plus geopotential) for the column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.dynamics_tendencies!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, Barotropic}" href="#SpeedyWeather.dynamics_tendencies!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, Barotropic}"><code>SpeedyWeather.dynamics_tendencies!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dynamics_tendencies!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Integer,
    model::Barotropic
)
</code></pre><p>Calculate all tendencies for the BarotropicModel.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.dynamics_tendencies!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, PrimitiveEquation}" href="#SpeedyWeather.dynamics_tendencies!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, PrimitiveEquation}"><code>SpeedyWeather.dynamics_tendencies!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dynamics_tendencies!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Integer,
    model::PrimitiveEquation
)
</code></pre><p>Calculate all tendencies for the PrimitiveEquation model (wet or dry).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.dynamics_tendencies!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, ShallowWater}" href="#SpeedyWeather.dynamics_tendencies!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, ShallowWater}"><code>SpeedyWeather.dynamics_tendencies!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dynamics_tendencies!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Integer,
    model::ShallowWater
)
</code></pre><p>Calculate all tendencies for the ShallowWaterModel.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.finalize!-Tuple{Feedback}" href="#SpeedyWeather.finalize!-Tuple{Feedback}"><code>SpeedyWeather.finalize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">finalize!(F::Feedback)
</code></pre><p>Finalises the progress meter and the progress txt file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/feedback.jl#L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.finalize!-Tuple{SpeedyWeather.AbstractSimulation}" href="#SpeedyWeather.finalize!-Tuple{SpeedyWeather.AbstractSimulation}"><code>SpeedyWeather.finalize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">finalize!(
    simulation::SpeedyWeather.AbstractSimulation
) -&gt; Any
</code></pre><p>Finalize a <code>simulation</code>. Finishes the progress meter, unscales variables, finalizes the output, writes a restart file and finalizes callbacks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/simulation.jl#L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.first_timesteps!-Tuple{PrognosticVariables, DiagnosticVariables, AbstractModel}" href="#SpeedyWeather.first_timesteps!-Tuple{PrognosticVariables, DiagnosticVariables, AbstractModel}"><code>SpeedyWeather.first_timesteps!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">first_timesteps!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    model::AbstractModel
)
</code></pre><p>Performs the first two initial time steps (Euler forward, unfiltered leapfrog) to populate the prognostic variables with two time steps (t=0, Δt) that can then be used in the normal leap frogging.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/time_integration.jl#L217">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.flipsign!-Tuple{AbstractArray}" href="#SpeedyWeather.flipsign!-Tuple{AbstractArray}"><code>SpeedyWeather.flipsign!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flipgsign!(A::AbstractArray)</code></pre><p>Like <code>-A</code> but in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/utility_functions.jl#L45-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.flux_divergence!-Tuple{LowerTriangularArray, AbstractGridArray, DiagnosticVariables, Geometry, SpectralTransform}" href="#SpeedyWeather.flux_divergence!-Tuple{LowerTriangularArray, AbstractGridArray, DiagnosticVariables, Geometry, SpectralTransform}"><code>SpeedyWeather.flux_divergence!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flux_divergence!(
    A_tend::LowerTriangularArray,
    A_grid::AbstractGridArray,
    diagn::DiagnosticVariables,
    G::Geometry,
    S::SpectralTransform;
    add,
    flipsign
)
</code></pre><p>Computes ∇⋅((u, v)*A) with the option to add/overwrite <code>A_tend</code> and to <code>flip_sign</code> of the flux divergence by doing so.</p><ul><li><code>A_tend =  ∇⋅((u, v)*A)</code> for <code>add=false</code>, <code>flip_sign=false</code></li><li><code>A_tend = -∇⋅((u, v)*A)</code> for <code>add=false</code>, <code>flip_sign=true</code></li><li><code>A_tend += ∇⋅((u, v)*A)</code> for <code>add=true</code>, <code>flip_sign=false</code></li><li><code>A_tend -= ∇⋅((u, v)*A)</code> for <code>add=true</code>, <code>flip_sign=true</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L509">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.fluxes_to_tendencies!-Tuple{ColumnVariables, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.fluxes_to_tendencies!-Tuple{ColumnVariables, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.fluxes_to_tendencies!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fluxes_to_tendencies!(
    column::ColumnVariables,
    geometry::Geometry,
    planet::SpeedyWeather.AbstractPlanet,
    atmosphere::SpeedyWeather.AbstractAtmosphere
)
</code></pre><p>Convert the fluxes on half levels to tendencies on full levels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/tendencies.jl#L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.forcing!-Tuple{DiagnosticVariables, JetStreamForcing}" href="#SpeedyWeather.forcing!-Tuple{DiagnosticVariables, JetStreamForcing}"><code>SpeedyWeather.forcing!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">forcing!(
    diagn::DiagnosticVariables,
    forcing::JetStreamForcing
)
</code></pre><p>Set for every latitude ring the tendency to the precomputed forcing in the momentum equations following the JetStreamForcing. The forcing is precomputed in <code>initialize!(::JetStreamForcing, ::AbstractModel)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/forcing.jl#L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.geopotential!" href="#SpeedyWeather.geopotential!"><code>SpeedyWeather.geopotential!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">geopotential!(
    geopot::AbstractVector,
    temp::AbstractVector,
    G::Geopotential
)
geopotential!(
    geopot::AbstractVector,
    temp::AbstractVector,
    G::Geopotential,
    geopot_surf::Real
)
</code></pre><p>Calculate the geopotential based on <code>temp</code> in a single column. This exclues the surface geopotential that would need to be added to the returned vector. Function not used in the dynamical core but for post-processing and analysis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/geopotential.jl#L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.geopotential!-Tuple{DiagnosticVariables, Geopotential, SpeedyWeather.AbstractOrography}" href="#SpeedyWeather.geopotential!-Tuple{DiagnosticVariables, Geopotential, SpeedyWeather.AbstractOrography}"><code>SpeedyWeather.geopotential!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">geopotential!(
    diagn::DiagnosticVariables,
    geopotential::Geopotential,
    orography::SpeedyWeather.AbstractOrography
)
</code></pre><p>Compute spectral geopotential <code>geopot</code> from spectral temperature <code>temp</code> and spectral surface geopotential <code>geopot_surf</code> (orography*gravity).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/geopotential.jl#L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.geopotential!-Tuple{DiagnosticVariables, LowerTriangularArray, SpeedyWeather.AbstractPlanet}" href="#SpeedyWeather.geopotential!-Tuple{DiagnosticVariables, LowerTriangularArray, SpeedyWeather.AbstractPlanet}"><code>SpeedyWeather.geopotential!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">geopotential!(
    diagn::DiagnosticVariables,
    pres::LowerTriangularArray,
    planet::SpeedyWeather.AbstractPlanet
)
</code></pre><p>calculates the geopotential in the ShallowWaterModel as g*η, i.e. gravity times the interface displacement (field <code>pres</code>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/geopotential.jl#L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_column!-Tuple{ColumnVariables, DiagnosticVariables, PrognosticVariables, Int64, PrimitiveEquation}" href="#SpeedyWeather.get_column!-Tuple{ColumnVariables, DiagnosticVariables, PrognosticVariables, Int64, PrimitiveEquation}"><code>SpeedyWeather.get_column!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Recalculate ring index if not provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/column_variables.jl#L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_column!-Tuple{ColumnVariables, DiagnosticVariables, PrognosticVariables, Integer, Integer, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractOrography, SpeedyWeather.AbstractLandSeaMask, SpeedyWeather.AbstractImplicit}" href="#SpeedyWeather.get_column!-Tuple{ColumnVariables, DiagnosticVariables, PrognosticVariables, Integer, Integer, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractOrography, SpeedyWeather.AbstractLandSeaMask, SpeedyWeather.AbstractImplicit}"><code>SpeedyWeather.get_column!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_column!(
    C::ColumnVariables,
    D::DiagnosticVariables,
    P::PrognosticVariables,
    ij::Integer,
    jring::Integer,
    geometry::Geometry,
    planet::SpeedyWeather.AbstractPlanet,
    orography::SpeedyWeather.AbstractOrography,
    land_sea_mask::SpeedyWeather.AbstractLandSeaMask,
    implicit::SpeedyWeather.AbstractImplicit
) -&gt; Any
</code></pre><p>Update <code>C::ColumnVariables</code> by copying the prognostic variables from <code>D::DiagnosticVariables</code> at gridpoint index <code>ij</code>. Provide <code>G::Geometry</code> for coordinate information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/column_variables.jl#L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_full_output_file_path-Tuple{SpeedyWeather.AbstractOutput}" href="#SpeedyWeather.get_full_output_file_path-Tuple{SpeedyWeather.AbstractOutput}"><code>SpeedyWeather.get_full_output_file_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_full_output_file_path(
    output::SpeedyWeather.AbstractOutput
) -&gt; String
</code></pre><p>Returns the full path of the output file after it was created.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L486">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_run_id-Tuple{String, String}" href="#SpeedyWeather.get_run_id-Tuple{String, String}"><code>SpeedyWeather.get_run_id</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_run_id(path::String, id::String) -&gt; String
</code></pre><p>Checks existing <code>run_????</code> folders in <code>path</code> to determine a 4-digit <code>id</code> number by counting up. E.g. if folder run_0001 exists it will return the string &quot;0002&quot;. Does not create a folder for the returned run id.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L443">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_thermodynamics!-Tuple{ColumnVariables, PrimitiveEquation}" href="#SpeedyWeather.get_thermodynamics!-Tuple{ColumnVariables, PrimitiveEquation}"><code>SpeedyWeather.get_thermodynamics!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_thermodynamics!(
    column::ColumnVariables,
    model::PrimitiveEquation
)
</code></pre><p>Calculate geopotentiala and dry static energy for the primitive equation model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_Δt_millisec" href="#SpeedyWeather.get_Δt_millisec"><code>SpeedyWeather.get_Δt_millisec</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_Δt_millisec(
    Δt_at_T31::Dates.TimePeriod,
    trunc,
    radius,
    adjust_with_output::Bool
) -&gt; Any
get_Δt_millisec(
    Δt_at_T31::Dates.TimePeriod,
    trunc,
    radius,
    adjust_with_output::Bool,
    output_dt::Dates.TimePeriod
) -&gt; Any
</code></pre><p>Computes the time step in [ms]. <code>Δt_at_T31</code> is always scaled with the resolution <code>trunc</code>  of the model. In case <code>adjust_Δt_with_output</code> is true, the <code>Δt_at_T31</code> is additionally  adjusted to the closest divisor of <code>output_dt</code> so that the output time axis is keeping <code>output_dt</code> exactly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/time_integration.jl#L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.grad-Union{Tuple{NF}, Tuple{ClausiusClapeyron{NF}, NF}} where NF" href="#SpeedyWeather.grad-Union{Tuple{NF}, Tuple{ClausiusClapeyron{NF}, NF}} where NF"><code>SpeedyWeather.grad</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">grad(CC::ClausiusClapeyron{NF}, temp_kelvin) -&gt; Any
</code></pre><p>Gradient of Clausius-Clapeyron wrt to temperature, evaluated at <code>temp_kelvin</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.grad-Union{Tuple{NF}, Tuple{TetensEquation{NF}, NF}} where NF" href="#SpeedyWeather.grad-Union{Tuple{NF}, Tuple{TetensEquation{NF}, NF}} where NF"><code>SpeedyWeather.grad</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">grad(
    TetensCoefficients::TetensEquation{NF},
    temp_kelvin
) -&gt; Any
</code></pre><p>Gradient of the Tetens equation wrt to temperature, evaluated at <code>temp_kelvin</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.grad_saturation_humidity-Union{Tuple{NF}, Tuple{ClausiusClapeyron{NF}, NF, NF}} where NF" href="#SpeedyWeather.grad_saturation_humidity-Union{Tuple{NF}, Tuple{ClausiusClapeyron{NF}, NF, NF}} where NF"><code>SpeedyWeather.grad_saturation_humidity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">grad_saturation_humidity(
    CC::ClausiusClapeyron{NF},
    temp_kelvin,
    pres
) -&gt; Any
</code></pre><p>Gradient of Clausius-Clapeyron wrt to temperature, evaluated at <code>temp_kelvin</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.has-Tuple{Type{&lt;:AbstractModel}, Symbol}" href="#SpeedyWeather.has-Tuple{Type{&lt;:AbstractModel}, Symbol}"><code>SpeedyWeather.has</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">has(Model::Type{&lt;:AbstractModel}, var_name::Symbol) -&gt; Any
</code></pre><p>Returns true if the model <code>M</code> has a prognostic variable <code>var_name</code>, false otherwise. The default fallback is that all variables are included. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/abstract_models.jl#L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.horizontal_diffusion!" href="#SpeedyWeather.horizontal_diffusion!"><code>SpeedyWeather.horizontal_diffusion!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">horizontal_diffusion!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    diffusion::SpeedyWeather.AbstractHorizontalDiffusion,
    model::ShallowWater
)
horizontal_diffusion!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    diffusion::SpeedyWeather.AbstractHorizontalDiffusion,
    model::ShallowWater,
    lf::Integer
)
</code></pre><p>Apply horizontal diffusion to vorticity and divergence in the ShallowWaterModel.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/horizontal_diffusion.jl#L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.horizontal_diffusion!" href="#SpeedyWeather.horizontal_diffusion!"><code>SpeedyWeather.horizontal_diffusion!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">horizontal_diffusion!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    diffusion::SpeedyWeather.AbstractHorizontalDiffusion,
    model::Barotropic
)
horizontal_diffusion!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    diffusion::SpeedyWeather.AbstractHorizontalDiffusion,
    model::Barotropic,
    lf::Integer
)
</code></pre><p>Apply horizontal diffusion to vorticity in the BarotropicModel.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/horizontal_diffusion.jl#L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.horizontal_diffusion!" href="#SpeedyWeather.horizontal_diffusion!"><code>SpeedyWeather.horizontal_diffusion!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">horizontal_diffusion!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    diffusion::SpeedyWeather.AbstractHorizontalDiffusion,
    model::PrimitiveEquation
)
horizontal_diffusion!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    diffusion::SpeedyWeather.AbstractHorizontalDiffusion,
    model::PrimitiveEquation,
    lf::Integer
)
</code></pre><p>Apply horizontal diffusion applied to vorticity, divergence, temperature, and humidity (PrimitiveWet only) in the PrimitiveEquation models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/horizontal_diffusion.jl#L206">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.horizontal_diffusion!-Tuple{LowerTriangularArray, LowerTriangularArray, AbstractMatrix, AbstractMatrix}" href="#SpeedyWeather.horizontal_diffusion!-Tuple{LowerTriangularArray, LowerTriangularArray, AbstractMatrix, AbstractMatrix}"><code>SpeedyWeather.horizontal_diffusion!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">horizontal_diffusion!(
    tendency::LowerTriangularArray,
    var::LowerTriangularArray,
    expl::AbstractMatrix,
    impl::AbstractMatrix
)
</code></pre><p>Apply horizontal diffusion to a 2D field <code>var</code> in spectral space by updating its tendency <code>tendency</code> with an implicitly calculated diffusion term. The implicit diffusion of the next time step is split into an explicit part <code>expl</code> and an implicit part <code>impl</code>, such that both can be calculated in a single forward step by using <code>var</code> as well as its tendency <code>tendency</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/horizontal_diffusion.jl#L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.implicit_correction!-Tuple{DiagnosticVariables, ImplicitPrimitiveEquation, PrognosticVariables}" href="#SpeedyWeather.implicit_correction!-Tuple{DiagnosticVariables, ImplicitPrimitiveEquation, PrognosticVariables}"><code>SpeedyWeather.implicit_correction!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">implicit_correction!(
    diagn::DiagnosticVariables,
    implicit::ImplicitPrimitiveEquation,
    progn::PrognosticVariables
)
</code></pre><p>Apply the implicit corrections to dampen gravity waves in the primitive equation models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/implicit.jl#L289">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.implicit_correction!-Tuple{DiagnosticVariables, PrognosticVariables, ImplicitShallowWater}" href="#SpeedyWeather.implicit_correction!-Tuple{DiagnosticVariables, PrognosticVariables, ImplicitShallowWater}"><code>SpeedyWeather.implicit_correction!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">implicit_correction!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    implicit::ImplicitShallowWater
)
</code></pre><p>Apply correction to the tendencies in <code>diagn</code> to prevent the gravity waves from amplifying. The correction is implicitly evaluated using the parameter <code>implicit.α</code> to switch between forward, centered implicit or backward evaluation of the gravity wave terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/implicit.jl#L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{AquaPlanetMask, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{AquaPlanetMask, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    land_sea_mask::AquaPlanetMask,
    model::PrimitiveEquation
)
</code></pre><p>Sets all grid points to 0 = sea.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/land_sea_mask.jl#L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Barotropic}" href="#SpeedyWeather.initialize!-Tuple{Barotropic}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    model::Barotropic;
    time
) -&gt; Simulation{Model} where Model&lt;:Barotropic
</code></pre><p>Calls all <code>initialize!</code> functions for most fields, representing components, of <code>model</code>, except for <code>model.output</code> and <code>model.feedback</code> which are always called at in <code>time_stepping!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/barotropic.jl#L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Clock, Dates.Period, Dates.Period}" href="#SpeedyWeather.initialize!-Tuple{Clock, Dates.Period, Dates.Period}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    clock::Clock,
    Δt::Dates.Period,
    period::Dates.Period
) -&gt; Clock
</code></pre><p>Initialize the clock with the time step <code>Δt</code> and <code>period</code> to integrate for.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/clock.jl#L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Clock, Dates.Period, Integer}" href="#SpeedyWeather.initialize!-Tuple{Clock, Dates.Period, Integer}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    clock::Clock,
    Δt::Dates.Period,
    n_timesteps::Integer
) -&gt; Clock
</code></pre><p>Initialize the clock with the time step <code>Δt</code> and the number of time steps <code>n_timesteps</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/clock.jl#L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Clock, SpeedyWeather.AbstractTimeStepper, Vararg{Any}}" href="#SpeedyWeather.initialize!-Tuple{Clock, SpeedyWeather.AbstractTimeStepper, Vararg{Any}}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    clock::Clock,
    time_stepping::SpeedyWeather.AbstractTimeStepper,
    args...
) -&gt; Any
</code></pre><p>Initialize the clock with the time step <code>Δt</code> from <code>time_stepping</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/clock.jl#L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Clock}" href="#SpeedyWeather.initialize!-Tuple{Clock}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(clock::Clock) -&gt; Clock
</code></pre><p>Initialize the clock with setting the start time and resetting the timestep counter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/clock.jl#L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{EarthLandSeaMask, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{EarthLandSeaMask, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    land_sea_mask::EarthLandSeaMask,
    model::PrimitiveEquation
) -&gt; AbstractArray
</code></pre><p>Reads a high-resolution land-sea mask from file and interpolates (grid-cell average) onto the model grid for a fractional sea mask.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/land_sea_mask.jl#L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{EarthOrography, SpeedyWeather.AbstractPlanet, SpectralTransform}" href="#SpeedyWeather.initialize!-Tuple{EarthOrography, SpeedyWeather.AbstractPlanet, SpectralTransform}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    orog::EarthOrography,
    P::SpeedyWeather.AbstractPlanet,
    S::SpectralTransform
)
</code></pre><p>Initialize the arrays <code>orography</code>, <code>geopot_surf</code> in <code>orog</code> by reading the orography field from file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/orography.jl#L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Feedback, Clock, AbstractModel}" href="#SpeedyWeather.initialize!-Tuple{Feedback, Clock, AbstractModel}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    feedback::Feedback,
    clock::Clock,
    model::AbstractModel
) -&gt; ProgressMeter.Progress
</code></pre><p>Initializes the a <code>Feedback</code> struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/feedback.jl#L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Geopotential, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{Geopotential, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    geopotential::Geopotential,
    model::PrimitiveEquation
)
</code></pre><p>Precomputes constants for the vertical integration of the geopotential, defined as</p><p><code>Φ_{k+1/2} = Φ_{k+1} + R*T_{k+1}*(ln(p_{k+1}) - ln(p_{k+1/2}))</code> (half levels) <code>Φ_k = Φ_{k+1/2} + R*T_k*(ln(p_{k+1/2}) - ln(p_k))</code> (full levels)</p><p>Same formula but <code>k → k-1/2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/geopotential.jl#L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{HeldSuarez, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{HeldSuarez, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(scheme::HeldSuarez, model::PrimitiveEquation)
</code></pre><p>initialize the HeldSuarez temperature relaxation by precomputing terms for the equilibrium temperature Teq.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/temperature_relaxation.jl#L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{HyperDiffusion, AbstractModel}" href="#SpeedyWeather.initialize!-Tuple{HyperDiffusion, AbstractModel}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(diffusion::HyperDiffusion, model::AbstractModel)
</code></pre><p>Precomputes the hyper diffusion terms in <code>diffusion</code> based on the model time step, and possibly with a changing strength/power in the vertical.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/horizontal_diffusion.jl#L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{HyperDiffusion, SpeedyWeather.AbstractGeometry, SpeedyWeather.AbstractTimeStepper}" href="#SpeedyWeather.initialize!-Tuple{HyperDiffusion, SpeedyWeather.AbstractGeometry, SpeedyWeather.AbstractTimeStepper}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    diffusion::HyperDiffusion,
    G::SpeedyWeather.AbstractGeometry,
    L::SpeedyWeather.AbstractTimeStepper
)
</code></pre><p>Precomputes the hyper diffusion terms for all layers based on the model time step in <code>L</code>, the vertical level sigma level in <code>G</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/horizontal_diffusion.jl#L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{ImplicitShallowWater, Real, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.initialize!-Tuple{ImplicitShallowWater, Real, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    implicit::ImplicitShallowWater,
    dt::Real,
    planet::SpeedyWeather.AbstractPlanet,
    atmosphere::SpeedyWeather.AbstractAtmosphere
) -&gt; Any
</code></pre><p>Update the implicit terms in <code>implicit</code> for the shallow water model as they depend on the time step <code>dt</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/implicit.jl#L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{JLD2Output, SpeedyWeather.AbstractFeedback, PrognosticVariables, DiagnosticVariables, AbstractModel}" href="#SpeedyWeather.initialize!-Tuple{JLD2Output, SpeedyWeather.AbstractFeedback, PrognosticVariables, DiagnosticVariables, AbstractModel}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    output::JLD2Output,
    feedback::SpeedyWeather.AbstractFeedback,
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    model::AbstractModel
)
</code></pre><p>Initialize JLD2 <code>output</code> by creating a JLD2 file.  To be called just before the first timesteps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/jld2_output.jl#L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{JablonowskiRelaxation, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{JablonowskiRelaxation, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    scheme::JablonowskiRelaxation,
    model::PrimitiveEquation
)
</code></pre><p>initialize the JablonowskiRelaxation temperature relaxation by precomputing terms for the equilibrium temperature Teq and the frequency (strength of relaxation).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/temperature_relaxation.jl#L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Leapfrog, AbstractModel}" href="#SpeedyWeather.initialize!-Tuple{Leapfrog, AbstractModel}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(L::Leapfrog, model::AbstractModel)
</code></pre><p>Initialize leapfrogging <code>L</code> by recalculating the timestep given the output time step <code>output_dt</code> from <code>model.output</code>. Recalculating will slightly adjust the time step to be a divisor such that an integer number of time steps matches exactly with the output time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/time_integration.jl#L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{LinearDrag, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{LinearDrag, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(scheme::LinearDrag, model::PrimitiveEquation)
</code></pre><p>Precomputes the drag coefficients for this <code>BoundaryLayerDrag</code> scheme.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/boundary_layer.jl#L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{PrimitiveDry}" href="#SpeedyWeather.initialize!-Tuple{PrimitiveDry}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    model::PrimitiveDry;
    time
) -&gt; Simulation{Model} where Model&lt;:PrimitiveDry
</code></pre><p>Calls all <code>initialize!</code> functions for components of <code>model</code>, except for <code>model.output</code> and <code>model.feedback</code> which are always called at in <code>time_stepping!</code> and <code>model.implicit</code> which is done in <code>first_timesteps!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/primitive_dry.jl#L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{PrimitiveWet}" href="#SpeedyWeather.initialize!-Tuple{PrimitiveWet}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    model::PrimitiveWet;
    time
) -&gt; Simulation{Model} where Model&lt;:PrimitiveWet
</code></pre><p>Calls all <code>initialize!</code> functions for components of <code>model</code>, except for <code>model.output</code> and <code>model.feedback</code> which are always called at in <code>time_stepping!</code> and <code>model.implicit</code> which is done in <code>first_timesteps!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/primitive_wet.jl#L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{PrognosticVariables, PressureOnOrography, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{PrognosticVariables, PressureOnOrography, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables,
    _::PressureOnOrography,
    model::PrimitiveEquation
)
</code></pre><p>Initialize surface pressure on orography by integrating the hydrostatic equation with the reference temperature lapse rate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L585">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{PrognosticVariables, RossbyHaurwitzWave, AbstractModel}" href="#SpeedyWeather.initialize!-Tuple{PrognosticVariables, RossbyHaurwitzWave, AbstractModel}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables,
    initial_conditions::RossbyHaurwitzWave,
    model::AbstractModel
)
</code></pre><p>Rossby-Haurwitz wave initial conditions as in Williamson et al. 1992, J Computational Physics with an additional cut-off amplitude <code>c</code> to filter out tiny harmonics in the vorticity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L388">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{PrognosticVariables, StartFromFile, AbstractModel}" href="#SpeedyWeather.initialize!-Tuple{PrognosticVariables, StartFromFile, AbstractModel}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn_new::PrognosticVariables,
    initial_conditions::StartFromFile,
    model::AbstractModel
)
</code></pre><p>Restart from a previous SpeedyWeather.jl simulation via the restart file restart.jld2 Applies interpolation in the horizontal but not in the vertical.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L524">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{PrognosticVariables, ZonalJet, AbstractModel}" href="#SpeedyWeather.initialize!-Tuple{PrognosticVariables, ZonalJet, AbstractModel}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables,
    initial_conditions::ZonalJet,
    model::AbstractModel
)
</code></pre><p>Initial conditions from Galewsky, 2004, Tellus</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{RockyPlanetMask, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{RockyPlanetMask, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    land_sea_mask::RockyPlanetMask,
    model::PrimitiveEquation
)
</code></pre><p>Sets all grid points to 1 = land.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/land_sea_mask.jl#L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Schedule, Clock}" href="#SpeedyWeather.initialize!-Tuple{Schedule, Clock}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(scheduler::Schedule, clock::Clock) -&gt; Schedule
</code></pre><p>Initialize a Schedule with a Clock (which is assumed to have been initialized). Takes both scheduler.every and scheduler.times into account, such that both periodic and events can be scheduled simulataneously. But execution will happen only once if they coincide on a given time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/schedule.jl#L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{ShallowWater}" href="#SpeedyWeather.initialize!-Tuple{ShallowWater}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    model::ShallowWater;
    time
) -&gt; Simulation{Model} where Model&lt;:ShallowWater
</code></pre><p>Calls all <code>initialize!</code> functions for most components (=fields) of <code>model</code>, except for <code>model.output</code> and <code>model.feedback</code> which are always initialized in <code>time_stepping!</code> and <code>model.implicit</code> which is done in <code>first_timesteps!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/shallow_water.jl#L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{SpeedyWeather.AbstractSimulation}" href="#SpeedyWeather.initialize!-Tuple{SpeedyWeather.AbstractSimulation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    simulation::SpeedyWeather.AbstractSimulation;
    period,
    steps,
    output
) -&gt; Any
</code></pre><p>Initializes a <code>simulation</code>. Scales the variables, initializes the output, stores initial conditions, initializes the progress meter feedback, callbacks and performs the first two initial time steps to spin up the leapfrogging scheme.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/simulation.jl#L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{ZonalRidge, SpeedyWeather.AbstractPlanet, SpectralTransform, Geometry}" href="#SpeedyWeather.initialize!-Tuple{ZonalRidge, SpeedyWeather.AbstractPlanet, SpectralTransform, Geometry}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    orog::ZonalRidge,
    P::SpeedyWeather.AbstractPlanet,
    S::SpectralTransform,
    G::Geometry
)
</code></pre><p>Initialize the arrays <code>orography</code>, <code>geopot_surf</code> in <code>orog</code> following  Jablonowski and Williamson, 2006.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/orography.jl#L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{Interpolator}, Tuple{Grid3D}, Tuple{Grid2D}, Tuple{NetCDFOutput{Grid2D, Grid3D, Interpolator}, SpeedyWeather.AbstractFeedback, PrognosticVariables, DiagnosticVariables, AbstractModel}} where {Grid2D, Grid3D, Interpolator}" href="#SpeedyWeather.initialize!-Union{Tuple{Interpolator}, Tuple{Grid3D}, Tuple{Grid2D}, Tuple{NetCDFOutput{Grid2D, Grid3D, Interpolator}, SpeedyWeather.AbstractFeedback, PrognosticVariables, DiagnosticVariables, AbstractModel}} where {Grid2D, Grid3D, Interpolator}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    output::NetCDFOutput{Grid2D, Grid3D, Interpolator},
    feedback::SpeedyWeather.AbstractFeedback,
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    model::AbstractModel
)
</code></pre><p>Initialize NetCDF <code>output</code> by creating a netCDF file and storing the initial conditions of <code>diagn</code> (and <code>progn</code>). To be called just before the first timesteps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L207">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{Array{Particle{NF}, 1}, PrognosticVariables, DiagnosticVariables, ParticleAdvection2D}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{Array{Particle{NF}, 1}, PrognosticVariables, DiagnosticVariables, ParticleAdvection2D}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    particles::Array{Particle{NF}, 1},
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    particle_advection::ParticleAdvection2D
) -&gt; Any
</code></pre><p>Initialize particle advection time integration: Store u,v interpolated initial conditions in <code>diagn.particles.u</code> and <code>.v</code>  to be used when particle advection actually executed for first time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/particle_advection.jl#L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{GlobalSurfaceTemperatureCallback{NF}, PrognosticVariables, DiagnosticVariables, AbstractModel}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{GlobalSurfaceTemperatureCallback{NF}, PrognosticVariables, DiagnosticVariables, AbstractModel}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    callback::GlobalSurfaceTemperatureCallback{NF},
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    model::AbstractModel
) -&gt; Int64
</code></pre><p>Initializes callback.temp vector that records the global mean surface temperature on every time step. Allocates vector of correct length (number of elements = total time steps plus one) and stores the global surface temperature of the initial conditions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/callbacks.jl#L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{ImplicitPrimitiveEquation, Real, DiagnosticVariables{NF}, SpeedyWeather.AbstractGeometry, SpeedyWeather.AbstractGeopotential, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractAdiabaticConversion}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{ImplicitPrimitiveEquation, Real, DiagnosticVariables{NF}, SpeedyWeather.AbstractGeometry, SpeedyWeather.AbstractGeopotential, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractAdiabaticConversion}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    implicit::ImplicitPrimitiveEquation,
    dt::Real,
    diagn::DiagnosticVariables{NF},
    geometry::SpeedyWeather.AbstractGeometry,
    geopotential::SpeedyWeather.AbstractGeopotential,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    adiabatic_conversion::SpeedyWeather.AbstractAdiabaticConversion
)
</code></pre><p>Initialize the implicit terms for the PrimitiveEquation models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/implicit.jl#L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF}, JablonowskiTemperature, PrimitiveEquation}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF}, JablonowskiTemperature, PrimitiveEquation}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables{NF},
    initial_conditions::JablonowskiTemperature,
    model::PrimitiveEquation
)
</code></pre><p>Initial conditions from Jablonowski and Williamson, 2006, QJR Meteorol. Soc</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L454">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF}, RandomVelocity, Barotropic}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF}, RandomVelocity, Barotropic}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables{NF},
    initial_conditions::RandomVelocity,
    model::Barotropic
)
</code></pre><p>Start with random vorticity as initial conditions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF}, RandomVorticity, Barotropic}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF}, RandomVorticity, Barotropic}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables{NF},
    initial_conditions::RandomVorticity,
    model::Barotropic
)
</code></pre><p>Start with random vorticity as initial conditions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF}, RandomWaves, ShallowWater}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF}, RandomWaves, ShallowWater}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables{NF},
    initial_conditions::RandomWaves,
    model::ShallowWater
)
</code></pre><p>Random initial conditions for the interface displacement η in the shallow water equations. The flow (u, v) is zero initially. This kicks off gravity waves that will interact with orography.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L688">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF}, ZonalWind, PrimitiveEquation}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF}, ZonalWind, PrimitiveEquation}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables{NF},
    initial_conditions::ZonalWind,
    model::PrimitiveEquation
)
</code></pre><p>Initial conditions from Jablonowski and Williamson, 2006, QJR Meteorol. Soc</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/initial_conditions.jl#L315">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{P}, Tuple{Vector{P}, AbstractModel}} where P&lt;:Particle" href="#SpeedyWeather.initialize!-Union{Tuple{P}, Tuple{Vector{P}, AbstractModel}} where P&lt;:Particle"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize!(
    particles::Array{P&lt;:Particle, 1},
    model::AbstractModel
)
</code></pre><p>Initialize particle locations uniformly in latitude, longitude and in the vertical σ coordinates. This uses a cosin-distribution in latitude for an equal-area uniformity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/particle_advection.jl#L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.isdecreasing-Tuple{AbstractVector}" href="#SpeedyWeather.isdecreasing-Tuple{AbstractVector}"><code>SpeedyWeather.isdecreasing</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isdecreasing(v::AbstractVector) -&gt; Bool
</code></pre><p>Check whether elements of a vector <code>v</code> are strictly decreasing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/utility_functions.jl#L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.isincreasing-Tuple{AbstractVector}" href="#SpeedyWeather.isincreasing-Tuple{AbstractVector}"><code>SpeedyWeather.isincreasing</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isincreasing(v::AbstractVector) -&gt; Bool
</code></pre><p>Check whether elements of a vector <code>v</code> are strictly increasing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/utility_functions.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ismod-Tuple{Particle}" href="#SpeedyWeather.ismod-Tuple{Particle}"><code>SpeedyWeather.ismod</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ismod(p::Particle) -&gt; Bool
</code></pre><p>Check that a particle is in longitude [0,360˚E), latitude [-90˚,90˚N], and σ in [0,1].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/particles.jl#L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.isscheduled-Tuple{Schedule, Clock}" href="#SpeedyWeather.isscheduled-Tuple{Schedule, Clock}"><code>SpeedyWeather.isscheduled</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isscheduled(S::Schedule, clock::Clock) -&gt; Bool
</code></pre><p>Evaluate whether (e.g. a callback) should be scheduled at the timestep given in clock. Returns true for scheduled executions, false for no execution on this time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/schedule.jl#L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.large_scale_condensation!-Tuple{ColumnVariables, ImplicitCondensation, SpeedyWeather.AbstractClausiusClapeyron, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractTimeStepper}" href="#SpeedyWeather.large_scale_condensation!-Tuple{ColumnVariables, ImplicitCondensation, SpeedyWeather.AbstractClausiusClapeyron, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractTimeStepper}"><code>SpeedyWeather.large_scale_condensation!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">large_scale_condensation!(
    column::ColumnVariables,
    scheme::ImplicitCondensation,
    clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron,
    geometry::Geometry,
    planet::SpeedyWeather.AbstractPlanet,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    time_stepping::SpeedyWeather.AbstractTimeStepper
)
</code></pre><p>Large-scale condensation for a <code>column</code> by relaxation back to 100% relative humidity. Calculates the tendencies for specific humidity and temperature from latent heat release and integrates the large-scale precipitation vertically for output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/large_scale_condensation.jl#L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.launch_kernel!-Tuple{SpeedyWeather.DeviceSetup, Any, Any, Vararg{Any}}" href="#SpeedyWeather.launch_kernel!-Tuple{SpeedyWeather.DeviceSetup, Any, Any, Vararg{Any}}"><code>SpeedyWeather.launch_kernel!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">launch_kernel!(
    device_setup::SpeedyWeather.DeviceSetup,
    kernel!,
    ndrange,
    kernel_args...
)
</code></pre><p>Launches the <code>kernel!</code> on the <code>device_setup</code> with <code>ndrange</code> computations over the kernel and arguments <code>kernel_args</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/gpu.jl#L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.leapfrog!-Union{Tuple{NF}, Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, Real, Int64, Leapfrog{NF}}} where NF" href="#SpeedyWeather.leapfrog!-Union{Tuple{NF}, Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, Real, Int64, Leapfrog{NF}}} where NF"><code>SpeedyWeather.leapfrog!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">leapfrog!(
    A_old::LowerTriangularArray,
    A_new::LowerTriangularArray,
    tendency::LowerTriangularArray,
    dt::Real,
    lf::Int64,
    L::Leapfrog{NF}
)
</code></pre><p>Performs one leapfrog time step with (<code>lf=2</code>) or without (<code>lf=1</code>) Robert+Williams filter (see Williams (2009), Montly Weather Review, Eq. 7-9).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/time_integration.jl#L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.linear_pressure_gradient!-Tuple{DiagnosticVariables, PrognosticVariables, Int64, SpeedyWeather.AbstractAtmosphere, ImplicitPrimitiveEquation}" href="#SpeedyWeather.linear_pressure_gradient!-Tuple{DiagnosticVariables, PrognosticVariables, Int64, SpeedyWeather.AbstractAtmosphere, ImplicitPrimitiveEquation}"><code>SpeedyWeather.linear_pressure_gradient!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linear_pressure_gradient!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Int64,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    implicit::ImplicitPrimitiveEquation
)
</code></pre><p>Add the linear contribution of the pressure gradient to the geopotential. The pressure gradient in the divergence equation takes the form</p><pre><code class="nohighlight hljs">-∇⋅(Rd * Tᵥ * ∇lnpₛ) = -∇⋅(Rd * Tᵥ&#39; * ∇lnpₛ) - ∇²(Rd * Tₖ * lnpₛ)</code></pre><p>So that the second term inside the Laplace operator can be added to the geopotential. Rd is the gas constant, Tᵥ the virtual temperature and Tᵥ&#39; its anomaly wrt to the average or reference temperature Tₖ, lnpₛ is the logarithm of surface pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L683">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.linear_virtual_temperature!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, PrimitiveDry}" href="#SpeedyWeather.linear_virtual_temperature!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, PrimitiveDry}"><code>SpeedyWeather.linear_virtual_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linear_virtual_temperature!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Integer,
    model::PrimitiveDry
) -&gt; Any
</code></pre><p>Linear virtual temperature for <code>model::PrimitiveDry</code>: Just copy over arrays from <code>temp</code> to <code>temp_virt</code> at timestep <code>lf</code> in spectral space as humidity is zero in this <code>model</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/virtual_temperature.jl#L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.linear_virtual_temperature!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, PrimitiveEquation}" href="#SpeedyWeather.linear_virtual_temperature!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, PrimitiveEquation}"><code>SpeedyWeather.linear_virtual_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linear_virtual_temperature!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Integer,
    model::PrimitiveEquation
) -&gt; Any
</code></pre><p>Calculates a linearised virtual temperature Tᵥ as</p><pre><code class="nohighlight hljs">Tᵥ = T + Tₖμq</code></pre><p>With absolute temperature T, layer-average temperarture Tₖ (computed in <code>temperature_average!</code>), specific humidity q and</p><pre><code class="nohighlight hljs">μ = (1-ξ)/ξ, ξ = R_dry/R_vapour.</code></pre><p>in spectral space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/virtual_temperature.jl#L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.load_trajectory-Tuple{Union{String, Symbol}, AbstractModel}" href="#SpeedyWeather.load_trajectory-Tuple{Union{String, Symbol}, AbstractModel}"><code>SpeedyWeather.load_trajectory</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_trajectory(
    var_name::Union{String, Symbol},
    model::AbstractModel
) -&gt; Any
</code></pre><p>Loads a <code>var_name</code> trajectory of the model <code>M</code> that has been saved in a netCDF file during the time stepping.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L492">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.merge_output-Tuple{JLD2Output}" href="#SpeedyWeather.merge_output-Tuple{JLD2Output}"><code>SpeedyWeather.merge_output</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge_output(output::JLD2Output)
</code></pre><p>We can&#39;t directly push to arrays in a JLD2 file or have extendable  dimensions. This routine rewrites the file to a single vector.  Might be turned off if the file doesn&#39;t fit into the memory or speed  is a concern. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/jld2_output.jl#L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.moist_static_energy!-Tuple{ColumnVariables, SpeedyWeather.AbstractClausiusClapeyron}" href="#SpeedyWeather.moist_static_energy!-Tuple{ColumnVariables, SpeedyWeather.AbstractClausiusClapeyron}"><code>SpeedyWeather.moist_static_energy!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">moist_static_energy!(
    column::ColumnVariables,
    clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron
)
</code></pre><p>Compute the moist static energy</p><pre><code class="nohighlight hljs">MSE = SE + Lc*Q = cₚT + Φ + Lc*Q</code></pre><p>with the static energy <code>SE</code>, the latent heat of condensation <code>Lc</code>, the geopotential <code>Φ</code>. As well as the saturation moist static energy which replaces Q with Q_sat</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.move-Union{Tuple{NF}, Tuple{Particle{NF, false}, Vararg{Any}}} where NF" href="#SpeedyWeather.move-Union{Tuple{NF}, Tuple{Particle{NF, false}, Vararg{Any}}} where NF"><code>SpeedyWeather.move</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">move(
    p::Particle{NF, false},
    args...
) -&gt; Particle{NF, false} where NF
</code></pre><p>Inactive particles are not moved.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/particles.jl#L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.move-Union{Tuple{NF}, Tuple{Particle{NF, true}, Any, Any, Any}} where NF" href="#SpeedyWeather.move-Union{Tuple{NF}, Tuple{Particle{NF, true}, Any, Any, Any}} where NF"><code>SpeedyWeather.move</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">move(
    p::Particle{NF, true},
    dlon,
    dlat,
    dσ
) -&gt; Particle{_A, true} where _A&lt;:AbstractFloat
</code></pre><p>Move a particle with increments (dlon, dlat, dσ) in those respective coordinates. Only active particles are moved.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/particles.jl#L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.move-Union{Tuple{NF}, Tuple{Particle{NF, true}, Any, Any}} where NF" href="#SpeedyWeather.move-Union{Tuple{NF}, Tuple{Particle{NF, true}, Any, Any}} where NF"><code>SpeedyWeather.move</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">move(
    p::Particle{NF, true},
    dlon,
    dlat
) -&gt; Particle{_A, true} where _A&lt;:AbstractFloat
</code></pre><p>Move a particle with increments (dlon, dlat) in 2D. No movement in vertical σ. Only active particles are moved.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/particles.jl#L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.nans-Tuple" href="#SpeedyWeather.nans-Tuple"><code>SpeedyWeather.nans</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">A = nans(dims...)</code></pre><p>Allocate <code>A::Array{Float64}</code> with NaNs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/utility_functions.jl#L64-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.nans-Union{Tuple{T}, Tuple{Type{T}, Vararg{Any}}} where T" href="#SpeedyWeather.nans-Union{Tuple{T}, Tuple{Type{T}, Vararg{Any}}} where T"><code>SpeedyWeather.nans</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">A = nans(T, dims...)</code></pre><p>Allocate array A with NaNs of type T. Similar to <code>zeros(T, dims...)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/utility_functions.jl#L56-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.nar_detection!-Tuple{Feedback, PrognosticVariables}" href="#SpeedyWeather.nar_detection!-Tuple{Feedback, PrognosticVariables}"><code>SpeedyWeather.nar_detection!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nar_detection!(
    feedback::Feedback,
    progn::PrognosticVariables
) -&gt; Union{Nothing, Bool}
</code></pre><p>Detect NaR (Not-a-Real) in the prognostic variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/feedback.jl#L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.output!-Tuple{NetCDFOutput, DateTime}" href="#SpeedyWeather.output!-Tuple{NetCDFOutput, DateTime}"><code>SpeedyWeather.output!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">output!(output::NetCDFOutput, time::DateTime)
</code></pre><p>Write the current time <code>time::DateTime</code> to the netCDF file in <code>output</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L375">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.output!-Tuple{NetCDFOutput, Dict{Symbol, SpeedyWeather.AbstractOutputVariable}, SpeedyWeather.AbstractSimulation}" href="#SpeedyWeather.output!-Tuple{NetCDFOutput, Dict{Symbol, SpeedyWeather.AbstractOutputVariable}, SpeedyWeather.AbstractSimulation}"><code>SpeedyWeather.output!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">output!(
    output::NetCDFOutput,
    output_variables::Dict{Symbol, SpeedyWeather.AbstractOutputVariable},
    simulation::SpeedyWeather.AbstractSimulation
)
</code></pre><p>Loop over every variable in <code>output.variables</code> to call the respective <code>output!</code> method to write into the <code>output.netcdf_file</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L394">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.output!-Tuple{NetCDFOutput, SpeedyWeather.AbstractOutputVariable, SpeedyWeather.AbstractSimulation}" href="#SpeedyWeather.output!-Tuple{NetCDFOutput, SpeedyWeather.AbstractOutputVariable, SpeedyWeather.AbstractSimulation}"><code>SpeedyWeather.output!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">output!(
    output::NetCDFOutput,
    variable::SpeedyWeather.AbstractOutputVariable,
    simulation::SpeedyWeather.AbstractSimulation
)
</code></pre><p>Output a <code>variable</code> into the netCDF file <code>output.netcdf_file</code>. Interpolates onto the output grid and resolution as specified in <code>output</code>. Method used for all output variables <code>&lt;: AbstractOutputVariable</code> with dispatch over the second argument. Interpolates, scales, custom transform, bitrounding and writes to file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L335">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.output!-Tuple{NetCDFOutput, SpeedyWeather.AbstractSimulation}" href="#SpeedyWeather.output!-Tuple{NetCDFOutput, SpeedyWeather.AbstractSimulation}"><code>SpeedyWeather.output!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">output!(
    output::NetCDFOutput,
    simulation::SpeedyWeather.AbstractSimulation
)
</code></pre><p>Writes the variables from <code>progn</code> or <code>diagn</code> of time step <code>i</code> at time <code>time</code> into <code>output.netcdf_file</code>. Simply escapes for no netcdf output or if output shouldn&#39;t be written on this time step. Interpolates onto output grid and resolution as specified in <code>output</code>, converts to output number format, truncates the mantissa for higher compression and applies lossless compression.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/netcdf_output.jl#L308">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.parameterization_tendencies!-Tuple{ColumnVariables, PrognosticVariables, PrimitiveEquation}" href="#SpeedyWeather.parameterization_tendencies!-Tuple{ColumnVariables, PrognosticVariables, PrimitiveEquation}"><code>SpeedyWeather.parameterization_tendencies!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parameterization_tendencies!(
    column::ColumnVariables,
    progn::PrognosticVariables,
    model::PrimitiveEquation
)
</code></pre><p>Calls for <code>column</code> one physics parameterization after another and convert fluxes to tendencies.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/tendencies.jl#L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.parameterization_tendencies!-Tuple{DiagnosticVariables, PrognosticVariables, DateTime, PrimitiveEquation}" href="#SpeedyWeather.parameterization_tendencies!-Tuple{DiagnosticVariables, PrognosticVariables, DateTime, PrimitiveEquation}"><code>SpeedyWeather.parameterization_tendencies!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parameterization_tendencies!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    time::DateTime,
    model::PrimitiveEquation
)
</code></pre><p>Compute tendencies for u, v, temp, humid from physical parametrizations. Extract for each vertical atmospheric column the prognostic variables (stored in <code>diagn</code> as they are grid-point transformed), loop over all grid-points, compute all parametrizations on a single-column basis, then write the tendencies back into a horizontal field of tendencies.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/tendencies.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.path-Tuple{SpeedyWeather.VorticityOutput, Any}" href="#SpeedyWeather.path-Tuple{SpeedyWeather.VorticityOutput, Any}"><code>SpeedyWeather.path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">path(_::SpeedyWeather.VorticityOutput, simulation) -&gt; Any
</code></pre><p>To be extended for every output variable to define the path where in <code>simulation</code> to find that output variable <code>::AbstractGridArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/variables/dynamics.jl#L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.physics_tendencies_only!-Tuple{DiagnosticVariables, PrimitiveEquation}" href="#SpeedyWeather.physics_tendencies_only!-Tuple{DiagnosticVariables, PrimitiveEquation}"><code>SpeedyWeather.physics_tendencies_only!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">physics_tendencies_only!(
    diagn::DiagnosticVariables,
    model::PrimitiveEquation
)
</code></pre><p>For dynamics=false, after calling parameterization_tendencies! call this function to transform the physics tendencies from grid-point to spectral space including the necessary coslat⁻¹ scaling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L353">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.pressure_gradient_flux!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, SpectralTransform}" href="#SpeedyWeather.pressure_gradient_flux!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, SpectralTransform}"><code>SpeedyWeather.pressure_gradient_flux!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pressure_gradient_flux!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Integer,
    S::SpectralTransform
)
</code></pre><p>Compute the gradient ∇lnp<em>s of the logarithm of surface pressure, followed by its flux, (u,v) * ∇lnp</em>s.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.print_fields-Tuple{IO, Any, Any}" href="#SpeedyWeather.print_fields-Tuple{IO, Any, Any}"><code>SpeedyWeather.print_fields</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">print_fields(io::IO, A, keys; arrays)
</code></pre><p>Prints to <code>io</code> all fields of a struct <code>A</code> identified by their <code>keys</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/utility_functions.jl#L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.progress!-Tuple{Feedback}" href="#SpeedyWeather.progress!-Tuple{Feedback}"><code>SpeedyWeather.progress!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">progress!(feedback::Feedback)
</code></pre><p>Calls the progress meter and writes every 5% progress increase to txt.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/feedback.jl#L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.pseudo_adiabat!-Union{Tuple{NF}, Tuple{AbstractVector, NF, Real, AbstractVector, AbstractVector, Real, AbstractVector, SpeedyWeather.AbstractClausiusClapeyron}} where NF" href="#SpeedyWeather.pseudo_adiabat!-Union{Tuple{NF}, Tuple{AbstractVector, NF, Real, AbstractVector, AbstractVector, Real, AbstractVector, SpeedyWeather.AbstractClausiusClapeyron}} where NF"><code>SpeedyWeather.pseudo_adiabat!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pseudo_adiabat!(
    temp_ref_profile::AbstractVector,
    temp_parcel,
    humid_parcel::Real,
    temp_virt_environment::AbstractVector,
    geopot::AbstractVector,
    pres::Real,
    σ::AbstractVector,
    clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron
) -&gt; Int64
</code></pre><p>Calculates the moist pseudo adiabat given temperature and humidity of surface parcel. Follows the dry adiabat till condensation and then continues on the pseudo moist-adiabat with immediate condensation to the level of zero buoyancy. Levels above are skipped, set to NaN instead and should be skipped in the relaxation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/convection.jl#L211">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.readable_secs-Tuple{Real}" href="#SpeedyWeather.readable_secs-Tuple{Real}"><code>SpeedyWeather.readable_secs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readable_secs(secs::Real) -&gt; Dates.CompoundPeriod
</code></pre><p>Returns <code>Dates.CompoundPeriod</code> rounding to either (days, hours), (hours, minutes), (minutes, seconds), or seconds with 1 decimal place accuracy for &gt;10s and two for less. E.g.</p><pre><code class="language- hljs">julia&gt; using SpeedyWeather: readable_secs

julia&gt; readable_secs(12345)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/feedback.jl#L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.remaining_time-Tuple{ProgressMeter.Progress}" href="#SpeedyWeather.remaining_time-Tuple{ProgressMeter.Progress}"><code>SpeedyWeather.remaining_time</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">remaining_time(p::ProgressMeter.Progress) -&gt; String
</code></pre><p>Estimates the remaining time from a <code>ProgresssMeter.Progress</code>. Adapted from ProgressMeter.jl</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/feedback.jl#L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.reset_column!-Union{Tuple{ColumnVariables{NF}}, Tuple{NF}} where NF" href="#SpeedyWeather.reset_column!-Union{Tuple{ColumnVariables{NF}}, Tuple{NF}} where NF"><code>SpeedyWeather.reset_column!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reset_column!(column::ColumnVariables{NF})
</code></pre><p>Set the accumulators (tendencies but also vertical sums and similar) back to zero for <code>column</code> to be reused at other grid points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/column_variables.jl#L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.run!-Tuple{SpeedyWeather.AbstractSimulation}" href="#SpeedyWeather.run!-Tuple{SpeedyWeather.AbstractSimulation}"><code>SpeedyWeather.run!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run!(
    simulation::SpeedyWeather.AbstractSimulation;
    period,
    steps,
    output
) -&gt; Union{UnicodePlots.Plot{T, Val{true}} where T&lt;:UnicodePlots.HeatmapCanvas, UnicodePlots.Plot{T, Val{false}} where T&lt;:UnicodePlots.HeatmapCanvas}
</code></pre><p>Run a SpeedyWeather.jl <code>simulation</code>. The <code>simulation.model</code> is assumed to be initialized.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/simulation.jl#L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.saturation_humidity!-Tuple{ColumnVariables, SpeedyWeather.AbstractClausiusClapeyron}" href="#SpeedyWeather.saturation_humidity!-Tuple{ColumnVariables, SpeedyWeather.AbstractClausiusClapeyron}"><code>SpeedyWeather.saturation_humidity!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">saturation_humidity!(
    column::ColumnVariables,
    clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron
)
</code></pre><p>Compute the saturation water vapour pressure [Pa], the saturation humidity [kg/kg] and the relative humidity following <code>clausius_clapeyron</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.saturation_humidity-Union{Tuple{NF}, Tuple{NF, NF, SpeedyWeather.AbstractClausiusClapeyron}} where NF" href="#SpeedyWeather.saturation_humidity-Union{Tuple{NF}, Tuple{NF, NF, SpeedyWeather.AbstractClausiusClapeyron}} where NF"><code>SpeedyWeather.saturation_humidity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">saturation_humidity(
    temp_kelvin,
    pres,
    clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron
) -&gt; Any
</code></pre><p>Saturation humidity [kg/kg] from temperature [K], pressure [Pa] via</p><pre><code class="nohighlight hljs">sat_vap_pres = clausius_clapeyron(temperature)
saturation humidity = mol_ratio * sat_vap_pres / pressure</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.saturation_humidity-Union{Tuple{NF}, Tuple{NF, NF}} where NF" href="#SpeedyWeather.saturation_humidity-Union{Tuple{NF}, Tuple{NF, NF}} where NF"><code>SpeedyWeather.saturation_humidity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">saturation_humidity(sat_vap_pres, pres; mol_ratio) -&gt; Any
</code></pre><p>Saturation humidity from saturation vapour pressure and pressure via</p><pre><code class="nohighlight hljs">qsat = mol_ratio*sat_vap_pres/pres</code></pre><p>with both pressures in same units and qsat in kg/kg.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/thermodynamics.jl#L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.scale!-Tuple{DiagnosticVariables, Symbol, Real}" href="#SpeedyWeather.scale!-Tuple{DiagnosticVariables, Symbol, Real}"><code>SpeedyWeather.scale!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scale!(
    diagn::DiagnosticVariables,
    var::Symbol,
    scale::Real
) -&gt; Any
</code></pre><p>Scale the variable <code>var</code> inside <code>diagn</code> with scalar <code>scale</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/scaling.jl#L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.scale!-Tuple{PrognosticVariables, DiagnosticVariables, Real}" href="#SpeedyWeather.scale!-Tuple{PrognosticVariables, DiagnosticVariables, Real}"><code>SpeedyWeather.scale!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scale!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    scale::Real
) -&gt; Real
</code></pre><p>Scales the prognostic variables vorticity and divergence with the Earth&#39;s radius which is used in the dynamical core.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/scaling.jl#L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.scale!-Tuple{PrognosticVariables, Symbol, Real}" href="#SpeedyWeather.scale!-Tuple{PrognosticVariables, Symbol, Real}"><code>SpeedyWeather.scale!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scale!(progn::PrognosticVariables, var::Symbol, scale::Real)
</code></pre><p>Scale the variable <code>var</code> inside <code>progn</code> with scalar <code>scale</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/scaling.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set!-Tuple{AbstractModel}" href="#SpeedyWeather.set!-Tuple{AbstractModel}"><code>SpeedyWeather.set!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set!(
    model::AbstractModel;
    orography,
    land_sea_mask,
    kwargs...
)
</code></pre><p>Sets a boundary condition fields for <code>model</code>. The input can be a function, <code>RingGrid</code>, <code>LowerTriangularMatrix</code>,  or scalar as for other <code>set!</code> functions. If the keyword <code>add==true</code> the input is added to the exisiting  field instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/set.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set!-Tuple{PrognosticVariables, Geometry}" href="#SpeedyWeather.set!-Tuple{PrognosticVariables, Geometry}"><code>SpeedyWeather.set!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set!(
    progn::PrognosticVariables,
    geometry::Geometry;
    u,
    v,
    vor,
    div,
    temp,
    humid,
    pres,
    sea_surface_temperature,
    sea_ice_concentration,
    soil_temperature,
    snow_depth,
    soil_moisture,
    lf,
    add,
    spectral_transform,
    coslat_scaling_included,
    kwargs...
)
</code></pre><p>Sets new values for the keyword arguments (velocities, vorticity, divergence, etc..) into the prognostic variable struct <code>progn</code> at timestep index <code>lf</code>. If <code>add==true</code> they are added to the  current value instead. If a <code>SpectralTransform</code> S is provided, it is used when needed to set  the variable, otherwise it is recomputed. In case <code>u</code> and <code>v</code> are provied, actually the divergence and vorticity are set and <code>coslat_scaling_included</code> specficies whether or not the 1/cos(lat)  scaling is already included in the arrays or not (default: <code>false</code>)</p><p>The input may be:</p><ul><li>A function or callable object <code>f(lond, latd, σ) -&gt; value</code> (multilevel variables) </li><li>A function or callable object <code>f(lond, latd) -&gt; value</code> (surface level variables)</li><li>An instance of <code>AbstractGridArray</code> </li><li>An instance of <code>LowerTriangularArray</code> </li><li>A scalar <code>&lt;: Number</code> (interpreted as a constant field in grid space)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/set.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set!-Tuple{SpeedyWeather.AbstractSimulation}" href="#SpeedyWeather.set!-Tuple{SpeedyWeather.AbstractSimulation}"><code>SpeedyWeather.set!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set!(S::SpeedyWeather.AbstractSimulation; kwargs...) -&gt; Any
</code></pre><p>Sets properties of the simuluation <code>S</code>. Convenience wrapper to call the other concrete  <code>set!</code> methods. All <code>kwargs</code> are forwarded to these methods, which are documented  seperately. See their documentation for possible <code>kwargs</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/set.jl#L319">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set!-Tuple{SpeedyWeather.AbstractTimeStepper, Dates.Period}" href="#SpeedyWeather.set!-Tuple{SpeedyWeather.AbstractTimeStepper, Dates.Period}"><code>SpeedyWeather.set!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set!(
    L::SpeedyWeather.AbstractTimeStepper,
    Δt::Dates.Period
) -&gt; SpeedyWeather.AbstractTimeStepper
</code></pre><p>Change time step of timestepper <code>L</code> to <code>Δt</code> (unscaled) and disables adjustment to output frequency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/time_integration.jl#L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.sigma_okay-Tuple{Integer, AbstractVector}" href="#SpeedyWeather.sigma_okay-Tuple{Integer, AbstractVector}"><code>SpeedyWeather.sigma_okay</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sigma_okay(nlayers::Integer, σ_half::AbstractVector) -&gt; Bool
</code></pre><p>Check that nlayers and σ_half match.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/vertical_coordinates.jl#L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.solar_hour_angle-Union{Tuple{T}, Tuple{Type{T}, DateTime, Any, Second}} where T" href="#SpeedyWeather.solar_hour_angle-Union{Tuple{T}, Tuple{Type{T}, DateTime, Any, Second}} where T"><code>SpeedyWeather.solar_hour_angle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">solar_hour_angle(
    _::Type{T},
    time::DateTime,
    λ,
    length_of_day::Second
) -&gt; Any
</code></pre><p>Fraction of day as angle in radians [0...2π]. TODO: Takes length of day as argument, but a call to Dates.Time() currently have this hardcoded anyway.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.speedstring-Tuple{Any, Any}" href="#SpeedyWeather.speedstring-Tuple{Any, Any}"><code>SpeedyWeather.speedstring</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">speedstring(sec_per_iter, dt_in_sec) -&gt; String
</code></pre><p>Define a ProgressMeter.speedstring method that also takes a time step <code>dt_in_sec</code> to translate sec/iteration to days/days-like speeds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/feedback.jl#L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.surface_pressure_tendency!-Tuple{DiagnosticVariables, SpectralTransform}" href="#SpeedyWeather.surface_pressure_tendency!-Tuple{DiagnosticVariables, SpectralTransform}"><code>SpeedyWeather.surface_pressure_tendency!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">surface_pressure_tendency!( Prog::PrognosticVariables,
                            Diag::DiagnosticVariables,
                            lf::Int,
                            M::PrimitiveEquation)</code></pre><p>Computes the tendency of the logarithm of surface pressure as</p><pre><code class="nohighlight hljs">-(ū*px + v̄*py) - D̄</code></pre><p>with ū, v̄ being the vertically averaged velocities; px, py the gradients of the logarithm of surface pressure ln(p_s) and D̄ the vertically averaged divergence.</p><ol><li>Calculate ∇ln(p_s) in spectral space, convert to grid.</li><li>Multiply ū, v̄ with ∇ln(p_s) in grid-point space, convert to spectral.</li><li>D̄ is subtracted in spectral space.</li><li>Set tendency of the l=m=0 mode to 0 for better mass conservation.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L210-L225">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.temperature_anomaly!-Tuple{DiagnosticVariables, ImplicitPrimitiveEquation}" href="#SpeedyWeather.temperature_anomaly!-Tuple{DiagnosticVariables, ImplicitPrimitiveEquation}"><code>SpeedyWeather.temperature_anomaly!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">temperature_anomaly!(
    diagn::DiagnosticVariables,
    implicit::ImplicitPrimitiveEquation
)
</code></pre><p>Convert absolute and virtual temperature to anomalies wrt to the reference profile</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.temperature_average!-Tuple{DiagnosticVariables, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.temperature_average!-Tuple{DiagnosticVariables, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.temperature_average!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">temperature_average!(
    diagn::DiagnosticVariables,
    temp::LowerTriangularArray,
    S::SpectralTransform
)
</code></pre><p>Calculates the average temperature of a layer from the l=m=0 harmonic and stores the result in <code>diagn.temp_average</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L924-L928">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.temperature_relaxation!-Tuple{ColumnVariables, HeldSuarez, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.temperature_relaxation!-Tuple{ColumnVariables, HeldSuarez, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.temperature_relaxation!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">temperature_relaxation!(
    column::ColumnVariables,
    scheme::HeldSuarez,
    atmosphere::SpeedyWeather.AbstractAtmosphere
)
</code></pre><p>Apply temperature relaxation following Held and Suarez 1996, BAMS.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/temperature_relaxation.jl#L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.temperature_relaxation!-Tuple{ColumnVariables, JablonowskiRelaxation}" href="#SpeedyWeather.temperature_relaxation!-Tuple{ColumnVariables, JablonowskiRelaxation}"><code>SpeedyWeather.temperature_relaxation!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">temperature_relaxation!(
    column::ColumnVariables,
    scheme::JablonowskiRelaxation
)
</code></pre><p>Apply HeldSuarez-like temperature relaxation to the Jablonowski and Williamson vertical profile.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/temperature_relaxation.jl#L232">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.temperature_tendency!-Tuple{DiagnosticVariables, SpeedyWeather.AbstractAdiabaticConversion, SpeedyWeather.AbstractAtmosphere, ImplicitPrimitiveEquation, Geometry, SpectralTransform}" href="#SpeedyWeather.temperature_tendency!-Tuple{DiagnosticVariables, SpeedyWeather.AbstractAdiabaticConversion, SpeedyWeather.AbstractAtmosphere, ImplicitPrimitiveEquation, Geometry, SpectralTransform}"><code>SpeedyWeather.temperature_tendency!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">temperature_tendency!(
    diagn::DiagnosticVariables,
    adiabatic_conversion::SpeedyWeather.AbstractAdiabaticConversion,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    implicit::ImplicitPrimitiveEquation,
    G::Geometry,
    S::SpectralTransform
)
</code></pre><p>Compute the temperature tendency</p><pre><code class="nohighlight hljs">∂T/∂t += -∇⋅((u, v)*T&#39;) + T&#39;D + κTᵥ*Dlnp/Dt</code></pre><p><code>+=</code> because the tendencies already contain parameterizations and vertical advection. <code>T&#39;</code> is the anomaly with respect to the reference/average temperature. Tᵥ is the virtual temperature used in the adiabatic term κTᵥ*Dlnp/Dt.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L394">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.time_stepping!-Tuple{SpeedyWeather.AbstractSimulation}" href="#SpeedyWeather.time_stepping!-Tuple{SpeedyWeather.AbstractSimulation}"><code>SpeedyWeather.time_stepping!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">time_stepping!(simulation::SpeedyWeather.AbstractSimulation)
</code></pre><p>Main time loop that loops over all time steps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/time_integration.jl#L387">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.timestep!" href="#SpeedyWeather.timestep!"><code>SpeedyWeather.timestep!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    dt::Real,
    model::ShallowWater
) -&gt; Union{Nothing, Bool}
timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    dt::Real,
    model::ShallowWater,
    lf1::Integer
) -&gt; Union{Nothing, Bool}
timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    dt::Real,
    model::ShallowWater,
    lf1::Integer,
    lf2::Integer
) -&gt; Union{Nothing, Bool}
</code></pre><p>Calculate a single time step for the <code>model &lt;: ShallowWater</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/time_integration.jl#L290">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.timestep!" href="#SpeedyWeather.timestep!"><code>SpeedyWeather.timestep!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    dt::Real,
    model::PrimitiveEquation
) -&gt; Union{Nothing, Bool}
timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    dt::Real,
    model::PrimitiveEquation,
    lf1::Integer
) -&gt; Union{Nothing, Bool}
timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    dt::Real,
    model::PrimitiveEquation,
    lf1::Integer,
    lf2::Integer
) -&gt; Union{Nothing, Bool}
</code></pre><p>Calculate a single time step for the <code>model&lt;:PrimitiveEquation</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/time_integration.jl#L320">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.timestep!" href="#SpeedyWeather.timestep!"><code>SpeedyWeather.timestep!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    dt::Real,
    model::Barotropic
) -&gt; Union{Nothing, Bool}
timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    dt::Real,
    model::Barotropic,
    lf1::Integer
) -&gt; Union{Nothing, Bool}
timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    dt::Real,
    model::Barotropic,
    lf1::Integer,
    lf2::Integer
) -&gt; Union{Nothing, Bool}
</code></pre><p>Calculate a single time step for the barotropic model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/time_integration.jl#L264">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.timestep!-Tuple{SpeedyWeather.AbstractSimulation}" href="#SpeedyWeather.timestep!-Tuple{SpeedyWeather.AbstractSimulation}"><code>SpeedyWeather.timestep!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">timestep!(
    simulation::SpeedyWeather.AbstractSimulation
) -&gt; Any
</code></pre><p>Perform one single time step of <code>simulation</code> including possibly output and callbacks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/time_integration.jl#L364">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.tree-Tuple{AbstractModel}" href="#SpeedyWeather.tree-Tuple{AbstractModel}"><code>SpeedyWeather.tree</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tree(M::AbstractModel; modules, with_size, kwargs...)
</code></pre><p>Create a tree of fields inside a model and fields within these fields as long as they are defined within the modules argument (default SpeedyWeather). Other keyword arguments are <code>max_level::Integer=10</code>, <code>with_types::Bool=false</code> or <code>with_size::Bool=false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/tree.jl#L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.tree-Tuple{Any}" href="#SpeedyWeather.tree-Tuple{Any}"><code>SpeedyWeather.tree</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tree(S; modules, with_size, kwargs...)
</code></pre><p>Create a tree of fields inside S and fields within these fields as long as they are defined within the modules argument (default SpeedyWeather). Other keyword arguments are <code>max_level::Integer=10</code>, <code>with_types::Bool=false</code> or <code>with_size::Bool=false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/tree.jl#L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.tree-Union{Tuple{Simulation{M}}, Tuple{M}} where M" href="#SpeedyWeather.tree-Union{Tuple{Simulation{M}}, Tuple{M}} where M"><code>SpeedyWeather.tree</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tree(S::Simulation{M}; modules, with_size, kwargs...)
</code></pre><p>Create a tree of fields inside a Simulation instance and fields within these fields as long as they are defined within the modules argument (default SpeedyWeather). Other keyword arguments are <code>max_level::Integer=10</code>, <code>with_types::Bool=false</code> or <code>with_size::Bool=false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/models/tree.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.underflow!-Union{Tuple{T}, Tuple{AbstractArray{T}, Real}} where T" href="#SpeedyWeather.underflow!-Union{Tuple{T}, Tuple{AbstractArray{T}, Real}} where T"><code>SpeedyWeather.underflow!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">underflow!(A::AbstractArray, ϵ::Real)</code></pre><p>Underflows element <code>a</code> in <code>A</code> to zero if <code>abs(a) &lt; ϵ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/utility_functions.jl#L34-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.unscale!-Tuple{AbstractArray, Real}" href="#SpeedyWeather.unscale!-Tuple{AbstractArray, Real}"><code>SpeedyWeather.unscale!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unscale!(variable::AbstractArray, scale::Real) -&gt; Any
</code></pre><p>Undo the radius-scaling for any variable. Method used for netcdf output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/scaling.jl#L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.unscale!-Tuple{DiagnosticVariables}" href="#SpeedyWeather.unscale!-Tuple{DiagnosticVariables}"><code>SpeedyWeather.unscale!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unscale!(diagn::DiagnosticVariables) -&gt; Int64
</code></pre><p>Undo the radius-scaling of vorticity and divergence from scale!(diagn, scale::Real).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/scaling.jl#L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.unscale!-Tuple{PrognosticVariables}" href="#SpeedyWeather.unscale!-Tuple{PrognosticVariables}"><code>SpeedyWeather.unscale!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unscale!(progn::PrognosticVariables) -&gt; Int64
</code></pre><p>Undo the radius-scaling of vorticity and divergence from scale!(progn, scale::Real).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/scaling.jl#L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vertical_integration!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, Geometry}" href="#SpeedyWeather.vertical_integration!-Tuple{DiagnosticVariables, PrognosticVariables, Integer, Geometry}"><code>SpeedyWeather.vertical_integration!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vertical_integration!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Integer,
    geometry::Geometry
)
</code></pre><p>Calculates the vertically averaged (weighted by the thickness of the σ level) velocities (*coslat) and divergence. E.g.</p><pre><code class="nohighlight hljs">u_mean = ∑_k=1^nlayers Δσ_k * u_k</code></pre><p>u, v are averaged in grid-point space, divergence in spectral space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vertical_interpolate!-Tuple{Vector, Vector, Geometry}" href="#SpeedyWeather.vertical_interpolate!-Tuple{Vector, Vector, Geometry}"><code>SpeedyWeather.vertical_interpolate!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vertical_interpolate!(
    A_half::Vector,
    A_full::Vector,
    G::Geometry
)
</code></pre><p>Given a vector in column defined at full levels, do a linear interpolation in log(σ) to calculate its values at half-levels, skipping top (k=1/2), extrapolating to bottom (k=nlayers+1/2).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/geometry.jl#L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.virtual_temperature!-Tuple{DiagnosticVariables, PrimitiveDry}" href="#SpeedyWeather.virtual_temperature!-Tuple{DiagnosticVariables, PrimitiveDry}"><code>SpeedyWeather.virtual_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">virtual_temperature!(
    diagn::DiagnosticVariables,
    model::PrimitiveDry
)
</code></pre><p>Virtual temperature in grid-point space: For the PrimitiveDry temperature and virtual temperature are the same (humidity=0). Just copy over the arrays.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/virtual_temperature.jl#L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.virtual_temperature!-Tuple{DiagnosticVariables, PrimitiveWet}" href="#SpeedyWeather.virtual_temperature!-Tuple{DiagnosticVariables, PrimitiveWet}"><code>SpeedyWeather.virtual_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">virtual_temperature!(
    diagn::DiagnosticVariables,
    model::PrimitiveWet
)
</code></pre><p>Calculates the virtual temperature Tᵥ as</p><pre><code class="nohighlight hljs">Tᵥ = T(1+μq)</code></pre><p>With absolute temperature T, specific humidity q and</p><pre><code class="nohighlight hljs">μ = (1-ξ)/ξ, ξ = R_dry/R_vapour.</code></pre><p>in grid-point space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/virtual_temperature.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.volume_flux_divergence!-Tuple{DiagnosticVariables, SpeedyWeather.AbstractOrography, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractGeometry, SpectralTransform}" href="#SpeedyWeather.volume_flux_divergence!-Tuple{DiagnosticVariables, SpeedyWeather.AbstractOrography, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractGeometry, SpectralTransform}"><code>SpeedyWeather.volume_flux_divergence!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">volume_flux_divergence!(
    diagn::DiagnosticVariables,
    orog::SpeedyWeather.AbstractOrography,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    G::SpeedyWeather.AbstractGeometry,
    S::SpectralTransform
)
</code></pre><p>Computes the (negative) divergence of the volume fluxes <code>uh, vh</code> for the continuity equation, -∇⋅(uh, vh).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L717">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vordiv_tendencies!-Tuple{DiagnosticVariables, PrimitiveEquation}" href="#SpeedyWeather.vordiv_tendencies!-Tuple{DiagnosticVariables, PrimitiveEquation}"><code>SpeedyWeather.vordiv_tendencies!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vordiv_tendencies!(
    diagn::DiagnosticVariables,
    model::PrimitiveEquation
)
</code></pre><p>Function barrier to unpack <code>model</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vordiv_tendencies!-Tuple{DiagnosticVariables, SpeedyWeather.AbstractCoriolis, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractGeometry, SpectralTransform}" href="#SpeedyWeather.vordiv_tendencies!-Tuple{DiagnosticVariables, SpeedyWeather.AbstractCoriolis, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractGeometry, SpectralTransform}"><code>SpeedyWeather.vordiv_tendencies!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vordiv_tendencies!(
    diagn::DiagnosticVariables,
    coriolis::SpeedyWeather.AbstractCoriolis,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    geometry::SpeedyWeather.AbstractGeometry,
    S::SpectralTransform
)
</code></pre><p>Tendencies for vorticity and divergence. Excluding Bernoulli potential with geopotential and linear pressure gradient inside the Laplace operator, which are added later in spectral space.</p><pre><code class="nohighlight hljs">u_tend +=  v*(f+ζ) - RTᵥ&#39;*∇lnp_x
v_tend += -u*(f+ζ) - RTᵥ&#39;*∇lnp_y</code></pre><p><code>+=</code> because the tendencies already contain the parameterizations and vertical advection. <code>f</code> is coriolis, <code>ζ</code> relative vorticity, <code>R</code> the gas constant <code>Tᵥ&#39;</code> the virtual temperature anomaly, <code>∇lnp</code> the gradient of surface pressure and <code>_x</code> and <code>_y</code> its zonal/meridional components. The tendencies are then curled/dived to get the tendencies for vorticity/divergence in spectral space</p><pre><code class="nohighlight hljs">∂ζ/∂t = ∇×(u_tend, v_tend)
∂D/∂t = ∇⋅(u_tend, v_tend) + ...</code></pre><p><code>+ ...</code> because there&#39;s more terms added later for divergence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L290">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vorticity_flux!-Tuple{DiagnosticVariables, Barotropic}" href="#SpeedyWeather.vorticity_flux!-Tuple{DiagnosticVariables, Barotropic}"><code>SpeedyWeather.vorticity_flux!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vorticity_flux!(
    diagn::DiagnosticVariables,
    model::Barotropic
)
</code></pre><p>Vorticity flux tendency in the barotropic vorticity equation</p><p><code>∂ζ/∂t = ∇×(u_tend, v_tend)</code></p><p>with</p><p><code>u_tend = Fᵤ + v*(ζ+f)</code> <code>v_tend = Fᵥ - u*(ζ+f)</code></p><p>with Fᵤ, Fᵥ the forcing from <code>forcing!</code> already in <code>u_tend_grid</code>/<code>v_tend_grid</code> and vorticity ζ, coriolis f.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L635">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vorticity_flux!-Tuple{DiagnosticVariables, ShallowWater}" href="#SpeedyWeather.vorticity_flux!-Tuple{DiagnosticVariables, ShallowWater}"><code>SpeedyWeather.vorticity_flux!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vorticity_flux!(
    diagn::DiagnosticVariables,
    model::ShallowWater
)
</code></pre><p>Vorticity flux tendency in the shallow water equations</p><p><code>∂ζ/∂t = ∇×(u_tend, v_tend)</code> <code>∂D/∂t = ∇⋅(u_tend, v_tend)</code></p><p>with</p><p><code>u_tend = Fᵤ + v*(ζ+f)</code> <code>v_tend = Fᵥ - u*(ζ+f)</code></p><p>with Fᵤ, Fᵥ the forcing from <code>forcing!</code> already in <code>u_tend_grid</code>/<code>v_tend_grid</code> and vorticity ζ, coriolis f.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L614">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vorticity_flux_curldiv!-Tuple{DiagnosticVariables, SpeedyWeather.AbstractCoriolis, Geometry, SpectralTransform}" href="#SpeedyWeather.vorticity_flux_curldiv!-Tuple{DiagnosticVariables, SpeedyWeather.AbstractCoriolis, Geometry, SpectralTransform}"><code>SpeedyWeather.vorticity_flux_curldiv!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vorticity_flux_curldiv!(
    diagn::DiagnosticVariables,
    coriolis::SpeedyWeather.AbstractCoriolis,
    geometry::Geometry,
    S::SpectralTransform;
    div,
    add
)
</code></pre><p>Compute the vorticity advection as the curl/div of the vorticity fluxes</p><p><code>∂ζ/∂t = ∇×(u_tend, v_tend)</code> <code>∂D/∂t = ∇⋅(u_tend, v_tend)</code></p><p>with</p><p><code>u_tend = Fᵤ + v*(ζ+f)</code> <code>v_tend = Fᵥ - u*(ζ+f)</code></p><p>with <code>Fᵤ, Fᵥ</code> from <code>u_tend_grid</code>/<code>v_tend_grid</code> that are assumed to be alread set in <code>forcing!</code>. Set <code>div=false</code> for the BarotropicModel which doesn&#39;t require the divergence tendency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/tendencies.jl#L557">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.workgroup_size-Tuple{SpeedyWeather.AbstractDevice}" href="#SpeedyWeather.workgroup_size-Tuple{SpeedyWeather.AbstractDevice}"><code>SpeedyWeather.workgroup_size</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">workgroup_size(
    device::SpeedyWeather.AbstractDevice
) -&gt; Int64
</code></pre><p>Returns a workgroup size depending on <code>device</code>. WIP: Will be expanded in the future to also include grid information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/gpu.jl#L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.write_column_tendencies!-Tuple{DiagnosticVariables, ColumnVariables, SpeedyWeather.AbstractPlanet, Integer}" href="#SpeedyWeather.write_column_tendencies!-Tuple{DiagnosticVariables, ColumnVariables, SpeedyWeather.AbstractPlanet, Integer}"><code>SpeedyWeather.write_column_tendencies!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_column_tendencies!(
    diagn::DiagnosticVariables,
    column::ColumnVariables,
    planet::SpeedyWeather.AbstractPlanet,
    ij::Integer
)
</code></pre><p>Write the parametrization tendencies from <code>C::ColumnVariables</code> into the horizontal fields of tendencies stored in <code>D::DiagnosticVariables</code> at gridpoint index <code>ij</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/column_variables.jl#L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.write_restart_file!-Union{Tuple{T}, Tuple{SpeedyWeather.AbstractOutput, PrognosticVariables{T}}} where T" href="#SpeedyWeather.write_restart_file!-Union{Tuple{T}, Tuple{SpeedyWeather.AbstractOutput, PrognosticVariables{T}}} where T"><code>SpeedyWeather.write_restart_file!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_restart_file!(
    output::SpeedyWeather.AbstractOutput,
    progn::PrognosticVariables{T}
) -&gt; Any
</code></pre><p>A restart file <code>restart.jld2</code> with the prognostic variables is written to the output folder (or current path) that can be used to restart the model. <code>restart.jld2</code> will then be used as initial conditions. The prognostic variables are bitrounded for compression and the 2nd leapfrog time step is discarded. Variables in restart file are unscaled.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/output/restart_file.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.year_angle-Union{Tuple{T}, Tuple{Type{T}, DateTime, Second, Second}} where T" href="#SpeedyWeather.year_angle-Union{Tuple{T}, Tuple{Type{T}, DateTime, Second, Second}} where T"><code>SpeedyWeather.year_angle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">year_angle(
    _::Type{T},
    time::DateTime,
    length_of_day::Second,
    length_of_year::Second
) -&gt; Any
</code></pre><p>Fraction of year as angle in radians [0...2π]. TODO: Takes length of day/year as argument, but calls to Dates.Time(), Dates.dayofyear() currently have these hardcoded.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/physics/zenith.jl#L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.σ_interpolation_weights-Tuple{AbstractVector, AbstractVector}" href="#SpeedyWeather.σ_interpolation_weights-Tuple{AbstractVector, AbstractVector}"><code>SpeedyWeather.σ_interpolation_weights</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">σ_interpolation_weights(
    σ_levels_full::AbstractVector,
    σ_levels_half::AbstractVector
) -&gt; Any
</code></pre><p>Interpolation weights for full to half level interpolation on sigma coordinates. Following Fortran SPEEDY documentation eq. (1).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/7938a42d3b7dc87442dae38ea15c59d57c485090/src/dynamics/geometry.jl#L117">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gradients/">« Gradient operators</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Wednesday 30 April 2025 14:10">Wednesday 30 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
