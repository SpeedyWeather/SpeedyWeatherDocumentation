<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>LowerTriangularMatrices · SpeedyWeather.jl</title><meta name="title" content="LowerTriangularMatrices · SpeedyWeather.jl"/><meta property="og:title" content="LowerTriangularMatrices · SpeedyWeather.jl"/><meta property="twitter:title" content="LowerTriangularMatrices · SpeedyWeather.jl"/><meta name="description" content="Documentation for SpeedyWeather.jl."/><meta property="og:description" content="Documentation for SpeedyWeather.jl."/><meta property="twitter:description" content="Documentation for SpeedyWeather.jl."/><meta property="og:url" content="https://speedyweather.github.io/SpeedyWeatherDocumentation/stable/lowertriangularmatrices/"/><meta property="twitter:url" content="https://speedyweather.github.io/SpeedyWeatherDocumentation/stable/lowertriangularmatrices/"/><link rel="canonical" href="https://speedyweather.github.io/SpeedyWeatherDocumentation/stable/lowertriangularmatrices/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpeedyWeather.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Running SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../how_to_run_speedy/">How to run SpeedyWeather</a></li><li><a class="tocitem" href="../examples_2D/">Examples 2D</a></li><li><a class="tocitem" href="../examples_3D/">Examples 3D</a></li><li><a class="tocitem" href="../initial_conditions/">Initial conditions</a></li><li><a class="tocitem" href="../tracers/">Tracer advection</a></li><li><a class="tocitem" href="../particles/">Particle advection</a></li><li><a class="tocitem" href="../stochastic_physics/">Stochastic physics</a></li><li><a class="tocitem" href="../land/">Land surface model</a></li><li><a class="tocitem" href="../analysis/">Analysis</a></li><li><a class="tocitem" href="../structure/">Tree structure</a></li><li><a class="tocitem" href="../differentiability/">Differentiability and Adjoint Model</a></li><li><a class="tocitem" href="../output/">NetCDF output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Extending SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../extensions/">Extensions</a></li><li><a class="tocitem" href="../forcing_drag/">Forcing and drag</a></li><li><a class="tocitem" href="../parameterizations/">Parameterizations</a></li><li><a class="tocitem" href="../orography/">Orography</a></li><li><a class="tocitem" href="../land_sea_mask/">Land-Sea Mask</a></li><li><a class="tocitem" href="../ocean/">Ocean</a></li><li><a class="tocitem" href="../custom_netcdf_output/">NetCDF output variables</a></li><li><a class="tocitem" href="../callbacks/">Callbacks</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Dynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../barotropic/">Barotropic model</a></li><li><a class="tocitem" href="../shallowwater/">Shallow water model</a></li><li><a class="tocitem" href="../primitiveequation/">Primitive equation model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../large_scale_condensation/">Large-scale condensation</a></li><li><a class="tocitem" href="../convection/">Convection</a></li><li><a class="tocitem" href="../radiation/">Radiation</a></li><li><a class="tocitem" href="../vertical_diffusion/">Vertical diffusion</a></li><li><a class="tocitem" href="../surface_fluxes/">Surface fluxes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../spectral_transform/">Spherical Harmonic Transform</a></li><li><a class="tocitem" href="../grids/">Grids</a></li></ul></li><li><a class="tocitem" href="../ringgrids/">RingGrids</a></li><li class="is-active"><a class="tocitem" href>LowerTriangularMatrices</a><ul class="internal"><li><a class="tocitem" href="#Creation-of-LowerTriangularArray"><span>Creation of <code>LowerTriangularArray</code></span></a></li><li><a class="tocitem" href="#Size-of-LowerTriangularArray"><span>Size of <code>LowerTriangularArray</code></span></a></li><li><a class="tocitem" href="#Indexing-LowerTriangularArray"><span>Indexing <code>LowerTriangularArray</code></span></a></li><li><a class="tocitem" href="#Linear-algebra-with-LowerTriangularArray"><span>Linear algebra with <code>LowerTriangularArray</code></span></a></li><li><a class="tocitem" href="#Rotation-of-LowerTriangularArray"><span>Rotation of <code>LowerTriangularArray</code></span></a></li><li><a class="tocitem" href="#Broadcasting-with-LowerTriangularArray"><span>Broadcasting with <code>LowerTriangularArray</code></span></a></li><li><a class="tocitem" href="#GPU"><span>GPU</span></a></li><li><a class="tocitem" href="#Function-and-type-index"><span>Function and type index</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">SpeedyTransforms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../speedytransforms/">Spectral transforms</a></li><li><a class="tocitem" href="../gradients/">Gradient operators</a></li></ul></li><li><a class="tocitem" href="../functions/">Function and type index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>LowerTriangularMatrices</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>LowerTriangularMatrices</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/main/docs/src/lowertriangularmatrices.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="lowertriangularmatrices"><a class="docs-heading-anchor" href="#lowertriangularmatrices">LowerTriangularMatrices</a><a id="lowertriangularmatrices-1"></a><a class="docs-heading-anchor-permalink" href="#lowertriangularmatrices" title="Permalink"></a></h1><p>LowerTriangularMatrices is a submodule that has been developed for SpeedyWeather.jl which is technically independent (SpeedyWeather.jl however imports it and so does SpeedyTransforms) and can also be used without running simulations. It is just not put into its own respective repository.</p><p>This module defines <code>LowerTriangularArray</code>, a lower triangular matrix format, which in contrast to <a href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#LinearAlgebra.LowerTriangular"><code>LinearAlgebra.LowerTriangular</code></a> does not store the entries above the diagonal. SpeedyWeather.jl uses <code>LowerTriangularArray</code> which is defined as a subtype of <code>AbstractArray</code> to store the spherical harmonic coefficients (see <a href="../spectral_transform/#Spectral-packing">Spectral packing</a>). For 2D <code>LowerTriangularArray</code> the alias <code>LowerTriangularMatrix</code> exists. Higher dimensional <code>LowerTriangularArray</code> are &#39;batches&#39; of 2D <code>LowerTriangularMatrix</code>. So, for example a <span>$(10\times 10\times 10)$</span> <code>LowerTriangularArray</code> holds 10 <code>LowerTriangularMatrix</code> of size <span>$(10\times 10)$</span> in one array.  </p><div class="admonition is-category-warn"><header class="admonition-header">LowerTriangularMatrix is actually a vector</header><div class="admonition-body"><p><code>LowerTriangularMatrix</code> and <code>LowerTriangularArray</code> can in many ways be used very much like a <code>Matrix</code> or <code>Array</code>, however, because they unravel the lower triangle into a vector their dimensionality is one less than their <code>Array</code> counterparts. A <code>LowerTriangularMatrix</code> should therefore be treated as a vector rather than a matrix with some (limited) added functionality to allow for matrix-indexing (vector or flat-indexing is the default though). More details below.</p></div></div><h2 id="Creation-of-LowerTriangularArray"><a class="docs-heading-anchor" href="#Creation-of-LowerTriangularArray">Creation of <code>LowerTriangularArray</code></a><a id="Creation-of-LowerTriangularArray-1"></a><a class="docs-heading-anchor-permalink" href="#Creation-of-LowerTriangularArray" title="Permalink"></a></h2><p>A <code>LowerTriangularMatrix</code> and <code>LowerTriangularArray</code> can be created using <code>zeros</code>, <code>ones</code>, <code>rand</code>, or <code>randn</code></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using SpeedyWeather.LowerTriangularMatrices</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L = rand(LowerTriangularMatrix{Float32}, 5, 5)</code><code class="nohighlight hljs ansi" style="display:block;">15-element, 5x5 LowerTriangularMatrix{Float32}
 0.0600408  0.0       0.0       0.0       0.0
 0.418493   0.896051  0.0       0.0       0.0
 0.0303594  0.47521   0.246151  0.0       0.0
 0.902717   0.996052  0.216247  0.677131  0.0
 0.635349   0.157614  0.604615  0.837651  0.27631</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L2 = rand(LowerTriangularArray{Float32}, 5, 5, 5)</code><code class="nohighlight hljs ansi" style="display:block;">15×5 LowerTriangularArray{Float32, 2, Matrix{Float32}}:
 0.676464   0.546216  0.934143   0.042445   0.810714
 0.939767   0.979876  0.824898   0.336094   0.187566
 0.90461    0.370947  0.163684   0.804713   0.757346
 0.303165   0.869341  0.276314   0.523768   0.368252
 0.988656   0.873751  0.721913   0.682748   0.587957
 0.571405   0.594115  0.702355   0.0905198  0.745756
 0.220354   0.67818   0.0675935  0.531063   0.460653
 0.435465   0.405462  0.416082   0.205732   0.282781
 0.333592   0.845227  0.452049   0.492719   0.990451
 0.736736   0.836031  0.860516   0.667784   0.0375097
 0.999967   0.454084  0.439036   0.69377    0.466609
 0.223564   0.916156  0.488856   0.785652   0.390149
 0.397956   0.365831  0.216382   0.98933    0.879694
 0.531802   0.962056  0.114089   0.435962   0.686346
 0.0920392  0.60609   0.838831   0.537742   0.194943</code></pre><p>or the <code>undef</code> initializer <code>LowerTriangularMatrix{Float32}(undef, 3, 3)</code>. The element type is arbitrary though, you can use any type <code>T</code> too.</p><p>Note how for a matrix both the upper triangle and the lower triangle are shown in the terminal. The zeros are evident. However, for higher dimensional <code>LowerTriangularArray</code> we fall back to show the unravelled first two dimensions. Hence, here, the first column is the first matrix with 15 elements forming a 5x5 matrix, but the zeros are not shown.</p><p>Alternatively, it can be created through conversion from <code>Array</code>, which drops the upper triangle entries and sets them to zero (which are not stored however)</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; M = rand(Float16, 3, 3)</code><code class="nohighlight hljs ansi" style="display:block;">3×3 Matrix{Float16}:
 0.0869  0.1436    0.2822
 0.5107  0.004395  0.1201
 0.3608  0.975     0.692</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L = LowerTriangularMatrix(M)</code><code class="nohighlight hljs ansi" style="display:block;">6-element, 3x3 LowerTriangularMatrix{Float16}
 0.0869  0.0       0.0
 0.5107  0.004395  0.0
 0.3608  0.975     0.692</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; M2 = rand(Float16, 3, 3, 2)</code><code class="nohighlight hljs ansi" style="display:block;">3×3×2 Array{Float16, 3}:
[:, :, 1] =
 0.1943  0.4775  0.646
 0.8296  0.9663  0.7524
 0.8086  0.2036  0.8403

[:, :, 2] =
 0.4512  0.8965  0.998
 0.788   0.2314  0.1138
 0.308   0.8853  0.8267</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L2 = LowerTriangularArray(M2)</code><code class="nohighlight hljs ansi" style="display:block;">6×2 LowerTriangularArray{Float16, 2, Matrix{Float16}}:
 0.1943  0.4512
 0.8296  0.788
 0.8086  0.308
 0.9663  0.2314
 0.2036  0.8853
 0.8403  0.8267</code></pre><h2 id="Size-of-LowerTriangularArray"><a class="docs-heading-anchor" href="#Size-of-LowerTriangularArray">Size of <code>LowerTriangularArray</code></a><a id="Size-of-LowerTriangularArray-1"></a><a class="docs-heading-anchor-permalink" href="#Size-of-LowerTriangularArray" title="Permalink"></a></h2><p>There are three different ways to describe the size of a <code>LowerTriangularArray</code>. For example with <code>L</code></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L = rand(LowerTriangularMatrix, 5, 5)</code><code class="nohighlight hljs ansi" style="display:block;">15-element, 5x5 LowerTriangularMatrix{Float64}
 0.229007   0.0       0.0       0.0       0.0
 0.0252906  0.958183  0.0       0.0       0.0
 0.464791   0.538125  0.772825  0.0       0.0
 0.888089   0.954493  0.264129  0.417762  0.0
 0.495054   0.161672  0.117822  0.306542  0.411985</code></pre><p>we have (additional dimensions follow naturally thereafter)</p><h3 id="1-based-vector-indexing-(default)"><a class="docs-heading-anchor" href="#1-based-vector-indexing-(default)">1-based vector indexing (default)</a><a id="1-based-vector-indexing-(default)-1"></a><a class="docs-heading-anchor-permalink" href="#1-based-vector-indexing-(default)" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; size(L)    # equivalently size(L, OneBased, as=Vector)</code><code class="nohighlight hljs ansi" style="display:block;">(15,)</code></pre><p>The lower triangle is unravelled hence the number of elements in the lower triangle is returned.</p><h3 id="1-based-matrix-indexing"><a class="docs-heading-anchor" href="#1-based-matrix-indexing">1-based matrix indexing</a><a id="1-based-matrix-indexing-1"></a><a class="docs-heading-anchor-permalink" href="#1-based-matrix-indexing" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; size(L, as=Matrix)    # equivalently size(L, OneBased, as=Matrix)</code><code class="nohighlight hljs ansi" style="display:block;">(5, 5)</code></pre><p>If you think of a <code>LowerTriangularMatrix</code> as a matrix this is the most intuitive size of <code>L</code>, which, however, does not agree with the size of the underlying data array (hence it is not the default).</p><h3 id="0-based-matrix-indexing"><a class="docs-heading-anchor" href="#0-based-matrix-indexing">0-based matrix indexing</a><a id="0-based-matrix-indexing-1"></a><a class="docs-heading-anchor-permalink" href="#0-based-matrix-indexing" title="Permalink"></a></h3><p>Because <code>LowerTriangularArray</code>s are used to represent the coefficients of spherical harmonics which are commonly indexed based on zero (i.e. starting with the zero mode representing the mean), we also add <code>ZeroBased</code> to get the corresponding size.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; size(L, ZeroBased, as=Matrix)</code><code class="nohighlight hljs ansi" style="display:block;">(4, 4)</code></pre><p>which is convenient if you want to know the maximum degree and order of the spherical harmonics in <code>L</code>. 0-based vector indexing is not implemented.</p><h2 id="Indexing-LowerTriangularArray"><a class="docs-heading-anchor" href="#Indexing-LowerTriangularArray">Indexing <code>LowerTriangularArray</code></a><a id="Indexing-LowerTriangularArray-1"></a><a class="docs-heading-anchor-permalink" href="#Indexing-LowerTriangularArray" title="Permalink"></a></h2><p>We illustrate the two types of indexing <code>LowerTriangularArray</code> supports.</p><ul><li>Matrix indexing, by denoting two indices, column and row <code>[l, m, ..]</code></li><li>Vector/flat indexing, by denoting a single index <code>[lm, ..]</code>.</li></ul><p>The matrix index works as expected</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L</code><code class="nohighlight hljs ansi" style="display:block;">15-element, 5x5 LowerTriangularMatrix{Float64}
 0.229007   0.0       0.0       0.0       0.0
 0.0252906  0.958183  0.0       0.0       0.0
 0.464791   0.538125  0.772825  0.0       0.0
 0.888089   0.954493  0.264129  0.417762  0.0
 0.495054   0.161672  0.117822  0.306542  0.411985</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[2, 2]</code><code class="nohighlight hljs ansi" style="display:block;">0.9581828354616068</code></pre><p>But the single index skips the zero entries in the upper triangle, i.e. a <code>2, 2</code> index points to the same element as the index <code>6</code></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[6]</code><code class="nohighlight hljs ansi" style="display:block;">0.9581828354616068</code></pre><p>which, important, is different from single indices of an <code>AbstractMatrix</code></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; Matrix(L)[6]</code><code class="nohighlight hljs ansi" style="display:block;">0.0</code></pre><p>which would point to the first element in the upper triangle (hence zero).</p><p>In performance-critical code a single index should be used, as this directly maps to the index of the underlying data vector. The matrix index is somewhat slower as it first has to be converted to the corresponding single index. </p><p>Consequently, many loops in SpeedyWeather.jl are build with the following structure</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; n, m = size(L, as=Matrix)</code><code class="nohighlight hljs ansi" style="display:block;">(5, 5)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ij = 0</code><code class="nohighlight hljs ansi" style="display:block;">0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for j in 1:m, i in j:n
           ij += 1
           L[ij] = i+j
       end</code></pre><p>which loops over all lower triangle entries of <code>L::LowerTriangularArray</code> and the single index <code>ij</code> is simply counted up. However, one could also use <code>[i, j]</code> as indices in the loop body or to perform any calculation (<code>i+j</code> here).</p><div class="admonition is-category-warn"><header class="admonition-header">`end` doesn&#39;t work for matrix indexing</header><div class="admonition-body"><p>Indexing <code>LowerTriangularMatrix</code> and <code>LowerTriangularArray</code> in matrix style (<code>[i, j]</code>) with  <code>end</code> doesn&#39;t work. It either returns an error or wrong results as the <code>end</code> is lowered by  Julia to the size of the underlying flat array dimension.</p></div></div><p>The <code>setindex!</code> functionality of matrixes will throw a <code>BoundsError</code> when trying to write into the upper triangle of a <code>LowerTriangularArray</code>, for example</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[2, 1] = 0    # valid index</code><code class="nohighlight hljs ansi" style="display:block;">0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[1, 2] = 0    # invalid index in the upper triangle</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: BoundsError: attempt to access 15-element, 5x5 LowerTriangularMatrix{Float64} at index [1, 2]</code></pre><p>But reading from it will just return a zero</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[2, 3]     # in the upper triangle</code><code class="nohighlight hljs ansi" style="display:block;">0.0</code></pre><p>Higher dimensional <code>LowerTriangularArray</code> can be indexed with multidimensional array indices  like most other arrays types. Both the vector index and the matrix index for the lower  triangle work as shown here</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L = rand(LowerTriangularArray{Float32}, 3, 3, 5)</code><code class="nohighlight hljs ansi" style="display:block;">6×5 LowerTriangularArray{Float32, 2, Matrix{Float32}}:
 0.67254    0.98559   0.739034   0.811765  0.762113
 0.225791   0.243145  0.859465   0.7717    0.809159
 0.7923     0.651951  0.0276359  0.653228  0.467806
 0.0340181  0.105218  0.137301   0.589157  0.779473
 0.745065   0.861973  0.174597   0.145359  0.912831
 0.14545    0.403919  0.189432   0.140779  0.0553426</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[2, 1] # second lower triangle element of the first lower triangle matrix</code><code class="nohighlight hljs ansi" style="display:block;">0.22579128f0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[2, 1, 1] # (2,1) element of the first lower triangle matrix</code><code class="nohighlight hljs ansi" style="display:block;">0.22579128f0</code></pre><p>The <code>setindex!</code> functionality follows accordingly. </p><h3 id="Iterators"><a class="docs-heading-anchor" href="#Iterators">Iterators</a><a id="Iterators-1"></a><a class="docs-heading-anchor-permalink" href="#Iterators" title="Permalink"></a></h3><p>An iterator over all entries in the array can be created with <code>eachindex</code></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L = rand(LowerTriangularArray, 5, 5, 5)</code><code class="nohighlight hljs ansi" style="display:block;">15×5 LowerTriangularArray{Float64, 2, Matrix{Float64}}:
 0.548484   0.171302  0.455076   0.968945   0.00537019
 0.523767   0.235517  0.449437   0.27899    0.0426655
 0.908248   0.178508  0.574909   0.319661   0.132055
 0.011078   0.903947  0.207169   0.413988   0.0534643
 0.14596    0.419293  0.0225061  0.604283   0.308787
 0.3087     0.989751  0.929102   0.0156206  0.563191
 0.919822   0.475472  0.512645   0.148835   0.445899
 0.572136   0.369854  0.0698445  0.599148   0.570361
 0.0617443  0.389972  0.142392   0.924285   0.275244
 0.537881   0.286695  0.542572   0.809043   0.722784
 0.122438   0.532565  0.691813   0.843243   0.724401
 0.906831   0.224502  0.861958   0.203479   0.945463
 0.459164   0.483168  0.503105   0.684586   0.227538
 0.62558    0.958603  0.754003   0.869961   0.524839
 0.0909447  0.304552  0.0373962  0.558407   0.852614</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for ij in eachindex(L)
           # do something
       end</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; eachindex(L)</code><code class="nohighlight hljs ansi" style="display:block;">Base.OneTo(75)</code></pre><p>In order to only loop over the harmonics (essentially the horizontal, ignoring other dimensions) use <code>eachharmonic</code></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; eachharmonic(L)</code><code class="nohighlight hljs ansi" style="display:block;">Base.OneTo(15)</code></pre><p>If you only want to loop over the other dimensions use <code>eachmatrix</code></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; eachmatrix(L)</code><code class="nohighlight hljs ansi" style="display:block;">CartesianIndices((5,))</code></pre><p>together they can be used as</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; for k in eachmatrix(L)
           for lm in eachharmonic(L)
               L[lm, k]
           end
       end</code></pre><p>Note that <code>k</code> is a <code>CartesianIndex</code> that will loop over <em>all</em> other dimensions, whether there&#39;s only 1 (representing a 3D variable) or 5 (representing a 6D variable with the first two dimensions being a lower triangular matrix).</p><h2 id="Linear-algebra-with-LowerTriangularArray"><a class="docs-heading-anchor" href="#Linear-algebra-with-LowerTriangularArray">Linear algebra with <code>LowerTriangularArray</code></a><a id="Linear-algebra-with-LowerTriangularArray-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-algebra-with-LowerTriangularArray" title="Permalink"></a></h2><p>The <a href="#lowertriangularmatrices">LowerTriangularMatrices</a> module&#39;s main purpose is not linear algebra, and typical matrix operations will not work with <code>LowerTriangularMatrix</code> because it&#39;s treated as a vector not as a matrix, meaning that the following will not work as expected</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L = rand(LowerTriangularMatrix{Float32}, 3, 3)</code><code class="nohighlight hljs ansi" style="display:block;">6-element, 3x3 LowerTriangularMatrix{Float32}
 0.511984  0.0       0.0
 0.459762  0.666712  0.0
 0.295788  0.929795  0.247124</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L * L</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: MethodError: no method matching *(::LowerTriangularMatrix{Float32}, ::LowerTriangularMatrix{Float32})
The function `*` exists, but no method is defined for this combination of argument types.

Closest candidates are:
  *(::Any, ::Any, <span class="sgr91">::Any</span>, <span class="sgr91">::Any...</span>)
<span class="sgr90">   @</span> <span class="sgr90">Base</span> <span class="sgr90"><span class="sgr4">operators.jl:596</span></span>
  *(<span class="sgr91">::ChainRulesCore.NoTangent</span>, ::Any)
<span class="sgr90">   @</span> <span class="sgr32">ChainRulesCore</span> <span class="sgr90">~/.julia/packages/ChainRulesCore/U6wNx/src/<span class="sgr4">tangent_arithmetic.jl:64</span></span>
  *(::Any, <span class="sgr91">::ChainRulesCore.NotImplemented</span>)
<span class="sgr90">   @</span> <span class="sgr32">ChainRulesCore</span> <span class="sgr90">~/.julia/packages/ChainRulesCore/U6wNx/src/<span class="sgr4">tangent_arithmetic.jl:38</span></span>
  ...</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; inv(L)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: MethodError: no method matching inv(::LowerTriangularMatrix{Float32})
The function `inv` exists, but no method is defined for this combination of argument types.

Closest candidates are:
  inv(<span class="sgr91">::Geodesy.LLAfromECEF</span>)
<span class="sgr90">   @</span> <span class="sgr32">Geodesy</span> <span class="sgr90">~/.julia/packages/Geodesy/otwWk/src/<span class="sgr4">transformations.jl:190</span></span>
  inv(<span class="sgr91">::Proj.Transformation</span>; always_xy, area, ctx)
<span class="sgr90">   @</span> <span class="sgr33">Proj</span> <span class="sgr90">~/.julia/packages/Proj/UNTvN/src/<span class="sgr4">coord.jl:199</span></span>
  inv(<span class="sgr91">::Crayons.ANSIStyle</span>)
<span class="sgr90">   @</span> <span class="sgr35">Crayons</span> <span class="sgr90">~/.julia/packages/Crayons/u3AH8/src/<span class="sgr4">crayon.jl:76</span></span>
  ...</code></pre><p>And many other operations that require <code>L</code> to be a <code>AbstractMatrix</code> which it isn&#39;t. In contrast, typical vector operations like a scalar product between two &quot;LowerTriangularMatrix&quot; vectors does work</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L&#39; * L</code><code class="nohighlight hljs ansi" style="display:block;">1.9310914f0</code></pre><p>Summation with <code>sum</code> follows the flat, single index logic</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L = rand(LowerTriangularMatrix{Float32}, 3, 3, 5)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `LowerTriangularMatrix` not defined in `Main`
Suggestion: check for spelling errors or missing imports.
Hint: a global variable of this name also exists in SpeedyWeather.</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sum(L, dims=2)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `L` not defined in `Main`
Suggestion: check for spelling errors or missing imports.</code></pre><p>sums along the second dimension of the underlying vector, not of the full matrix representation. </p><h2 id="Rotation-of-LowerTriangularArray"><a class="docs-heading-anchor" href="#Rotation-of-LowerTriangularArray">Rotation of <code>LowerTriangularArray</code></a><a id="Rotation-of-LowerTriangularArray-1"></a><a class="docs-heading-anchor-permalink" href="#Rotation-of-LowerTriangularArray" title="Permalink"></a></h2><p><code>LowerTriangularArray</code>s are used to describe spherical harmonics. In that case each element represents the coefficient in fron of the respective harmonic describing a field on the sphere when transformed to grid space. We implement <code>rotate!</code> for <code>LowerTriangularArray</code> to rotate these coefficients in complex number space to represent a longitude rotation of the represented grid space field. For example start with</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; M = rand(LowerTriangularMatrix{ComplexF32}, 3, 3)</code><code class="nohighlight hljs ansi" style="display:block;">6-element, 3x3 LowerTriangularMatrix{ComplexF32}
 0.142712+0.413208im       0.0+0.0im            0.0+0.0im
 0.269379+0.791932im  0.277095+0.510407im       0.0+0.0im
 0.479117+0.167861im  0.779002+0.554591im  0.248902+0.214493im</code></pre><p>Now <code>rotate!(::LowerTriangularArray, degree)</code></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; rotate!(M, 45)</code><code class="nohighlight hljs ansi" style="display:block;">6-element, 3x3 LowerTriangularMatrix{ComplexF32}
 0.142712+0.413208im       0.0+0.0im            0.0+0.0im
 0.269379+0.791932im  0.556848+0.164977im       0.0+0.0im
 0.479117+0.167861im  0.942993-0.158683im  0.214493-0.248902im</code></pre><p>represents the same (up to rounding errors from the rotation when not rotating by <span>$\pm 90, \pm 180, ...$</span>) field in grid space but rotated by 45˚ eastward. Note how the zonal modes (the first column) aren&#39;t rotated because they are zonally constant anyway (in fact their imaginary part can be dropped, but isn&#39;t here as created by the <code>rand</code>) and for the other modes this amounts to a multiplication with</p><p class="math-container">\[\exp(-i\frac{2π}{360}\phi m)\]</p><p>With <span>$\phi$</span> the rotation angle in degrees (positive eastward) and <span>$m$</span> the zonal wavenumber (order of the spherical harmonic, the zero-based column index). Rotating again by 315˚ yields the original array</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; rotate!(M, 315)</code><code class="nohighlight hljs ansi" style="display:block;">6-element, 3x3 LowerTriangularMatrix{ComplexF32}
 0.142712+0.413208im       0.0+0.0im            0.0+0.0im
 0.269379+0.791932im  0.277095+0.510407im       0.0+0.0im
 0.479117+0.167861im  0.779002+0.554591im  0.248902+0.214493im</code></pre><h2 id="Broadcasting-with-LowerTriangularArray"><a class="docs-heading-anchor" href="#Broadcasting-with-LowerTriangularArray">Broadcasting with <code>LowerTriangularArray</code></a><a id="Broadcasting-with-LowerTriangularArray-1"></a><a class="docs-heading-anchor-permalink" href="#Broadcasting-with-LowerTriangularArray" title="Permalink"></a></h2><p>In contrast to linear algebra, many element-wise operations work as expected thanks to broadcasting, so operations that can be written in <code>.</code> notation whether implicit <code>+</code>, <code>2*</code>, ... or explicitly written <code>.+</code>, <code>.^</code>, ... or via the <code>@.</code> macro</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L + L</code><code class="nohighlight hljs ansi" style="display:block;">6-element, 3x3 LowerTriangularMatrix{Float32}
 1.02397   0.0      0.0
 0.919525  1.33342  0.0
 0.591575  1.85959  0.494248</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 2L</code><code class="nohighlight hljs ansi" style="display:block;">6-element, 3x3 LowerTriangularMatrix{Float32}
 1.02397   0.0      0.0
 0.919525  1.33342  0.0
 0.591575  1.85959  0.494248</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @. L + 2L - 1.1*L / L^2</code><code class="nohighlight hljs ansi" style="display:block;">6-element, 3x3 LowerTriangularMatrix{Float64}
 -0.612556  0.0        0.0
 -1.01325   0.350245   0.0
 -2.83152   1.60633   -3.70983</code></pre><h2 id="GPU"><a class="docs-heading-anchor" href="#GPU">GPU</a><a id="GPU-1"></a><a class="docs-heading-anchor-permalink" href="#GPU" title="Permalink"></a></h2><p><code>LowerTriangularArray{T, N, ArrayType}</code> wraps around an array of type <code>ArrayType</code>. If this array is a GPU array (e.g. <code>CuArray</code>), all operations are performed on GPU as well (work in progress). The implementation was written so that scalar indexing is avoided in almost all cases, so that GPU operation should be performant. To use <code>LowerTriangularArray</code> on GPU you can e.g. just <code>adapt</code> an existing <code>LowerTriangularArray</code>.</p><pre><code class="language-julia hljs">using Adapt
L = rand(LowerTriangularArray{Float32}, 5, 5, 5)
L_gpu = adapt(CuArray, L)</code></pre><h2 id="Function-and-type-index"><a class="docs-heading-anchor" href="#Function-and-type-index">Function and type index</a><a id="Function-and-type-index-1"></a><a class="docs-heading-anchor-permalink" href="#Function-and-type-index" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.LowerTriangularArray" href="#SpeedyWeather.LowerTriangularMatrices.LowerTriangularArray"><code>SpeedyWeather.LowerTriangularMatrices.LowerTriangularArray</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A lower triangular array implementation that only stores the non-zero entries explicitly. <code>L&lt;:AbstractArray{T,N-1}</code> although we do allow both &quot;flat&quot; <code>N-1</code>-dimensional indexing and  additional <code>N</code>-dimensional or &quot;matrix-style&quot; indexing.</p><p>Supports n-dimensional lower triangular arrays, so that for all trailing dimensions <code>L[:, :, ..]</code> is a matrix in lower triangular form, e.g. a (5x5x3)-LowerTriangularArray would hold 3 lower triangular matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.LowerTriangularArray-Union{Tuple{ArrayType}, Tuple{N}, Tuple{T}} where {T, N, ArrayType&lt;:AbstractArray{T, N}}" href="#SpeedyWeather.LowerTriangularMatrices.LowerTriangularArray-Union{Tuple{ArrayType}, Tuple{N}, Tuple{T}} where {T, N, ArrayType&lt;:AbstractArray{T, N}}"><code>SpeedyWeather.LowerTriangularMatrices.LowerTriangularArray</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LowerTriangularArray(
    M::AbstractArray{T, N}
) -&gt; LowerTriangularArray
</code></pre><p>Create a LowerTriangularArray <code>L</code> from Array <code>M</code> by copying over the non-zero elements in <code>M</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L375">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.LowerTriangularMatrix" href="#SpeedyWeather.LowerTriangularMatrices.LowerTriangularMatrix"><code>SpeedyWeather.LowerTriangularMatrices.LowerTriangularMatrix</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>2-dimensional <code>LowerTriangularArray</code> of type <code>T</code><code>with its non-zero entries unravelled into a</code>Vector{T}`</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.LowerTriangularMatrix-Union{Tuple{Matrix{T}}, Tuple{T}} where T" href="#SpeedyWeather.LowerTriangularMatrices.LowerTriangularMatrix-Union{Tuple{Matrix{T}}, Tuple{T}} where T"><code>SpeedyWeather.LowerTriangularMatrices.LowerTriangularMatrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LowerTriangularMatrix(M::Array{T, 2}) -&gt; Any
</code></pre><p>Create a LowerTriangularArray <code>L</code> from Matrix <code>M</code> by copying over the non-zero elements in <code>M</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L344-L347">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.OneBased" href="#SpeedyWeather.LowerTriangularMatrices.OneBased"><code>SpeedyWeather.LowerTriangularMatrices.OneBased</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract type to dispatch for 1-based indexing of the spherical harmonic degree l and order m, i.e. l=m=1 is the mean, the zonal modes are m=1 etc. This indexing matches Julia&#39;s 1-based indexing for arrays.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L50-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.ZeroBased" href="#SpeedyWeather.LowerTriangularMatrices.ZeroBased"><code>SpeedyWeather.LowerTriangularMatrices.ZeroBased</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract type to dispatch for 0-based indexing of the spherical harmonic degree l and order m, i.e. l=m=0 is the mean, the zonal modes are m=0 etc. This indexing is more common in mathematics.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L45-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.fill!-Tuple{LowerTriangularArray, Any}" href="#Base.fill!-Tuple{LowerTriangularArray, Any}"><code>Base.fill!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fill!(L::LowerTriangularArray, x) -&gt; LowerTriangularArray
</code></pre><p>Fills the elements of <code>L</code> with <code>x</code>. Faster than fill!(::AbstractArray, x) as only the non-zero elements in <code>L</code> are assigned with x.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L559">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.length-Tuple{LowerTriangularArray}" href="#Base.length-Tuple{LowerTriangularArray}"><code>Base.length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">length(L::LowerTriangularArray) -&gt; Any
</code></pre><p>Length of a <code>LowerTriangularArray</code> defined as number of non-zero elements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.size" href="#Base.size"><code>Base.size</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">size(L::LowerTriangularArray; ...) -&gt; Any
size(
    L::LowerTriangularArray,
    base::Type{&lt;:SpeedyWeather.LowerTriangularMatrices.IndexBasis};
    as
) -&gt; Any
</code></pre><p>Size of a <code>LowerTriangularArray</code> defined as size of the flattened array if <code>as &lt;: AbstractVector</code> and as if it were a full matrix when <code>as &lt;: AbstractMatrix</code>` .</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.rotate!-Tuple{LowerTriangularArray, Real}" href="#LinearAlgebra.rotate!-Tuple{LowerTriangularArray, Real}"><code>LinearAlgebra.rotate!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rotate!(
    L::LowerTriangularArray,
    degree::Real
) -&gt; LowerTriangularArray
</code></pre><p>Rotate the field(s) represented by a LowerTriangularArray zonally by <code>degree</code> by multiplication of the spherical harmonics by exp(-i<em>m</em>2π*degree/360), with <code>m</code> the order of the spherical harmonic.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/rotate.jl#L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.eachharmonic-Tuple{LowerTriangularArray, Vararg{LowerTriangularArray}}" href="#SpeedyWeather.LowerTriangularMatrices.eachharmonic-Tuple{LowerTriangularArray, Vararg{LowerTriangularArray}}"><code>SpeedyWeather.LowerTriangularMatrices.eachharmonic</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eachharmonic(
    L1::LowerTriangularArray,
    Ls::LowerTriangularArray...
) -&gt; Any
</code></pre><p>creates <code>unit_range::UnitRange</code> to loop over all non-zeros in the LowerTriangularMatrices provided as arguments. Checks bounds first. All LowerTriangularMatrix&#39;s need to be of the same size. Like <code>eachindex</code> but skips the upper triangle with zeros in <code>L</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L285">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.eachharmonic-Tuple{LowerTriangularArray}" href="#SpeedyWeather.LowerTriangularMatrices.eachharmonic-Tuple{LowerTriangularArray}"><code>SpeedyWeather.LowerTriangularMatrices.eachharmonic</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eachharmonic(L::LowerTriangularArray) -&gt; Any
</code></pre><p>creates <code>unit_range::UnitRange</code> to loop over all non-zeros/spherical harmonics numbers in a LowerTriangularArray <code>L</code>. Like <code>eachindex</code> but skips the upper triangle with zeros in <code>L</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.eachmatrix-Tuple{LowerTriangularArray, Vararg{LowerTriangularArray}}" href="#SpeedyWeather.LowerTriangularMatrices.eachmatrix-Tuple{LowerTriangularArray, Vararg{LowerTriangularArray}}"><code>SpeedyWeather.LowerTriangularMatrices.eachmatrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eachmatrix(
    L1::LowerTriangularArray,
    Ls::LowerTriangularArray...
) -&gt; Any
</code></pre><p>Iterator for the non-horizontal dimensions in LowerTriangularArrays. Checks that the LowerTriangularArrays match according to <code>lowertriangular_match</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L304">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.eachmatrix-Tuple{LowerTriangularArray}" href="#SpeedyWeather.LowerTriangularMatrices.eachmatrix-Tuple{LowerTriangularArray}"><code>SpeedyWeather.LowerTriangularMatrices.eachmatrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eachmatrix(L::LowerTriangularArray) -&gt; Any
</code></pre><p>Iterator for the non-horizontal dimensions in LowerTriangularArrays. To be used like</p><pre><code class="nohighlight hljs">for k in eachmatrix(L)
    L[1, k]</code></pre><p>to loop over every non-horizontal dimension of L.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L295">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.find_L-Tuple{Base.Broadcast.Broadcasted}" href="#SpeedyWeather.LowerTriangularMatrices.find_L-Tuple{Base.Broadcast.Broadcasted}"><code>SpeedyWeather.LowerTriangularMatrices.find_L</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>L = find_L(Ls)</code> returns the first LowerTriangularArray among the arguments.  Adapted from Julia documentation of Broadcast interface</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L610-L612">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.ij2k-Tuple{Integer, Integer, Integer}" href="#SpeedyWeather.LowerTriangularMatrices.ij2k-Tuple{Integer, Integer, Integer}"><code>SpeedyWeather.LowerTriangularMatrices.ij2k</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ij2k(i::Integer, j::Integer, m::Integer) -&gt; Any
</code></pre><p>Converts the index pair <code>i, j</code> of an <code>m</code>x<code>n</code> LowerTriangularMatrix <code>L</code> to a single index <code>k</code> that indexes the same element in the corresponding vector that stores only the lower triangle (the non-zero entries) of <code>L</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.k2ij-Tuple{Integer, Integer}" href="#SpeedyWeather.LowerTriangularMatrices.k2ij-Tuple{Integer, Integer}"><code>SpeedyWeather.LowerTriangularMatrices.k2ij</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">k2ij(k::Integer, m::Integer) -&gt; Tuple{Any, Any}
</code></pre><p>Converts the linear index <code>k</code> in the lower triangle into a pair <code>(i, j)</code> of indices  of the matrix in column-major form. (Formula taken from  Angeletti et al, 2019, https://hal.science/hal-02047514/document)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L191">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.lowertriangular_match-Tuple{LowerTriangularArray, LowerTriangularArray}" href="#SpeedyWeather.LowerTriangularMatrices.lowertriangular_match-Tuple{LowerTriangularArray, LowerTriangularArray}"><code>SpeedyWeather.LowerTriangularMatrices.lowertriangular_match</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lowertriangular_match(
    L1::LowerTriangularArray,
    L2::LowerTriangularArray;
    horizontal_only
) -&gt; Any
</code></pre><p>True if both <code>L1</code> and <code>L2</code> are of the same size (as matrix), but ignores singleton dimensions, e.g. 5x5 and 5x5x1 would match. With <code>horizontal_only=true</code> (default <code>false</code>) ignore the non-horizontal dimensions, e.g. 5x5, 5x5x1, 5x5x2 would all match.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L312">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.lowertriangular_match-Tuple{LowerTriangularArray, Vararg{LowerTriangularArray}}" href="#SpeedyWeather.LowerTriangularMatrices.lowertriangular_match-Tuple{LowerTriangularArray, Vararg{LowerTriangularArray}}"><code>SpeedyWeather.LowerTriangularMatrices.lowertriangular_match</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lowertriangular_match(
    L1::LowerTriangularArray,
    Ls::LowerTriangularArray...;
    kwargs...
) -&gt; Any
</code></pre><p>True if all lower triangular matrices provided as arguments match according to <code>lowertriangular_match</code> wrt to <code>L1</code> (and therefore all).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/aa0c812aafc1bfbd05a47cefe038bc2332a12950/src/LowerTriangularMatrices/lower_triangular_array.jl#L327">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ringgrids/">« RingGrids</a><a class="docs-footer-nextpage" href="../speedytransforms/">Spectral transforms »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Thursday 1 May 2025 03:59">Thursday 1 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
