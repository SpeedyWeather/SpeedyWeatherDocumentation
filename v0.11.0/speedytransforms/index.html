<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spectral transforms · SpeedyWeather.jl</title><meta name="title" content="Spectral transforms · SpeedyWeather.jl"/><meta property="og:title" content="Spectral transforms · SpeedyWeather.jl"/><meta property="twitter:title" content="Spectral transforms · SpeedyWeather.jl"/><meta name="description" content="Documentation for SpeedyWeather.jl."/><meta property="og:description" content="Documentation for SpeedyWeather.jl."/><meta property="twitter:description" content="Documentation for SpeedyWeather.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpeedyWeather.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Running SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../how_to_run_speedy/">How to run SpeedyWeather</a></li><li><a class="tocitem" href="../examples_2D/">Examples 2D</a></li><li><a class="tocitem" href="../examples_3D/">Examples 3D</a></li><li><a class="tocitem" href="../analysis/">Analysis</a></li><li><a class="tocitem" href="../structure/">Tree structure</a></li><li><a class="tocitem" href="../particles/">Particle advection</a></li><li><a class="tocitem" href="../output/">NetCDF output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Extending SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../extensions/">Extensions</a></li><li><a class="tocitem" href="../forcing_drag/">Forcing and drag</a></li><li><a class="tocitem" href="../parameterizations/">Parameterizations</a></li><li><a class="tocitem" href="../orography/">Orography</a></li><li><a class="tocitem" href="../land_sea_mask/">Land-Sea Mask</a></li><li><a class="tocitem" href="../ocean/">Ocean</a></li><li><a class="tocitem" href="../custom_netcdf_output/">NetCDF output variables</a></li><li><a class="tocitem" href="../callbacks/">Callbacks</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Dynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../barotropic/">Barotropic model</a></li><li><a class="tocitem" href="../shallowwater/">Shallow water model</a></li><li><a class="tocitem" href="../primitiveequation/">Primitive equation model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../large_scale_condensation/">Large-scale condensation</a></li><li><a class="tocitem" href="../convection/">Convection</a></li><li><a class="tocitem" href="../radiation/">Radiation</a></li><li><a class="tocitem" href="../vertical_diffusion/">Vertical diffusion</a></li><li><a class="tocitem" href="../surface_fluxes/">Surface fluxes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../spectral_transform/">Spherical Harmonic Transform</a></li><li><a class="tocitem" href="../grids/">Grids</a></li></ul></li><li><a class="tocitem" href="../ringgrids/">RingGrids</a></li><li><a class="tocitem" href="../lowertriangularmatrices/">LowerTriangularMatrices</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox" checked/><label class="tocitem" for="menuitem-10"><span class="docs-label">SpeedyTransforms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Spectral transforms</a><ul class="internal"><li><a class="tocitem" href="#Notation:-Spectral-resolution"><span>Notation: Spectral resolution</span></a></li><li><a class="tocitem" href="#Example-transform"><span>Example transform</span></a></li><li><a class="tocitem" href="#Transform-onto-another-grid"><span>Transform onto another grid</span></a></li><li><a class="tocitem" href="#SpectralTransform"><span>The <code>SpectralTransform</code> struct</span></a></li><li><a class="tocitem" href="#Power-spectrum"><span>Power spectrum</span></a></li><li><a class="tocitem" href="#Example:-Creating-kn-distributed-noise"><span>Example: Creating k^n-distributed noise</span></a></li><li><a class="tocitem" href="#(P)recompute-Legendre-polynomials"><span>(P)recompute Legendre polynomials</span></a></li><li><a class="tocitem" href="#Batched-Transforms"><span>Batched Transforms</span></a></li><li><a class="tocitem" href="#Functions-and-type-index"><span>Functions and type index</span></a></li></ul></li><li><a class="tocitem" href="../gradients/">Gradient operators</a></li></ul></li><li><a class="tocitem" href="../functions/">Function and type index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">SpeedyTransforms</a></li><li class="is-active"><a href>Spectral transforms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spectral transforms</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/main/docs/src/speedytransforms.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="SpeedyTransforms"><a class="docs-heading-anchor" href="#SpeedyTransforms">SpeedyTransforms</a><a id="SpeedyTransforms-1"></a><a class="docs-heading-anchor-permalink" href="#SpeedyTransforms" title="Permalink"></a></h1><p>SpeedyTransforms is a submodule that has been developed for SpeedyWeather.jl which is technically independent (SpeedyWeather.jl however imports it) and can also be used without running simulations. It is just not put into its own respective repository for now.</p><p>The SpeedyTransforms are based on <a href="../ringgrids/#RingGrids">RingGrids</a> and <a href="../lowertriangularmatrices/#lowertriangularmatrices">LowerTriangularMatrices</a> to hold data in either grid-point space or in spectral space. So you want to read these sections first for clarifications how to work with these. We will also not discuss mathematical details of the <a href="../spectral_transform/#Spherical-Harmonic-Transform">Spherical Harmonic Transform</a> here, but will focus on the usage of the SpeedyTransforms module.</p><p>The SpeedyTransforms module also implements the gradient operators <span>$\nabla, \nabla \cdot, \nabla \times, \nabla^2, \nabla^{-2}$</span> in spectral space. Combined with the spectral transform, you could for example start with a velocity field in grid-point space, transform to spectral, compute its divergence and transform back to obtain the divergence in grid-point space. Examples are outlined in <a href="../gradients/#Gradient-operators">Gradient operators</a>.</p><h2 id="Notation:-Spectral-resolution"><a class="docs-heading-anchor" href="#Notation:-Spectral-resolution">Notation: Spectral resolution</a><a id="Notation:-Spectral-resolution-1"></a><a class="docs-heading-anchor-permalink" href="#Notation:-Spectral-resolution" title="Permalink"></a></h2><p>There are different ways to describe the spectral resolution, the truncation wavenumber (e.g. T31), the maximum degree <span>$l$</span> and order <span>$m$</span> of the spherical harmonics (e.g. <span>$l_{max}=31$</span>, <span>$m_{max} = 31$</span>), or the size of the lower triangular matrix, e.g. 32x32. In this example, they are all equivalent. We often use the truncation, i.e. T31, for brevity but sometimes it is important to describe degree and order independently (see for example <a href="../gradients/#One-more-degree-for-spectral-fields">One more degree for spectral fields</a>). Note also how truncation, degree and order are 0-based, but matrix sizes are 1-based. </p><h2 id="Example-transform"><a class="docs-heading-anchor" href="#Example-transform">Example transform</a><a id="Example-transform-1"></a><a class="docs-heading-anchor-permalink" href="#Example-transform" title="Permalink"></a></h2><p>Lets start with a simple transform. We could be <code>using SpeedyWeather</code> but to be more verbose these are the modules required to load</p><pre><code class="language-julia hljs">using SpeedyWeather.RingGrids
using SpeedyWeather.LowerTriangularMatrices
using SpeedyWeather.SpeedyTransforms</code></pre><p>As an example, we want to transform the <span>$l=m=1$</span> spherical harmonic from spectral space in <code>alms</code> to grid-point space. Note, the <span>$+1$</span> on both degree (first index) and order (second index) for 0-based harmonics versus 1-based matrix indexing, see <a href="../lowertriangularmatrices/#Size-of-LowerTriangularArray">Size of <code>LowerTriangularArray</code></a>. Create a <code>LowerTriangularMatrix</code> for T5 resolution, i.e. 6x6 matrix size</p><pre><code class="language-julia hljs">alms = zeros(LowerTriangularMatrix{ComplexF64}, 6, 6)     # spectral coefficients T5
alms[2, 2] = 1                                            # only l=1, m=1 harmonic
alms</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">21-element, 6x6 LowerTriangularMatrix{ComplexF64}
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  1.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im</code></pre><p>Now <code>transform</code> is the function that takes spectral coefficients <code>alms</code> and converts them a grid-point space <code>map</code> (or vice versa)</p><pre><code class="language-julia hljs">map = transform(alms)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">128-element, 8-ring FullGaussianGrid{Float64}:
 -0.19278869685896918
 -0.17811353112752462
 -0.13632219488509478
 -0.07377704023518313
  0.0
  0.07377704023518313
  0.13632219488509478
  0.17811353112752462
  0.19278869685896918
  0.17811353112752462
  ⋮
  0.17811353112752462
  0.19278869685896918
  0.17811353112752462
  0.13632219488509478
  0.07377704023518313
  0.0
 -0.07377704023518313
 -0.13632219488509478
 -0.17811353112752462</code></pre><p>By default, the <code>transforms</code> transforms onto a <a href="../grids/#FullGaussianGrid"><code>FullGaussianGrid</code></a> unravelled here into a vector west to east, starting at the prime meridian, then north to south, see <a href="../ringgrids/#RingGrids">RingGrids</a>. We can visualize <code>map</code> quickly with a UnicodePlot via <code>plot</code> (see <a href="../ringgrids/#Visualising-RingGrid-data">Visualising RingGrid data</a>)</p><pre><code class="language-julia hljs">import SpeedyWeather.RingGrids: plot    # not necessary when `using SpeedyWeather`
plot(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">       <span class="sgr97"><span class="sgr1">8-ring FullGaussianGrid{Float64}</span></span>     
       <span class="sgr90">┌────────────────┐</span>  <span class="sgr90">0.7</span>
    <span class="sgr90">90</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#005f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#008787">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span><span class="sgr38_5" style="color:#5faf5f">▄</span><span class="sgr38_5" style="color:#5fd75f">▄</span><span class="sgr38_5" style="color:#87d75f">▄</span><span class="sgr38_5" style="color:#5fd75f">▄</span><span class="sgr38_5" style="color:#5faf5f">▄</span><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span><span class="sgr38_5" style="color:#5f5f87">▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#005f87">▄</span></span><span class="sgr90">│</span> <span class="sgr90">┌──┐</span>
    ˚N <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr38_5" style="color:#5f005f"><span class="sgr48_5" style="background:#5f0087">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#ffd700">▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#5f0087"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#5faf87">▄▄</span></span><span class="sgr90">│</span>
       <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄</span><span class="sgr38_5" style="color:#5f0087">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#afd700">▄</span></span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#afd700">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f0087">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄▄</span></span><span class="sgr90">│</span>
   <span class="sgr90">-90</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#005f87">▄▄</span><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#008787">▄▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#5faf5f">▄</span><span class="sgr48_5" style="background:#5fd75f">▄</span><span class="sgr48_5" style="background:#87d75f">▄</span><span class="sgr48_5" style="background:#5fd75f">▄</span><span class="sgr48_5" style="background:#5faf5f">▄</span><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#5f5f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#005f87">▄</span></span><span class="sgr90">│</span> <span class="sgr90">└──┘</span>
       <span class="sgr90">└────────────────┘</span> <span class="sgr90">-0.7</span>
        <span class="sgr90">0</span>     ˚E     <span class="sgr90">360</span>      </code></pre><p>Yay! This is the what the <span>$l=m=1$</span> spherical harmonic is supposed to look like! Now let&#39;s go back to spectral space with <code>transform</code></p><pre><code class="language-julia hljs">alms2 = transform(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">21-element, 6x6 LowerTriangularMatrix{ComplexF64}
 0.0+0.0im           0.0+0.0im  0.0+0.0im  …  0.0+0.0im           0.0+0.0im
 0.0+0.0im           1.0+0.0im  0.0+0.0im     0.0+0.0im           0.0+0.0im
 0.0+0.0im           0.0+0.0im  0.0+0.0im     0.0+0.0im           0.0+0.0im
 0.0+0.0im   3.75734e-16+0.0im  0.0+0.0im     0.0+0.0im           0.0+0.0im
 0.0+0.0im           0.0+0.0im  0.0+0.0im     0.0+0.0im           0.0+0.0im
 0.0+0.0im  -1.63058e-17+0.0im  0.0+0.0im  …  0.0+0.0im  -2.47957e-17+0.0im</code></pre><p>Comparing with <code>alms</code> from above you can see that the transform is exact up to a typical rounding error from <code>Float64</code>. </p><pre><code class="language-julia hljs">alms ≈ alms2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>YAY! The transform is typically idempotent, meaning that either space may hold information that is not exactly representable in the other but the first two-way transform will remove that so that subsequent transforms do not change this any further. However, also note here that the default <a href="../grids/#FullGaussianGrid"><code>FullGaussianGrid</code></a> is an exact grid, inexact grids usually have a transform error that is larger than the rounding error from floating-point arithmetic.</p><h2 id="Transform-onto-another-grid"><a class="docs-heading-anchor" href="#Transform-onto-another-grid">Transform onto another grid</a><a id="Transform-onto-another-grid-1"></a><a class="docs-heading-anchor-permalink" href="#Transform-onto-another-grid" title="Permalink"></a></h2><p>While the default grid for <a href="#SpeedyTransforms">SpeedyTransforms</a> is the <a href="../grids/#FullGaussianGrid"><code>FullGaussianGrid</code></a> we can transform onto other grids by specifying <code>Grid</code> too</p><pre><code class="language-julia hljs">map = transform(alms, Grid=HEALPixGrid)
plot(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">       <span class="sgr97"><span class="sgr1">7-ring HEALPixGrid{Float64}</span></span>     
       <span class="sgr90">┌──────────────┐</span>  <span class="sgr90">0.7</span>
    <span class="sgr90">90</span> <span class="sgr90">│</span><span class="sgr38_5" style="color:#005f87">▄▄</span><span class="sgr38_5" style="color:#008787">▄▄</span><span class="sgr38_5" style="color:#00af87">▄▄▄▄▄▄▄</span><span class="sgr38_5" style="color:#008787">▄▄</span><span class="sgr38_5" style="color:#005f87">▄</span><span class="sgr90">│</span> <span class="sgr90">┌──┐</span>
    ˚N <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄</span><span class="sgr38_5" style="color:#5f5f87">▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#005f87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#d7d700">▄</span><span class="sgr38_5" style="color:#ffd700">▄</span><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#005f87"><span class="sgr38_5" style="color:#5f5f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#5faf87">▄▄</span></span><span class="sgr90">│</span>
       <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#d7d700">▄</span><span class="sgr38_5" style="color:#ffd700">▄</span><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄</span></span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄▄</span></span><span class="sgr90">│</span>
   <span class="sgr90">-90</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#005f87">▄▄</span></span><span class="sgr48_5" style="background:#005f87"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#008787">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#5fd75f">▄</span><span class="sgr48_5" style="background:#afd75f">▄▄▄</span><span class="sgr48_5" style="background:#5fd75f">▄</span><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#005f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#005f87">▄</span></span><span class="sgr90">│</span> <span class="sgr90">└──┘</span>
       <span class="sgr90">└──────────────┘</span> <span class="sgr90">-0.7</span>
        <span class="sgr90">0</span>    ˚E    <span class="sgr90">360</span>      </code></pre><p>which, if transformed back, however, can yield a larger transform error as discussed above</p><pre><code class="language-julia hljs">transform(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">21-element, 6x6 LowerTriangularMatrix{ComplexF64}
 0.0+0.0im           0.0+0.0im          0.0+0.0im  …  0.0+0.0im  0.0+0.0im
 0.0+0.0im       1.01215-1.4295e-17im   0.0+0.0im     0.0+0.0im  0.0+0.0im
 0.0+0.0im   3.42299e-17+0.0im          0.0+0.0im     0.0+0.0im  0.0+0.0im
 0.0+0.0im     0.0185292-1.63433e-17im  0.0+0.0im     0.0+0.0im  0.0+0.0im
 0.0+0.0im  -6.28844e-17+0.0im          0.0+0.0im     0.0+0.0im  0.0+0.0im
 0.0+0.0im    -0.0164851+1.42335e-17im  0.0+0.0im  …  0.0+0.0im  0.0+0.0im</code></pre><p>On such a coarse grid the transform error (absolute and relative) is about <span>$10^{-2}$</span>, this decreases for higher resolution. The <code>transform</code> function will choose a corresponding grid-spectral resolution (see <a href="../grids/#Matching-spectral-and-grid-resolution">Matching spectral and grid resolution</a>) following quadratic truncation, but you can always truncate/interpolate in spectral space with <code>spectral_truncation</code>, <code>spectral_interpolation</code> which takes <code>trunc</code> = <span>$l_{max} = m_{max}$</span> as second argument</p><pre><code class="language-julia hljs">spectral_truncation(alms, 2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element, 3x3 LowerTriangularMatrix{ComplexF64}
 0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  1.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im</code></pre><p>Yay, we just chopped off <span>$l &gt; 2$</span> from <code>alms</code> which contained the harmonics up to degree and order 5 before. If the second argument in <code>spectral_truncation</code> is larger than <code>alms</code> then it will automatically call <code>spectral_interpolation</code> and vice versa. Also see <a href="../ringgrids/#Interpolation-on-RingGrids">Interpolation on RingGrids</a> to interpolate directly between grids. If you want to control directly the resolution of the grid you want to <code>transform</code> onto, use the keyword <code>dealiasing</code> (default: 2 for quadratic, see <a href="../grids/#Matching-spectral-and-grid-resolution">Matching spectral and grid resolution</a>). But you can also provide a <code>SpectralTransform</code> instance to reuse a precomputed spectral transform. More on that now.</p><h2 id="SpectralTransform"><a class="docs-heading-anchor" href="#SpectralTransform">The <code>SpectralTransform</code> struct</a><a id="SpectralTransform-1"></a><a class="docs-heading-anchor-permalink" href="#SpectralTransform" title="Permalink"></a></h2><p>The function <code>transform</code> only with arguments as shown above, will create an instance of <code>SpectralTransform</code> under the hood. This object contains all precomputed information that is required for the transform, either way:  The Legendre polynomials, pre-planned Fourier transforms, precomputed gradient, divergence and curl operators, the spherical harmonic eigenvalues among others. Maybe the most intuitive way to create a <code>SpectralTransform</code> is to start with a <code>SpectralGrid</code>, which already defines which spectral resolution is supposed to be combined with a given grid.</p><pre><code class="language-julia hljs">using SpeedyWeather
spectral_grid = SpectralGrid(NF=Float32, trunc=5, Grid=OctahedralGaussianGrid, dealiasing=3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralGrid:
├ Spectral:   T5 LowerTriangularMatrix{Complex{Float32}}, radius = 6.371e6 m
├ Grid:       12-ring OctahedralGaussianGrid{Float32}, 360 grid points
├ Resolution: 1190km (average)
├ Vertical:   8-layer SigmaCoordinates
└ Device:     CPU using Array</code></pre><p>(We <code>using SpeedyWeather</code> here as <code>SpectralGrid</code> is exported therein). We also specify the number format <code>Float32</code> here to be used for the transform although this is the default anyway. From <code>spectral_grid</code> we now construct a <code>SpectralTransform</code> as follows</p><pre><code class="language-julia hljs">S = SpectralTransform(spectral_grid)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float32}:
├ Spectral:   T5, 7x6 LowerTriangularMatrix{Complex{Float32}}
├ Grid:       12-ring OctahedralGaussianArray{Float32}
├ Truncation: dealiasing = 3 (cubic)
└ Legendre:   recompute polynomials false (1.22 KB)</code></pre><p>Note that because we chose <code>dealiasing=3</code> (cubic truncation) we now match a T5 spectral field with a 12-ring octahedral Gaussian grid, instead of the 8 rings as above. So going from <code>dealiasing=2</code> (default) to <code>dealiasing=3</code> increased our resolution on the grid while the spectral resolution remains the same. The <code>SpectralTransform</code> also has options for the recomputation or pre-computation of the Legendre polynomials, fore more information see <a href="#(P)recompute-Legendre-polynomials">(P)recompute Legendre polynomials</a>.</p><p>Passing on <code>S</code> the <code>SpectralTransform</code> now allows us to transform directly on the grid defined therein. Note that we recreate <code>alms</code> to be of size 7x6 instead of 6x6 for T5 spectral resolution because SpeedyWeather uses internally <a href="../gradients/#One-more-degree-for-spectral-fields">One more degree for spectral fields</a> meaning also that&#39;s the default when creating a <code>SpectralTransform</code> from a <code>SpectralGrid</code>. But results don&#39;t change if the last degree (row) contains only zeros.</p><pre><code class="language-julia hljs">alms = zeros(LowerTriangularMatrix{ComplexF64}, 7, 6)     # spectral coefficients
alms[2, 2] = 1                                            # only l=1, m=1 harmonic

map = transform(alms, S)
plot(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">       <span class="sgr97"><span class="sgr1">12-ring OctahedralGaussianGrid{Float32}</span></span>     
       <span class="sgr90">┌────────────────────────┐</span>  <span class="sgr90">0.7</span>
    <span class="sgr90">90</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#5f5f87">▄▄▄</span><span class="sgr38_5" style="color:#005f87">▄</span><span class="sgr38_5" style="color:#008787">▄▄▄</span><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#5faf87">▄▄</span><span class="sgr38_5" style="color:#5faf5f">▄▄▄</span><span class="sgr38_5" style="color:#5faf87">▄▄</span><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#008787">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄▄</span><span class="sgr38_5" style="color:#005f87">▄</span><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr90">│</span> <span class="sgr90">┌──┐</span>
       <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f0087">▄▄</span><span class="sgr38_5" style="color:#5f5f87">▄▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf5f">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#87d75f">▄</span><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd700">▄▄▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#afd75f">▄</span><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf5f">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄▄</span><span class="sgr38_5" style="color:#5f0087">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#afd75f">▄▄</span></span><span class="sgr90">│</span>
    ˚N <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄▄</span></span><span class="sgr38_5" style="color:#5f005f"><span class="sgr48_5" style="background:#5f0087">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#005f87">▄</span><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#ffd700">▄▄▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span><span class="sgr38_5" style="color:#005f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#5f0087"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr38_5" style="color:#5f005f"><span class="sgr48_5" style="background:#5f005f">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#00af87">▄▄</span></span><span class="sgr90">│</span>
       <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄▄</span><span class="sgr38_5" style="color:#5f0087">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#005f87"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#008787">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#afd700">▄</span></span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#d7d700">▄▄▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#afd700">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#005f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f0087">▄</span><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr90">│</span>
       <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f0087"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#5f5f87">▄▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr38_5" style="color:#5fd75f"><span class="sgr48_5" style="background:#afd75f">▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#87d75f">▄▄▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr38_5" style="color:#5fd75f"><span class="sgr48_5" style="background:#87d75f">▄</span></span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#5f0087">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄▄</span></span><span class="sgr90">│</span>
   <span class="sgr90">-90</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#008787">▄▄▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#005f87">▄</span><span class="sgr48_5" style="background:#008787">▄▄▄</span><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#5faf87">▄▄</span><span class="sgr48_5" style="background:#5faf5f">▄▄▄</span><span class="sgr48_5" style="background:#5faf87">▄▄</span><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#008787">▄▄▄</span><span class="sgr48_5" style="background:#005f87">▄</span><span class="sgr48_5" style="background:#5f5f87">▄▄</span></span><span class="sgr90">│</span> <span class="sgr90">└──┘</span>
       <span class="sgr90">└────────────────────────┘</span> <span class="sgr90">-0.7</span>
        <span class="sgr90">0</span>         ˚E         <span class="sgr90">360</span>      </code></pre><p>Yay, this is again the <span>$l=m=1$</span> harmonic, but this time on a slightly higher resolution <code>OctahedralGaussianGrid</code> as specified in the <code>SpectralTransform</code> <code>S</code>. Note that also the number format was converted on the fly to Float32 because that is the number format we specified in <code>S</code>! And from grid to spectral</p><pre><code class="language-julia hljs">alms2 = transform(map, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">27-element, 7x6 LowerTriangularMatrix{ComplexF32}
   2.05564f-9+0.0im          0.0+0.0im          …         0.0+0.0im
          0.0+0.0im          1.0-2.14344f-8im             0.0+0.0im
   -1.3654f-9+0.0im          0.0+0.0im                    0.0+0.0im
          0.0+0.0im  -2.66275f-8-6.93167f-11im            0.0+0.0im
 -3.22443f-10+0.0im          0.0+0.0im                    0.0+0.0im
          0.0+0.0im  -4.58858f-8-8.19443f-9im   …  6.58519f-9+4.79414f-9im
   1.85859f-9+0.0im          0.0+0.0im                    0.0+0.0im</code></pre><p>As you can see the rounding error is now more like <span>$10^{-8}$</span> as we are using Float32 (the <a href="../grids/#OctahedralGaussianGrid">OctahedralGaussianGrid</a> is another <em>exact</em> grid). While for this interface to SpeedyTransforms this means that on a grid-to-spectral transform you will get one more degree than orders of the spherical harmonics by default. You can, however, always truncate this additional degree, say to T5 (hence matrix size is 6x6)</p><pre><code class="language-julia hljs">spectral_truncation(alms2, 5, 5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">21-element, 6x6 LowerTriangularMatrix{ComplexF32}
   2.05564f-9+0.0im          0.0+0.0im          …         0.0+0.0im
          0.0+0.0im          1.0-2.14344f-8im             0.0+0.0im
   -1.3654f-9+0.0im          0.0+0.0im                    0.0+0.0im
          0.0+0.0im  -2.66275f-8-6.93167f-11im            0.0+0.0im
 -3.22443f-10+0.0im          0.0+0.0im                    0.0+0.0im
          0.0+0.0im  -4.58858f-8-8.19443f-9im   …  6.58519f-9+4.79414f-9im</code></pre><p><code>spectral_truncation(alms2, 5)</code> would have returned the same, a single argument is then assumed equal for both degrees and orders. Alternatively, you can also pass on the <code>one_more_degree=false</code> argument to the <code>SpectralTransform</code> constructor</p><pre><code class="language-julia hljs">S = SpectralTransform(spectral_grid, one_more_degree=false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float32}:
├ Spectral:   T5, 6x6 LowerTriangularMatrix{Complex{Float32}}
├ Grid:       12-ring OctahedralGaussianArray{Float32}
├ Truncation: dealiasing = 3 (cubic)
└ Legendre:   recompute polynomials false (1.07 KB)</code></pre><p>As you can see the <code>7x6 LowerTriangularMatrix</code> in the description above dropped down to <code>6x6 LowerTriangularMatrix</code>, this is the size of the input that is expected (otherwise you will get a <code>BoundsError</code>).</p><h2 id="Power-spectrum"><a class="docs-heading-anchor" href="#Power-spectrum">Power spectrum</a><a id="Power-spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Power-spectrum" title="Permalink"></a></h2><p>How to take some data and compute a power spectrum with SpeedyTransforms you may ask. Say you have some global data in a matrix <code>m</code> that looks, for example, like</p><pre><code class="language-julia hljs">m</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">96×47 Matrix{Float32}:
 0.273931  -0.100767    -0.452667   …  -3.24396   -3.19173   -2.43598
 0.260924  -0.0850735   -0.364595      -2.92304   -2.95447   -2.31557
 0.24943   -0.0659272   -0.275139      -2.59931   -2.71078   -2.19062
 0.239309  -0.0442175   -0.185773      -2.27384   -2.46185   -2.06179
 0.230409  -0.0207912   -0.0977171     -1.94765   -2.20881   -1.92976
 0.222571   0.00355396  -0.0120021  …  -1.62177   -1.95277   -1.79522
 0.215633   0.0280737    0.0704643     -1.29718   -1.69483   -1.65885
 0.209435   0.0520794    0.148827      -0.974847  -1.43609   -1.52135
 0.203823   0.0749393    0.22223       -0.655673  -1.17765   -1.38341
 0.198648   0.096081     0.289771      -0.340506  -0.920611  -1.24573
 ⋮                                  ⋱              ⋮         
 0.469789   0.0562124   -0.807317      -5.74071   -4.82269   -3.21484
 0.441319   0.00406615  -0.838498      -5.52669   -4.70345   -3.16186
 0.414266  -0.038462    -0.846118      -5.28946   -4.56523   -3.0994
 0.388814  -0.0714815   -0.832328   …  -5.03276   -4.40953   -3.02787
 0.365095  -0.0953392   -0.799703      -4.75999   -4.23788   -2.94771
 0.343194  -0.110579    -0.751063      -4.47409   -4.0518    -2.85941
 0.323149  -0.117898    -0.689304      -4.1776    -3.85275   -2.76352
 0.304957  -0.118107    -0.617261      -3.87261   -3.64216   -2.66058
 0.288575  -0.112089    -0.537584   …  -3.56091   -3.42138   -2.55119</code></pre><p>You hopefully know which grid this data comes on, let us assume it is a regular latitude-longitude grid, which we call the <code>FullClenshawGrid</code> (in analogy to the Gaussian grid based on the Gaussian quadrature). Note that for the spectral transform this should not include the poles, so the 96x47 matrix size here corresponds to 23 latitudes north and south of the Equator respectively plus the equator (=47).</p><p>We now wrap this matrix into a <code>FullClenshawGrid</code> (<code>input_as=Matrix</code> is required because all grids organise their data as vectors, see <a href="../ringgrids/#Creating-data-on-a-RingGrid">Creating data on a RingGrid</a>) therefore to associate it with the necessary grid information like its coordinates</p><pre><code class="language-julia hljs">map = FullClenshawGrid(m, input_as=Matrix)

using CairoMakie
heatmap(map)</code></pre><p><img src="../random_pattern.png" alt="Random pattern"/></p><p>Now we transform into spectral space and call <code>power_spectrum(::LowerTriangularMatrix)</code></p><pre><code class="language-julia hljs">alms = transform(map)
power = SpeedyTransforms.power_spectrum(alms)</code></pre><p>Which returns a vector of power at every wavenumber. By default this is normalized as average power per degree, you can change that with the keyword argument <code>normalize=false</code>. Plotting this yields</p><pre><code class="language-julia hljs">using UnicodePlots
k = 0:length(power)-1
lineplot(k, power, yscale=:log10, ylim=(1e-15, 10), xlim=extrema(k),
    ylabel=&quot;power&quot;, xlabel=&quot;wavenumber&quot;, height=10, width=60)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">               <span class="sgr90">┌────────────────────────────────────────────────────────────┐</span> 
           <span class="sgr90">10¹</span> <span class="sgr90">│</span><span class="sgr32">⠤⠤⠤⣀⠤⠔⠢⠤⢄⣀⡠⠤⠤⠤⠤⠤⠤⡠⠤⡄</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢱</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢸</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⠘⡄</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
   power       <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⡇</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢇</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢸</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢸</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⡇</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
         <span class="sgr90">10⁻¹⁵</span> <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⠋⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠑⠒⠒⠒⠒⠒⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠒⠊⠉⠉⠉⠉</span><span class="sgr90">│</span> 
               <span class="sgr90">└────────────────────────────────────────────────────────────┘</span> 
               ⠀<span class="sgr90">0</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">31</span>⠀ 
               ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀wavenumber⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀ </code></pre><p>The power spectrum of our data is about 1 up to wavenumber 10 and then close to zero for higher wavenumbers (which is in fact how we constructed this fake data). Let us turn this around and use SpeedyTransforms to create random noise in spectral space to be used in grid-point space!</p><h2 id="Example:-Creating-kn-distributed-noise"><a class="docs-heading-anchor" href="#Example:-Creating-kn-distributed-noise">Example: Creating k^n-distributed noise</a><a id="Example:-Creating-kn-distributed-noise-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Creating-kn-distributed-noise" title="Permalink"></a></h2><p>How would we construct random noise in spectral space that follows a certain power law and transform it back into grid-point space? Define the wavenumber <span>$k$</span> for T31, the spectral resolution we are interested in. (We start from 1 instead of 0 to avoid zero to the power of something negative). Now create some normally distributed spectral coefficients but scale them down for higher wavenumbers with <span>$k^{-2}$</span></p><pre><code class="language-julia hljs">k = 1:32
A = randn(Complex{Float32}, 32, 32)
A .*= k.^-2
alms = LowerTriangularArray(A)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">528-element, 32x32 LowerTriangularMatrix{ComplexF32}
    -1.18406-1.01063im      …        0.0+0.0im
     0.19954+0.265111im              0.0+0.0im
  -0.0547538-0.00454824im            0.0+0.0im
  -0.0194211-0.0110937im             0.0+0.0im
   0.0187087-0.0122924im             0.0+0.0im
  -0.0393054-0.0102977im    …        0.0+0.0im
  0.00663732-0.00534719im            0.0+0.0im
  -0.0171954-0.0111166im             0.0+0.0im
  0.00464293+0.0153343im             0.0+0.0im
 0.000571538-0.00112695im            0.0+0.0im
            ⋮               ⋱  
 0.000208754-0.0019671im             0.0+0.0im
  -0.0036653+0.0011266im             0.0+0.0im
 -0.00156976+0.000399904im  …        0.0+0.0im
 -0.00186548-0.00231458im            0.0+0.0im
 -0.00238138+0.00148307im            0.0+0.0im
  -0.0012837+0.000530439im           0.0+0.0im
 0.000485303-0.000638257im           0.0+0.0im
 -0.00021287+0.00060568im   …        0.0+0.0im
 0.000195152-0.00089051im      6.8316f-5+0.000465697im</code></pre><p>We first create a Julia <code>Matrix</code> so that the matrix-vector broadcasting <code>.*= k</code> is correctly applied across dimensions of <code>A</code> and then convert to a <code>LowerTriangularMatrix</code>.</p><p>Awesome. For higher degrees and orders the amplitude clearly decreases! Now to grid-point space and let us visualize the result</p><pre><code class="language-julia hljs">map = transform(alms)

using CairoMakie
heatmap(map, title=&quot;k⁻²-distributed noise&quot;)</code></pre><p><img src="../random_noise.png" alt="Random noise"/></p><p>You can always access the underlying data in <code>map</code> via <code>map.data</code> in case you need to get rid of the wrapping into a grid again!</p><h2 id="(P)recompute-Legendre-polynomials"><a class="docs-heading-anchor" href="#(P)recompute-Legendre-polynomials">(P)recompute Legendre polynomials</a><a id="(P)recompute-Legendre-polynomials-1"></a><a class="docs-heading-anchor-permalink" href="#(P)recompute-Legendre-polynomials" title="Permalink"></a></h2><p>The spectral transform uses a Legendre transform in meridional direction. For this the Legendre polynomials are required, at each latitude ring this is a <span>$l_{max} \times m_{max}$</span> lower triangular matrix. Storing precomputed Legendre polynomials therefore quickly increase in size with resolution. One can recompute them to save memory, but that  uses more arithmetic operations. There is therefore a memory-compute tradeoff.</p><p>For a single transform, there is no need to precompute the polynomials as the <code>SpectralTransform</code> object will be garbage collected again anyway. For low resolution simulations with many repeated small transforms it makes sense to precompute the polynomials and SpeedyWeather.jl does that automatically anyway. At very high resolution the polynomials may, however, become prohibitively large. An example at T127, about 100km resolution</p><pre><code class="language-julia hljs">spectral_grid = SpectralGrid(trunc=127)
SpectralTransform(spectral_grid, recompute_legendre=false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float32}:
├ Spectral:   T127, 129x128 LowerTriangularMatrix{Complex{Float32}}
├ Grid:       192-ring OctahedralGaussianArray{Float32}
├ Truncation: dealiasing = 2 (quadratic)
└ Legendre:   recompute polynomials false (3.23 MB)</code></pre><p>the polynomials are about 3MB in size. Easy that is not much. But at T1023 on the O1536 octahedral Gaussian grid, this is already 1.5GB, cubically increasing with the spectral truncation T. <code>recompute_legendre=true</code> (default <code>false</code> when constructing a <code>SpectralTransform</code> object which may be reused) would lower this to kilobytes</p><pre><code class="language-julia hljs">SpectralTransform(spectral_grid, recompute_legendre=true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float32}:
├ Spectral:   T127, 129x128 LowerTriangularMatrix{Complex{Float32}}
├ Grid:       192-ring OctahedralGaussianArray{Float32}
├ Truncation: dealiasing = 2 (quadratic)
└ Legendre:   recompute polynomials true (33.62 KB)</code></pre><h2 id="Batched-Transforms"><a class="docs-heading-anchor" href="#Batched-Transforms">Batched Transforms</a><a id="Batched-Transforms-1"></a><a class="docs-heading-anchor-permalink" href="#Batched-Transforms" title="Permalink"></a></h2><p>SpeedyTransforms also supports batched transforms. With batched input data the <code>transform</code> is performed along the leading dimension, and all further dimensions are interpreted as batch dimensions. Take for example </p><pre><code class="language-julia hljs">alms = randn(LowerTriangularMatrix{Complex{Float32}}, 32, 32, 5)
grids = transform(alms)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4608×5, 48-ring FullGaussianArray{Float32, 2, Matrix{Float32}}:
  1.75874  -10.7483   -0.192898   -1.69596     18.9202
  2.92139  -10.1779   -0.321121   -1.88269     18.7561
  4.08745   -9.47977  -0.408337   -2.10162     18.5492
  5.24183   -8.66084  -0.458185   -2.34535     18.3034
  6.3702    -7.72997  -0.473705   -2.60626     18.0232
  7.45938   -6.6977   -0.457257   -2.87664     17.7133
  8.49763   -5.57602  -0.41052    -3.1489      17.3787
  9.47487   -4.3781   -0.334565   -3.41566     17.024
 10.3829    -3.11804  -0.229984   -3.66983     16.6535
 11.2153    -1.81062  -0.0970745  -3.90475     16.2712
  ⋮                                           
  3.44068   -3.84627   1.3532     -3.59331     -9.70609
  2.17921   -3.89955   1.52111    -3.03316    -10.4131
  0.83113   -4.00003   1.66929    -2.47861    -11.1481
 -0.58791   -4.14079   1.79439    -1.93866    -11.9015
 -2.0604    -4.31308   1.89399    -1.42201    -12.6622
 -3.5673    -4.5066    1.96671    -0.936603   -13.4172
 -5.08844   -4.7099    2.01236    -0.489299   -14.1522
 -6.60294   -4.91078   2.03187    -0.0855541  -14.8522
 -8.08975   -5.0968    2.0273      0.270788   -15.5014</code></pre><p>In this case we first randomly generated five (32x32) <code>LowerTriangularMatrix</code> that hold the coefficients and then transformed all five matrices batched to the grid space with the  transform command, yielding 5 <code>RingGrids</code> with each 48-rings. </p><h2 id="Functions-and-type-index"><a class="docs-heading-anchor" href="#Functions-and-type-index">Functions and type index</a><a id="Functions-and-type-index-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-and-type-index" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.AssociatedLegendrePolArray" href="#SpeedyWeather.SpeedyTransforms.AssociatedLegendrePolArray"><code>SpeedyWeather.SpeedyTransforms.AssociatedLegendrePolArray</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AssociatedLegendrePolArray{T, N, M, V} &lt;: AbstractArray{T,N}</code></pre><p>Type that wraps around a <code>LowerTriangularArray{T,M,V}</code> but is a subtype of <code>AbstractArray{T,M+1}</code>.  This enables easier use with AssociatedLegendrePolynomials.jl which otherwise couldn&#39;t use the  &quot;matrix-style&quot; (l, m) indexing of <code>LowerTriangularArray</code>. This type however doesn&#39;t support any other operations than indexing and is purerly intended for internal purposes. </p><ul><li><code>data::LowerTriangularArray{T, M, V} where {T, M, V}</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/legendrepolarray.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.AssociatedLegendrePolMatrix" href="#SpeedyWeather.SpeedyTransforms.AssociatedLegendrePolMatrix"><code>SpeedyWeather.SpeedyTransforms.AssociatedLegendrePolMatrix</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>2-dimensional <code>AssociatedLegendrePolArray</code> of type <code>T</code><code>with its non-zero entries unravelled into a</code>Vector{T}`</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/legendrepolarray.jl#L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>SpectralTransform struct that contains all parameters and precomputed arrays to perform a spectral transform. Fields are</p><ul><li><p><code>Grid::Type{&lt;:AbstractGridArray}</code></p></li><li><p><code>nlat_half::Int64</code></p></li><li><p><code>lmax::Int64</code></p></li><li><p><code>mmax::Int64</code></p></li><li><p><code>nfreq_max::Int64</code></p></li><li><p><code>m_truncs::Vector{Int64}</code></p></li><li><p><code>nlon_max::Int64</code></p></li><li><p><code>nlons::Vector{Int64}</code></p></li><li><p><code>nlat::Int64</code></p></li><li><p><code>colat::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>cos_colat::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>sin_colat::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>lon_offsets::Array{Complex{NF}, 2} where NF&lt;:AbstractFloat</code></p></li><li><p><code>norm_sphere::AbstractFloat</code></p></li><li><p><code>rfft_plans::Vector{AbstractFFTs.Plan}</code></p></li><li><p><code>brfft_plans::Vector{AbstractFFTs.Plan}</code></p></li><li><p><code>recompute_legendre::Bool</code></p></li><li><p><code>Λ::SpeedyWeather.SpeedyTransforms.AssociatedLegendrePolArray{NF, 2, 1, Vector{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>Λs::Array{LowerTriangularMatrix{NF}, 1} where NF&lt;:AbstractFloat</code></p></li><li><p><code>solid_angles::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>ϵlms::LowerTriangularMatrix{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>grad_x::Array{Complex{NF}, 1} where NF&lt;:AbstractFloat</code></p></li><li><p><code>grad_y1::LowerTriangularMatrix{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>grad_y2::LowerTriangularMatrix{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>grad_y_vordiv1::LowerTriangularMatrix{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>grad_y_vordiv2::LowerTriangularMatrix{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>vordiv_to_uv_x::LowerTriangularMatrix{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>vordiv_to_uv1::LowerTriangularMatrix{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>vordiv_to_uv2::LowerTriangularMatrix{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>eigenvalues::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>eigenvalues⁻¹::Vector{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform-Union{Tuple{AbstractGridArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}}}, Tuple{NF}} where NF" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform-Union{Tuple{AbstractGridArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}}}, Tuple{NF}} where NF"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpectralTransform(
    grids::AbstractGridArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}};
    recompute_legendre,
    one_more_degree,
    dealiasing
) -&gt; SpectralTransform
</code></pre><p>Generator function for a <code>SpectralTransform</code> struct based on the size and grid type of gridded field <code>grids</code>. Recomputes the Legendre polynomials by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L230">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform-Union{Tuple{LowerTriangularArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}}}, Tuple{NF}} where NF" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform-Union{Tuple{LowerTriangularArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}}}, Tuple{NF}} where NF"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpectralTransform(
    alms::LowerTriangularArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}};
    recompute_legendre,
    Grid,
    dealiasing
) -&gt; SpectralTransform
</code></pre><p>Generator function for a <code>SpectralTransform</code> struct based on the size of the spectral coefficients <code>alms</code> and the grid <code>Grid</code>. Recomputes the Legendre polynomials by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform-Union{Tuple{NF}, Tuple{Type{NF}, Type{&lt;:AbstractGridArray}, Int64, Int64}} where NF" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform-Union{Tuple{NF}, Tuple{Type{NF}, Type{&lt;:AbstractGridArray}, Int64, Int64}} where NF"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpectralTransform(
    ::Type{NF},
    Grid::Type{&lt;:AbstractGridArray},
    lmax::Int64,
    mmax::Int64;
    recompute_legendre,
    legendre_shortcut,
    dealiasing
) -&gt; SpectralTransform
</code></pre><p>Generator function for a SpectralTransform struct. With <code>NF</code> the number format, <code>Grid</code> the grid type <code>&lt;:AbstractGrid</code> and spectral truncation <code>lmax, mmax</code> this function sets up necessary constants for the spetral transform. Also plans the Fourier transforms, retrieves the colatitudes, and preallocates the Legendre polynomials (if recompute_legendre == false) and quadrature weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.RingGrids.get_nlat_half" href="#SpeedyWeather.RingGrids.get_nlat_half"><code>SpeedyWeather.RingGrids.get_nlat_half</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_nlat_half(trunc::Integer) -&gt; Any
get_nlat_half(trunc::Integer, dealiasing::Real) -&gt; Any
</code></pre><p>For the spectral truncation <code>trunc</code> (e.g. 31 for T31) return the grid resolution parameter <code>nlat_half</code> (number of latitude rings on one hemisphere including the Equator) following a dealiasing parameter (default 2) to match spectral and grid resolution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/aliasing.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.UV_from_vor!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.UV_from_vor!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.UV_from_vor!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">UV_from_vor!(
    U::LowerTriangularArray,
    V::LowerTriangularArray,
    vor::LowerTriangularArray,
    S::SpectralTransform;
    radius
) -&gt; Tuple{LowerTriangularArray, LowerTriangularArray}
</code></pre><p>Get U, V (=(u, v)*coslat) from vorticity ζ spectral space (divergence D=0) Two operations are combined into a single linear operation. First, invert the spherical Laplace ∇² operator to get stream function from vorticity. Then compute zonal and meridional gradients to get U, V. Acts on the unit sphere, i.e. it omits any radius scaling as all inplace gradient operators, unless the <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L212">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.UV_from_vordiv!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.UV_from_vordiv!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.UV_from_vordiv!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">UV_from_vordiv!(
    U::LowerTriangularArray,
    V::LowerTriangularArray,
    vor::LowerTriangularArray,
    div::LowerTriangularArray,
    S::SpectralTransform;
    radius
) -&gt; Tuple{LowerTriangularArray, LowerTriangularArray}
</code></pre><p>Get U, V (=(u, v)*coslat) from vorticity ζ and divergence D in spectral space. Two operations are combined into a single linear operation. First, invert the spherical Laplace ∇² operator to get stream function from vorticity and velocity potential from divergence. Then compute zonal and meridional gradients to get U, V. Acts on the unit sphere, i.e. it omits any radius scaling as all inplace gradient operators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L286">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms._divergence!-Tuple{Any, LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms._divergence!-Tuple{Any, LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms._divergence!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_divergence!(
    kernel,
    div::LowerTriangularArray,
    u::LowerTriangularArray,
    v::LowerTriangularArray,
    S::SpectralTransform;
    radius
) -&gt; LowerTriangularArray
</code></pre><p>Generic divergence function of vector <code>u</code>, <code>v</code> that writes into the output into <code>div</code>. Generic as it uses the kernel <code>kernel</code> such that curl, div, add or flipsign options are provided through <code>kernel</code>, but otherwise a single function is used. Acts on the unit sphere, i.e. it omits 1/radius scaling as all gradient operators, unless the <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.curl!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.curl!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.curl!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">curl!(
    curl::LowerTriangularArray,
    u::LowerTriangularArray,
    v::LowerTriangularArray,
    S::SpectralTransform;
    flipsign,
    add,
    kwargs...
) -&gt; LowerTriangularArray
</code></pre><p>Curl of a vector <code>u, v</code> written into <code>curl</code>, <code>curl = ∇×(u, v)</code>. <code>u, v</code> are expected to have a 1/coslat-scaling included, otherwise <code>curl</code> is scaled. Acts on the unit sphere, i.e. it omits 1/radius scaling as all gradient operators unless the <code>radius</code> keyword argument is provided. <code>flipsign</code> option calculates -∇×(u, v) instead. <code>add</code> option calculates <code>curl += ∇×(u, v)</code> instead. <code>flipsign</code> and <code>add</code> can be combined. This functions only creates the kernel and calls the generic divergence function _divergence! subsequently with flipped u, v -&gt; v, u for the curl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.curl-Tuple{LowerTriangularArray, LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.curl-Tuple{LowerTriangularArray, LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.curl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">curl(
    u::LowerTriangularArray,
    v::LowerTriangularArray;
    kwargs...
) -&gt; Any
</code></pre><p>Curl (∇×) of two vector components <code>u, v</code> of size (n+1)xn, the last row will be set to zero in the returned <code>LowerTriangularMatrix</code>. This function requires both <code>u, v</code> to be transforms of fields that are scaled with <code>1/cos(lat)</code>. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided. An example usage is therefore</p><pre><code class="nohighlight hljs">RingGrids.scale_coslat⁻¹!(u_grid)
RingGrids.scale_coslat⁻¹!(v_grid)
u = transform(u_grid)
v = transform(v_grid)
vor = curl(u, v, radius=6.371e6)
vor_grid = transform(div)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.curl-Union{Tuple{Grid}, Tuple{Grid, Grid}} where Grid&lt;:AbstractGridArray" href="#SpeedyWeather.SpeedyTransforms.curl-Union{Tuple{Grid}, Tuple{Grid, Grid}} where Grid&lt;:AbstractGridArray"><code>SpeedyWeather.SpeedyTransforms.curl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">curl(
    u::AbstractGridArray,
    v::AbstractGridArray;
    kwargs...
) -&gt; Any
</code></pre><p>Curl (∇×) of two vector components <code>u, v</code> on a grid. Applies 1/coslat scaling, transforms to spectral space and returns the spectral curl. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.divergence!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.divergence!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.divergence!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">divergence!(
    div::LowerTriangularArray,
    u::LowerTriangularArray,
    v::LowerTriangularArray,
    S::SpectralTransform;
    flipsign,
    add,
    kwargs...
) -&gt; LowerTriangularArray
</code></pre><p>Divergence of a vector <code>u, v</code> written into <code>div</code>, <code>div = ∇⋅(u, v)</code>.  <code>u, v</code> are expected to have a 1/coslat-scaling included, otherwise <code>div</code> is scaled. Acts on the unit sphere, i.e. it omits 1/radius scaling as all gradient operators, unless the <code>radius</code> keyword argument is provided. <code>flipsign</code> option calculates -∇⋅(u, v) instead. <code>add</code> option calculates <code>div += ∇⋅(u, v)</code> instead. <code>flipsign</code> and <code>add</code> can be combined. This functions only creates the kernel and calls the generic divergence function _divergence! subsequently.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.divergence-Tuple{LowerTriangularArray, LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.divergence-Tuple{LowerTriangularArray, LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.divergence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">divergence(
    u::LowerTriangularArray,
    v::LowerTriangularArray;
    kwargs...
) -&gt; LowerTriangularArray
</code></pre><p>Divergence (∇⋅) of two vector components <code>u, v</code> which need to have size (n+1)xn, the last row will be set to zero in the returned <code>LowerTriangularMatrix</code>. This function requires both <code>u, v</code> to be transforms of fields that are scaled with <code>1/cos(lat)</code>. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided. An example usage is therefore</p><pre><code class="nohighlight hljs">RingGrids.scale_coslat⁻¹!(u_grid)
RingGrids.scale_coslat⁻¹!(v_grid)
u = transform(u_grid, one_more_degree=true)
v = transform(v_grid, one_more_degree=true)
div = divergence(u, v, radius = 6.371e6)
div_grid = transform(div)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.divergence-Union{Tuple{Grid}, Tuple{Grid, Grid}} where Grid&lt;:AbstractGridArray" href="#SpeedyWeather.SpeedyTransforms.divergence-Union{Tuple{Grid}, Tuple{Grid, Grid}} where Grid&lt;:AbstractGridArray"><code>SpeedyWeather.SpeedyTransforms.divergence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">divergence(
    u::AbstractGridArray,
    v::AbstractGridArray;
    kwargs...
) -&gt; Any
</code></pre><p>Divergence (∇⋅) of two vector components <code>u, v</code> on a grid. Applies 1/coslat scaling, transforms to spectral space and returns the spectral divergence. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.get_recursion_factors-Union{Tuple{NF}, Tuple{Type{NF}, Int64, Int64}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.SpeedyTransforms.get_recursion_factors-Union{Tuple{NF}, Tuple{Type{NF}, Int64, Int64}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.SpeedyTransforms.get_recursion_factors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_recursion_factors(
    _::Type{NF&lt;:AbstractFloat},
    lmax::Int64,
    mmax::Int64
) -&gt; LowerTriangularArray
</code></pre><p>Returns a matrix of recursion factors <code>ϵ</code> up to degree <code>lmax</code> and order <code>mmax</code> of number format <code>NF</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L285">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.get_truncation" href="#SpeedyWeather.SpeedyTransforms.get_truncation"><code>SpeedyWeather.SpeedyTransforms.get_truncation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_truncation(nlat_half::Integer) -&gt; Any
get_truncation(nlat_half::Integer, dealiasing::Real) -&gt; Any
</code></pre><p>For the grid resolution parameter <code>nlat_half</code> (e.g. 24 for a 48-ring FullGaussianGrid) return the spectral truncation <code>trunc</code> (max degree of spherical harmonics) following a dealiasing parameter (default 2) to match spectral and grid resolution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/aliasing.jl#L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.is_power_2-Tuple{Integer}" href="#SpeedyWeather.SpeedyTransforms.is_power_2-Tuple{Integer}"><code>SpeedyWeather.SpeedyTransforms.is_power_2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">true/false = is_power_2(i::Integer)</code></pre><p>Checks whether an integer <code>i</code> is a power of 2, i.e. i = 2^k, with k = 0, 1, 2, 3, ....</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/aliasing.jl#L61-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.roundup_fft-Union{Tuple{Integer}, Tuple{T}} where T&lt;:Integer" href="#SpeedyWeather.SpeedyTransforms.roundup_fft-Union{Tuple{Integer}, Tuple{T}} where T&lt;:Integer"><code>SpeedyWeather.SpeedyTransforms.roundup_fft</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">m = roundup_fft(n::Int;
                small_primes::Vector{Int}=[2, 3, 5])</code></pre><p>Returns an integer <code>m &gt;= n</code> with only small prime factors 2, 3 (default, others can be specified with the keyword argument <code>small_primes</code>) to obtain an efficiently fourier-transformable number of longitudes, m = 2^i * 3^j * 5^k &gt;= n, with i, j, k &gt;=0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/aliasing.jl#L33-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_interpolation-Union{Tuple{ArrayType}, Tuple{N}, Tuple{T}, Tuple{NF}, Tuple{Type{NF}, LowerTriangularArray{T, N, ArrayType}, Integer, Integer}} where {NF, T, N, ArrayType}" href="#SpeedyWeather.SpeedyTransforms.spectral_interpolation-Union{Tuple{ArrayType}, Tuple{N}, Tuple{T}, Tuple{NF}, Tuple{Type{NF}, LowerTriangularArray{T, N, ArrayType}, Integer, Integer}} where {NF, T, N, ArrayType}"><code>SpeedyWeather.SpeedyTransforms.spectral_interpolation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_interpolation(
    _::Type{NF},
    alms::LowerTriangularArray{T, N, ArrayType},
    ltrunc::Integer,
    mtrunc::Integer
) -&gt; Any
</code></pre><p>Returns a LowerTriangularArray that is interpolated from <code>alms</code> to the size (<code>ltrunc</code>+1) x (<code>mtrunc</code>+1), both inputs are 0-based, by padding zeros for higher wavenumbers. If <code>ltrunc</code> or <code>mtrunc</code> are smaller than the corresponding size of<code>alms</code> than <code>spectral_truncation</code> is automatically called instead, returning a smaller LowerTriangularArray.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_truncation.jl#L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_smoothing!-Tuple{LowerTriangularArray, Real}" href="#SpeedyWeather.SpeedyTransforms.spectral_smoothing!-Tuple{LowerTriangularArray, Real}"><code>SpeedyWeather.SpeedyTransforms.spectral_smoothing!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_smoothing!(
    L::LowerTriangularArray,
    c::Real;
    power,
    truncation
)
</code></pre><p>Smooth the spectral field <code>A</code> following A <em>= (1-(1-c)</em>∇²ⁿ) with power n of a normalised Laplacian so that the highest degree lmax is dampened by multiplication with c. Anti-diffusion for c&gt;1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_truncation.jl#L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_smoothing-Tuple{LowerTriangularArray, Real}" href="#SpeedyWeather.SpeedyTransforms.spectral_smoothing-Tuple{LowerTriangularArray, Real}"><code>SpeedyWeather.SpeedyTransforms.spectral_smoothing</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_smoothing(
    A::LowerTriangularArray,
    c::Real;
    power
) -&gt; Any
</code></pre><p>Smooth the spectral field <code>A</code> following A_smooth = (1-c*∇²ⁿ)A with power n of a normalised Laplacian so that the highest degree lmax is dampened by multiplication with c. Anti-diffusion for c&lt;0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_truncation.jl#L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{AbstractMatrix}" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{AbstractMatrix}"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(
    A::AbstractMatrix
) -&gt; LowerTriangularArray{T, 2, ArrayType} where {T, ArrayType&lt;:AbstractMatrix{T}}
</code></pre><p>Sets the upper triangle of <code>A</code> to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_truncation.jl#L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{LowerTriangularArray, Integer, Integer}" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{LowerTriangularArray, Integer, Integer}"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(
    alms::LowerTriangularArray,
    ltrunc::Integer,
    mtrunc::Integer
) -&gt; LowerTriangularArray
</code></pre><p>Triangular truncation to degree <code>ltrunc</code> and order <code>mtrunc</code> (both 0-based). Truncate spectral coefficients <code>alms</code> in-place by setting all coefficients for which the degree <code>l</code> is larger than the truncation <code>ltrunc</code> or order <code>m</code> larger than the truncaction <code>mtrunc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_truncation.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{LowerTriangularArray, Integer}" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{LowerTriangularArray, Integer}"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(
    alms::LowerTriangularArray,
    trunc::Integer
) -&gt; LowerTriangularArray
</code></pre><p>Triangular truncation of <code>alms</code> to degree and order <code>trunc</code> in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_truncation.jl#L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(
    alms::LowerTriangularArray
) -&gt; LowerTriangularArray
</code></pre><p>Triangular truncation of <code>alms</code> to the size of it, sets additional rows to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_truncation.jl#L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation-Union{Tuple{ArrayType}, Tuple{N}, Tuple{T}, Tuple{NF}, Tuple{Type{NF}, LowerTriangularArray{T, N, ArrayType}, Integer, Integer}} where {NF, T, N, ArrayType}" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation-Union{Tuple{ArrayType}, Tuple{N}, Tuple{T}, Tuple{NF}, Tuple{Type{NF}, LowerTriangularArray{T, N, ArrayType}, Integer, Integer}} where {NF, T, N, ArrayType}"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectral_truncation(
    _::Type{NF},
    alms::LowerTriangularArray{T, N, ArrayType},
    ltrunc::Integer,
    mtrunc::Integer
) -&gt; Any
</code></pre><p>Returns a LowerTriangularArray that is truncated from <code>alms</code> to the size (<code>ltrunc</code>+1) x (<code>mtrunc</code>+1), both inputs are 0-based. If <code>ltrunc</code> or <code>mtrunc</code> is larger than the corresponding size of<code>alms</code> than <code>spectral_interpolation</code> is automatically called instead, returning a LowerTriangularArray padded zero coefficients for higher wavenumbers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_truncation.jl#L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform!-Union{Tuple{NF}, Tuple{AbstractGridArray, LowerTriangularArray, SpectralTransform{NF}}} where NF" href="#SpeedyWeather.SpeedyTransforms.transform!-Union{Tuple{NF}, Tuple{AbstractGridArray, LowerTriangularArray, SpectralTransform{NF}}} where NF"><code>SpeedyWeather.SpeedyTransforms.transform!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform!(
    grids::AbstractGridArray,
    specs::LowerTriangularArray,
    S::SpectralTransform{NF};
    unscale_coslat
) -&gt; AbstractGridArray
</code></pre><p>Spectral transform (spectral to grid space) from n-dimensional array <code>specs</code> of spherical harmonic coefficients to an n-dimensional array <code>grids</code> of ring grids. Uses FFT in the zonal direction, and a Legendre Transform in the meridional direction exploiting symmetries. The spectral transform is number format-flexible but <code>grids</code> and the spectral transform <code>S</code> have to have the same number format. Uses the precalculated arrays, FFT plans and other constants in the SpectralTransform struct <code>S</code>. The spectral transform is grid-flexible as long as the <code>typeof(grids)&lt;:AbstractGridArray</code> and <code>S.Grid</code> matches.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L306">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform!-Union{Tuple{NF}, Tuple{LowerTriangularArray, AbstractGridArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}}, SpectralTransform{NF}}} where NF" href="#SpeedyWeather.SpeedyTransforms.transform!-Union{Tuple{NF}, Tuple{LowerTriangularArray, AbstractGridArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}}, SpectralTransform{NF}}} where NF"><code>SpeedyWeather.SpeedyTransforms.transform!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform!(
    specs::LowerTriangularArray,
    grids::AbstractGridArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}},
    S::SpectralTransform{NF}
) -&gt; LowerTriangularArray
</code></pre><p>Spectral transform (grid to spectral space) from n-dimensional array of <code>grids</code> to an n-dimensional array <code>specs</code> of spherical harmonic coefficients. Uses FFT in the zonal direction, and a Legendre Transform in the meridional direction exploiting symmetries. The spectral transform is number format-flexible but <code>grids</code> and the spectral transform <code>S</code> have to have the same number format. Uses the precalculated arrays, FFT plans and other constants in the SpectralTransform struct <code>S</code>. The spectral transform is grid-flexible as long as the <code>typeof(grids)&lt;:AbstractGridArray</code> and <code>S.Grid</code> matches.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L414">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform-Union{Tuple{AbstractGridArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}}}, Tuple{NF}} where NF" href="#SpeedyWeather.SpeedyTransforms.transform-Union{Tuple{AbstractGridArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}}}, Tuple{NF}} where NF"><code>SpeedyWeather.SpeedyTransforms.transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform(
    grids::AbstractGridArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}};
    recompute_legendre,
    one_more_degree,
    dealiasing
) -&gt; Any
</code></pre><p>Spectral transform (grid to spectral space) from <code>grids</code> to a newly allocated <code>LowerTriangularArray</code>. Based on the size of <code>grids</code> and the keyword <code>dealiasing</code> the spectral resolution trunc is retrieved. SpectralTransform struct <code>S</code> is allocated to execute <code>transform(grids, S)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L564">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform-Union{Tuple{LowerTriangularArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}}}, Tuple{NF}} where NF" href="#SpeedyWeather.SpeedyTransforms.transform-Union{Tuple{LowerTriangularArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}}}, Tuple{NF}} where NF"><code>SpeedyWeather.SpeedyTransforms.transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform(
    specs::LowerTriangularArray{NF, N, ArrayType} where {N, ArrayType&lt;:AbstractArray{NF, N}};
    recompute_legendre,
    Grid,
    dealiasing,
    kwargs...
) -&gt; Any
</code></pre><p>Spectral transform (spectral to grid space) from spherical coefficients <code>alms</code> to a newly allocated gridded field <code>map</code>. Based on the size of <code>alms</code> the grid type <code>grid</code>, the spatial resolution is retrieved based on the truncation defined for <code>grid</code>. SpectralTransform struct <code>S</code> is allocated to execute <code>transform(alms, S)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L547">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform-Union{Tuple{NF}, Tuple{AbstractGridArray, SpectralTransform{NF}}} where NF" href="#SpeedyWeather.SpeedyTransforms.transform-Union{Tuple{NF}, Tuple{AbstractGridArray, SpectralTransform{NF}}} where NF"><code>SpeedyWeather.SpeedyTransforms.transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform(
    grids::AbstractGridArray,
    S::SpectralTransform{NF}
) -&gt; Any
</code></pre><p>Spherical harmonic transform from <code>grids</code> to a newly allocated <code>specs::LowerTriangularArray</code> using the precomputed spectral transform <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L520">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.transform-Union{Tuple{NF}, Tuple{LowerTriangularArray, SpectralTransform{NF}}} where NF" href="#SpeedyWeather.SpeedyTransforms.transform-Union{Tuple{NF}, Tuple{LowerTriangularArray, SpectralTransform{NF}}} where NF"><code>SpeedyWeather.SpeedyTransforms.transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform(
    specs::LowerTriangularArray,
    S::SpectralTransform{NF};
    kwargs...
) -&gt; Any
</code></pre><p>Spherical harmonic transform from <code>specs</code> to a newly allocated <code>grids::AbstractGridArray</code> using the precomputed spectral transform <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L533">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.zero_imaginary_zonal_modes!-Tuple{LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.zero_imaginary_zonal_modes!-Tuple{LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.zero_imaginary_zonal_modes!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">zero_imaginary_zonal_modes!(
    alms::LowerTriangularArray
) -&gt; LowerTriangularArray
</code></pre><p>Set imaginary component of m=0 modes (the zonal modes in the first column) to 0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_truncation.jl#L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.ϵlm-Tuple{Int64, Int64}" href="#SpeedyWeather.SpeedyTransforms.ϵlm-Tuple{Int64, Int64}"><code>SpeedyWeather.SpeedyTransforms.ϵlm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ϵlm(l::Int64, m::Int64) -&gt; Float64
</code></pre><p>Recursion factors <code>ϵ</code> as a function of degree <code>l</code> and order <code>m</code> (0-based) of the spherical harmonics. ϵ(l, m) = sqrt((l^2-m^2)/(4*l^2-1)) with default number format Float64.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.ϵlm-Union{Tuple{NF}, Tuple{Type{NF}, Int64, Int64}} where NF" href="#SpeedyWeather.SpeedyTransforms.ϵlm-Union{Tuple{NF}, Tuple{Type{NF}, Int64, Int64}} where NF"><code>SpeedyWeather.SpeedyTransforms.ϵlm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ϵlm(_::Type{NF}, l::Int64, m::Int64) -&gt; Any
</code></pre><p>Recursion factors <code>ϵ</code> as a function of degree <code>l</code> and order <code>m</code> (0-based) of the spherical harmonics. ϵ(l, m) = sqrt((l^2-m^2)/(4*l^2-1)) and then converted to number format NF.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_transform.jl#L271">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇!(
    dpdx::LowerTriangularArray,
    dpdy::LowerTriangularArray,
    p::LowerTriangularArray,
    S::SpectralTransform;
    radius
) -&gt; Tuple{LowerTriangularArray, LowerTriangularArray}
</code></pre><p>Applies the gradient operator ∇ applied to input <code>p</code> and stores the result in <code>dpdx</code> (zonal derivative) and <code>dpdy</code> (meridional derivative). The gradient operator acts on the unit sphere and therefore omits the 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L491">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇-Tuple{AbstractGridArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇-Tuple{AbstractGridArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇(
    grid::AbstractGridArray,
    S::SpectralTransform;
    kwargs...
) -&gt; Tuple{Any, Any}
</code></pre><p>The zonal and meridional gradient of <code>grid</code>. Transform to spectral space, takes the gradient and unscales the 1/coslat scaling in the gradient. Acts on the unit-sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided. Makes use of an existing spectral transform <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L570">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇-Tuple{AbstractGridArray}" href="#SpeedyWeather.SpeedyTransforms.∇-Tuple{AbstractGridArray}"><code>SpeedyWeather.SpeedyTransforms.∇</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇(grid::AbstractGridArray; kwargs...) -&gt; Tuple{Any, Any}
</code></pre><p>The zonal and meridional gradient of <code>grid</code>. Transform to spectral space, takes the gradient and unscales the 1/coslat scaling in the gradient. Acts on the unit-sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L582">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇-Tuple{LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇-Tuple{LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇(
    p::LowerTriangularArray,
    S::SpectralTransform;
    kwargs...
) -&gt; Tuple{Any, Any}
</code></pre><p>The zonal and meridional gradient of <code>p</code> using an existing <code>SpectralTransform</code> <code>S</code>. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L552">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇-Tuple{LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.∇-Tuple{LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.∇</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇(p::LowerTriangularArray; kwargs...)
</code></pre><p>The zonal and meridional gradient of <code>p</code>. Precomputes a <code>SpectralTransform</code> <code>S</code>. Acts on the unit-sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L562">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇²!-Tuple{LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇²!-Tuple{LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇²!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇²!(
    ∇²alms::LowerTriangularArray,
    alms::LowerTriangularArray,
    S::SpectralTransform;
    add,
    flipsign,
    inverse,
    radius
) -&gt; LowerTriangularArray
</code></pre><p>Laplace operator ∇² applied to the spectral coefficients <code>alms</code> in spherical coordinates. The eigenvalues which are precomputed in <code>S</code>. ∇²! is the in-place version which directly stores the output in the first argument <code>∇²alms</code>. Acts on the unit sphere, i.e. it omits any radius scaling as all inplace gradient operators, unless the <code>radius</code> keyword argument is provided.</p><p><strong>Keyword arguments</strong></p><ul><li><code>add=true</code> adds the ∇²(alms) to the output</li><li><code>flipsign=true</code> computes -∇²(alms) instead</li><li><code>inverse=true</code> computes ∇⁻²(alms) instead</li></ul><p>Default is <code>add=false</code>, <code>flipsign=false</code>, <code>inverse=false</code>. These options can be combined.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L379">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇²-Tuple{LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇²-Tuple{LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇²</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇²(
    alms::LowerTriangularArray,
    S::SpectralTransform;
    kwargs...
) -&gt; Any
</code></pre><p>Laplace operator ∇² applied to input <code>alms</code>, using precomputed eigenvalues from <code>S</code>. Acts on the unit sphere, i.e. it omits 1/radius^2 scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L434">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇²-Tuple{LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.∇²-Tuple{LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.∇²</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇²(alms::LowerTriangularArray; kwargs...) -&gt; Any
</code></pre><p>Returns the Laplace operator ∇² applied to input <code>alms</code>. Acts on the unit sphere, i.e. it omits 1/radius^2 scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L449">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇⁻²!-Tuple{LowerTriangularArray, LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇⁻²!-Tuple{LowerTriangularArray, LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇⁻²!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇⁻²!(
    ∇⁻²alms::LowerTriangularArray,
    alms::LowerTriangularArray,
    S::SpectralTransform;
    add,
    flipsign,
    kwargs...
) -&gt; LowerTriangularArray
</code></pre><p>Calls <code>∇²!(∇⁻²alms, alms, S; add, flipsign, inverse=true)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L478">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇⁻²-Tuple{LowerTriangularArray, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇⁻²-Tuple{LowerTriangularArray, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇⁻²</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇⁻²(
    ∇²alms::LowerTriangularArray,
    S::SpectralTransform;
    kwargs...
) -&gt; Any
</code></pre><p>InverseLaplace operator ∇⁻² applied to input <code>alms</code>, using precomputed eigenvalues from <code>S</code>. Acts on the unit sphere, i.e. it omits radius^2 scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L456">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇⁻²-Tuple{LowerTriangularArray}" href="#SpeedyWeather.SpeedyTransforms.∇⁻²-Tuple{LowerTriangularArray}"><code>SpeedyWeather.SpeedyTransforms.∇⁻²</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∇⁻²(∇²alms::LowerTriangularArray; kwargs...) -&gt; Any
</code></pre><p>Returns the inverse Laplace operator ∇⁻² applied to input <code>alms</code>. Acts on the unit sphere, i.e. it omits radius^2 scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/a3fc8878f210116efae9a844ed160caea4a0cde6/src/SpeedyTransforms/spectral_gradients.jl#L471">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lowertriangularmatrices/">« LowerTriangularMatrices</a><a class="docs-footer-nextpage" href="../gradients/">Gradient operators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 7 October 2024 19:14">Monday 7 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
